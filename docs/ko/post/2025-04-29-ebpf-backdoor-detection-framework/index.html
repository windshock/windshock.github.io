<!doctype html><html lang=ko dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 | Code Before Breach</title>
<meta name=keywords content="eBPF,루트킷 탐지,BPFDoor,커널 보안,Tracee,LKRG,Hypervisor Audit,포렌식"><meta name=description content="eBPF를 악용한 백도어 및 루트킷의 부상과 탐지 난제를 분석하고, Tracee, LKRG, bpftool, Hypervisor 기반 감사 등 최신 대응 방법과 연구 동향(2023~2025)을 종합 정리합니다."><meta name=author content><link rel=canonical href=https://windshock.github.io/ko/post/2025-04-29-ebpf-backdoor-detection-framework/><link href="https://fonts.googleapis.com/css2?family=Spectral:wght@400;700&display=swap" rel=stylesheet><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://windshock.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://windshock.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://windshock.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://windshock.github.io/apple-touch-icon.png><link rel=mask-icon href=https://windshock.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://windshock.github.io/en/post/2025-04-29-ebpf-backdoor-detection-framework/><link rel=alternate hreflang=ko href=https://windshock.github.io/ko/post/2025-04-29-ebpf-backdoor-detection-framework/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css><script defer src=https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js></script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6N6EEJ259T"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6N6EEJ259T")}</script><meta property="og:url" content="https://windshock.github.io/ko/post/2025-04-29-ebpf-backdoor-detection-framework/"><meta property="og:site_name" content="Code Before Breach"><meta property="og:title" content="eBPF 기반 백도어 탐지 프레임워크와 최신 방법론"><meta property="og:description" content="eBPF를 악용한 백도어 및 루트킷의 부상과 탐지 난제를 분석하고, Tracee, LKRG, bpftool, Hypervisor 기반 감사 등 최신 대응 방법과 연구 동향(2023~2025)을 종합 정리합니다."><meta property="og:locale" content="ko-KR"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-04-28T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-28T00:00:00+00:00"><meta property="article:tag" content="EBPF"><meta property="article:tag" content="루트킷 탐지"><meta property="article:tag" content="BPFDoor"><meta property="article:tag" content="커널 보안"><meta property="article:tag" content="Tracee"><meta property="article:tag" content="LKRG"><meta name=twitter:card content="summary"><meta name=twitter:title content="eBPF 기반 백도어 탐지 프레임워크와 최신 방법론"><meta name=twitter:description content="eBPF를 악용한 백도어 및 루트킷의 부상과 탐지 난제를 분석하고, Tracee, LKRG, bpftool, Hypervisor 기반 감사 등 최신 대응 방법과 연구 동향(2023~2025)을 종합 정리합니다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://windshock.github.io/ko/post/"},{"@type":"ListItem","position":2,"name":"eBPF 기반 백도어 탐지 프레임워크와 최신 방법론","item":"https://windshock.github.io/ko/post/2025-04-29-ebpf-backdoor-detection-framework/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"eBPF 기반 백도어 탐지 프레임워크와 최신 방법론","name":"eBPF 기반 백도어 탐지 프레임워크와 최신 방법론","description":"eBPF를 악용한 백도어 및 루트킷의 부상과 탐지 난제를 분석하고, Tracee, LKRG, bpftool, Hypervisor 기반 감사 등 최신 대응 방법과 연구 동향(2023~2025)을 종합 정리합니다.","keywords":["eBPF","루트킷 탐지","BPFDoor","커널 보안","Tracee","LKRG","Hypervisor Audit","포렌식"],"articleBody":"\n개요: eBPF 백도어의 부상과 탐지 과제 eBPF(extended BPF)은 리눅스 커널에 동적으로 프로그램을 삽입할 수 있는 강력한 기술로, 원래 성능 모니터링이나 보안 등 정상적인 용도로 널리 활용되고 있습니다​sysdig.com​sysdig.com. 그러나 최근 몇 년 사이 공격자들이 eBPF를 악용한 백도어 및 루트킷을 개발하면서, eBPF는 보안 측면에서 양날의 검이 되었습니다​aquasec.com. 실제로 2023년 이후 eBPF를 이용한 루트킷(ebpfkit, TripleCross 등)과 멀웨어(Pamspy 등)이 등장하여 암암리에 인증 정보 탈취, 방화벽 우회 등의 악성 행위에 활용되고 있습니다​aquasec.com. 이러한 eBPF 기반 백도어는 커널 레벨에서 동작하기 때문에 탐지가 매우 까다롭고 전통적인 보안 도구로는 놓치기 쉽습니다​trendmicro.com​redcanary.com. 아래에서는 공개된 탐지 프레임워크와 도구, 최신 연구 동향, 탐지의 어려움과 대응 전략, 실제 사례 및 활용 가능한 도구를 종합적으로 정리합니다.\neBPF 백도어의 탐지 어려움 eBPF 백도어는 일반적인 루트킷 탐지 방식으로는 식별하기 어렵습니다. eBPF 프로그램은 기존 커널 모듈과 달리 별도 모듈로 표시되지 않고, 커널의 BPF VM 내에서 실행되므로 은폐에 유리합니다. 예를 들어 APT 공격에 사용된 BPFDoor 백도어는 커널에 패킷 필터를 삽입하여 방화벽 규칙을 우회하면서도 네트워크 포트가 열려 있지 않은 것처럼 위장하여 탐지를 회피했습니다​trendmicro.com. 또한 eBPF 루트킷이 시스템에 설치되고 나면, 시스템 진단 도구의 출력 자체를 조작하여 자신의 존재를 숨길 수 있습니다​redcanary.com. Red Canary 분석에 따르면, eBPF 기반 멀웨어가 일단 로드된 후에는 bpftool이나 debugfs와 같은 툴의 결과도 신뢰하기 어려울 정도로 교묘하게 숨길 수 있다고 합니다​redcanary.com. 따라서 로드 시점에 탐지하지 못하면 사후 탐지는 매우 난관이며, 이것이 eBPF 백도어 탐지의 핵심 어려움입니다​redcanary.com.\n이러한 어려움을 극복하기 위해 실시간 모니터링과 사후 포렌식 기법을 모두 활용하는 전략이 필요합니다. 예를 들어 탐지 도구를 커널 수준에서 동작시켜 eBPF 프로그램의 로딩 이벤트를 가로채면, 악성 eBPF가 활동을 시작하는 초기에 탐지할 수 있습니다​scitepress.org. 반면, 이미 활성화된 루트킷에 대해서는 하이퍼바이저나 메모리 포렌식을 통해 바깥에서 커널 메모리를 검사하는 기법이 고려됩니다​scitepress.org. 아래에서는 이러한 실시간 탐지 프레임워크들과 연구 기반 방법론을 상세히 살펴보고, 각 접근법의 특징과 한계를 논의합니다.\n리눅스 백신(Anti-Virus)로 eBPF 백도어가 커버되지 않는 이유 결론: 일반 리눅스 백신(Anti-Virus)으로는 eBPF 기반 백도어를 탐지하거나 차단할 수 없습니다.\n주요 이유 eBPF 백도어는 파일 기반이 아님: 리눅스 백신은 파일 시스템 상에 존재하는 악성 파일을 스캔하는데 최적화되어 있습니다. 하지만 eBPF 프로그램은 커널 BPF 서브시스템 안에 로드되어 특정 이벤트에 연결되어 실행되므로, 파일 시스템에는 직접 존재하지 않습니다. 커널 내부 활동은 감시 불가: 전통적인 리눅스 백신은 유저스페이스 프로세스와 디스크 I/O를 주로 감시합니다. 커널 스페이스에서 동작하는 eBPF 프로그램은 탐지 대상이 아닙니다. 정보 조작 가능성: eBPF 루트킷은 시스템콜, 프로세스 목록, 파일 목록을 조작할 수 있습니다. 따라서 백신이 보는 정보 자체가 변조되어 있을 수 있습니다. 백신 스캐너는 BPF Hook까지 감지하지 못함: 시스템콜 테이블 후킹, kprobe/uprobe attach 등 커널 레벨 후킹은 전통 백신의 탐지 범위를 넘어서 있습니다. 현실적 결론 파일형 악성코드(웹쉘, 트로이목마)는 커버 가능 커널 스페이스 eBPF 백도어는 커버 불가 커널 모듈 기반 루트킷도 커버 불가 “리눅스 백신은 기본적으로 eBPF 백도어를 탐지할 수 없다. 커널 수준 무결성 보호 없이는 신뢰할 수 없다.”\n따라서 LKRG(Linux Kernel Runtime Guard)와 같은 커널 무결성 보호 모듈이 필요합니다.\nTracee vs LKRG: 각각의 역할 eBPF 백도어나 커널 루트킷에 대응할 때, Tracee와 LKRG는 서로 다른 층위를 보완합니다.\n항목 Tracee LKRG 무엇을 감시? 커널 이벤트 (bpf 호출, execve, open 등) 커널 객체 무결성 (시스템콜 테이블, 크리덴셜 등) 언제 감시? 공격 “행위(Event)” 발생 시 탐지 커널 구조 변조 “시도” 발생 시 탐지 탐지 포인트 시스템콜 레벨 커널 메모리 구조체 레벨 초점 이상 징후 헌팅 (Hunting) 무결성 보장 및 방어 (Protection) 방식 이벤트 기록 및 경보 (Passive) 무결성 위반 시 즉시 차단 또는 경고 (Active) 성격 사고 후 대응 중심 사고 사전 차단 중심 요약 Tracee는 이상 행위를 “찍어서” 기록하는 보안 CCTV 역할을 합니다. LKRG는 커널 구조 자체를 감시해서 변조를 “막는” 방범창 역할을 합니다. 둘을 함께 사용할 때 가장 강력한 보호가 가능합니다.\n“Tracee만 쓰면 사고는 기록되지만 막을 수 없고, LKRG만 쓰면 기록은 남지 않는다. 따라서 둘을 병행해야 탐지와 방어가 동시에 이뤄진다.”\nBPFDoor 탐지를 위한 간단한 스크립트: bpfdoor_detector.sh eBPF 백도어 중 하나인 BPFDoor와 유사한 행동을 보이는 프로세스를 탐지하기 위해 설계된 경량 스크립트입니다.\n스크립트 특징 삭제된 실행파일 (deleted) 상태로 실행 중인 프로세스 탐지 BPF 소켓을 사용하는 프로세스 필터링 정상적인 BPF 사용 프로그램 제외 (tcpdump, wireshark, dhclient 등) 간단한 네트워크 연결 정보 표시 사용법 sudo ./bpfdoor_detector.sh\n반드시 루트 권한으로 실행해야 합니다. 필요 명령어: ps, grep, readlink, ss 스크립트 코드 전문 #!/bin/bash # BPFDoor-like Suspicious Process Detector # Check for root permission if [ \"$(id -u)\" -ne 0 ]; then echo \"[!] This script must be run as root.\" exit 1 fi # Check required commands for cmd in ps grep readlink ss; do if ! command -v $cmd \u0026\u003e/dev/null; then echo \"[!] $cmd command is required. Please install it first.\" exit 1 fi done echo \"[*] Starting focused BPFDoor-like process detection...\" found=0 # Iterate over all PIDs for pid in $(ls /proc/ | grep -E '^[0-9]+$'); do [ -d \"/proc/$pid\" ] || continue exe_path=$(readlink /proc/$pid/exe 2\u003e/dev/null) if [[ $exe_path == *\"(deleted)\" ]]; then if [ -r /proc/$pid/net/packet ] \u0026\u0026 [ -s /proc/$pid/net/packet ]; then cmdline=$(ps -p $pid -o cmd= 2\u003e/dev/null) if [[ ! $cmdline =~ \"tcpdump|wireshark|dhclient\" ]]; then echo \"[!] Suspicious process detected:\" echo \" - PID: $pid\" echo \" - Command: $cmdline\" echo \" - Deleted executable: $exe_path\" echo \" - BPF socket is active\" ss -p -n 2\u003e/dev/null | grep \"pid=$pid,\" | awk '{print \" - Network: \" $0}' echo \"\" found=1 fi fi fi done [ $found -eq 0 ] \u0026\u0026 echo \"[*] No suspicious processes found.\" echo \"[*] Detection completed.\" 주의사항 이 스크립트는 프로세스 레벨에서 간단한 힌트만 제공하는 경량 탐지 도구입니다. 고급 eBPF 루트킷은 /proc 정보까지 조작할 수 있으므로, 이 스크립트만으로는 완전한 보장이 되지 않습니다. 커널 무결성 보호 모듈(예: LKRG)과 함께 사용할 것을 강력히 권장합니다. Without kernel integrity protection like LKRG, even detection results can be faked.\nOpenStack 환경에서의 eBPF 백도어 점검 방법 OpenStack 환경에서는 호스트 OS(KVM Hypervisor)에서 직접 eBPF 활동을 점검할 수 있습니다.\nbpftool을 이용한 점검 스크립트 #!/bin/bash # List all BPF programs echo \"[*] Listing currently loaded BPF programs...\" bpftool prog show # List all BPF maps echo \"[*] Listing currently loaded BPF maps...\" bpftool map show # Optional: Check for unexpected XDP attachments echo \"[*] Checking for XDP programs attached to network interfaces...\" for iface in $(ls /sys/class/net/); do ip link show dev \"$iface\" | grep -q \"xdp\" \u0026\u0026 echo \"[!] XDP attached: $iface\" done # Optional: Check for TC filters echo \"[*] Checking for TC filters...\" for iface in $(ls /sys/class/net/); do tc filter show dev \"$iface\" 2\u003e/dev/null | grep -i \"bpf\" \u0026\u0026 echo \"[!] BPF TC filter detected on: $iface\" done echo \"[*] BPF scan completed.\" 스크립트 상세 설명 bpftool prog show: 현재 커널에 로드되어 있는 eBPF 프로그램 전체 목록을 출력합니다. 악성 BPF 프로그램이 로드되어 있을 수 있으므로 필수 점검 항목입니다. bpftool map show: BPF 프로그램이 사용하는 데이터 맵(BPF map)을 모두 출력합니다. C2 명령 제어나 세션 유지에 악용될 수 있는 맵을 탐지하는 데 사용합니다. XDP (eXpress Data Path) attachment 검사: ip link show 명령으로 각 네트워크 인터페이스에 XDP 프로그램이 붙어 있는지 검사합니다. XDP는 NIC(Level 2)에서 바로 패킷을 가로채는 고속 패스 기술로, BPFDoor 같은 백도어가 은밀히 트래픽을 조작하거나 필터링하는 데 사용될 수 있습니다. TC (Traffic Control) filter 검사: tc filter show 명령으로 인터페이스에 연결된 BPF 기반 트래픽 필터를 확인합니다. TC 필터는 네트워크 흐름을 조작하거나 특정 조건에서만 통신을 허용/차단하는 데 악용될 수 있습니다. 요약: bpftool 스크립트는 프로그램, 맵, XDP, TC 필터 네 가지 핵심 지점을 점검하여, OpenStack 호스트 수준에서 eBPF 백도어의 흔적을 조기에 탐지할 수 있습니다.\n추가 고급 방법: Guest OS 공통 패턴 제거 및 이상 징후 필터링 bpftool을 통해 수집한 모든 BPF 프로그램 정보는 OpenStack Hypervisor(KVM) 기준, 게스트 VM마다 공통적으로 로드된 정상 프로그램들도 포함되어 있습니다.\n이때, 모든 Guest OS에 공통적으로 존재하는 정상 eBPF 프로그램은 필터링하고, 튀는(비정상적인) 프로그램만 추출하는 방식으로 점검 효율을 높일 수 있습니다.\n간단한 필터링 스크립트 예시 #!/bin/bash # Collect current BPF programs bpftool prog show \u003e /tmp/bpf_prog_list_all.txt # Define known common patterns (adjust based on your environment) COMMON_PATTERNS=(\"kube-proxy\" \"cilium\" \"flannel\" \"calico\" \"ovs-vswitchd\" \"normal VM agent\") # Filter out common entries grep -v -E \"$(IFS='|'; echo \"${COMMON_PATTERNS[*]}\")\" /tmp/bpf_prog_list_all.txt \u003e /tmp/bpf_prog_suspicious.txt echo \"[*] Suspicious BPF programs after filtering:\" cat /tmp/bpf_prog_suspicious.txt 설명 COMMON_PATTERNS: OpenStack 환경에서 VM들이 공통으로 사용하는 정상적인 BPF 프로그램 이름을 배열로 설정합니다. grep -v -E: 정상 패턴에 일치하지 않는 항목만 남깁니다. 결과 파일: /tmp/bpf_prog_suspicious.txt에 비정상적으로 보이는 항목만 남겨 분석합니다. 요약: 공통 정상 패턴을 제거하고 튀는 것만 보는 방식으로 필터링하면, OpenStack 호스트 수준에서도 eBPF 백도어를 훨씬 빠르게 식별할 수 있습니다.\n자동 학습 기반 공통 패턴 갱신 (diff 방식) 시간이 지남에 따라 Guest OS 공통 패턴은 변경될 수 있습니다. 따라서 수동으로 패턴을 관리하는 대신, 과거와 현재의 bpftool 결과를 비교(diff)하여 자동으로 갱신할 수 있습니다.\n자동 학습 스크립트 예시 #!/bin/bash BASELINE_FILE=\"/opt/bpf_baseline.txt\" CURRENT_FILE=\"/tmp/bpf_current.txt\" NEW_SUSPICIOUS_FILE=\"/tmp/bpf_diff_suspicious.txt\" # Collect current BPF programs bpftool prog show \u003e \"$CURRENT_FILE\" # If no baseline exists, create one if [ ! -f \"$BASELINE_FILE\" ]; then echo \"[*] No baseline found. Creating initial baseline...\" cp \"$CURRENT_FILE\" \"$BASELINE_FILE\" exit 0 fi # Compare current with baseline echo \"[*] Comparing current BPF programs with baseline...\" diff --unchanged-line-format= --old-line-format= \"$BASELINE_FILE\" --new-line-format='%L' \"$CURRENT_FILE\" \u003e \"$NEW_SUSPICIOUS_FILE\" echo \"[*] Newly detected suspicious BPF programs:\" cat \"$NEW_SUSPICIOUS_FILE\" 설명 BASELINE_FILE: 정상적인 BPF 프로그램 목록(기준)을 저장합니다. CURRENT_FILE: 현재 스캔한 BPF 프로그램 목록입니다. diff 명령어를 사용해 기준과 현재를 비교하고, 새로운 항목만 추출합니다. 새로운 eBPF 프로그램이 발견되면 바로 탐지할 수 있습니다. 요약: 정기적으로 bpftool 스캔 결과를 저장하고, diff를 통해 변화를 추적하면 자동으로 튀는 프로그램만 선별할 수 있습니다.\nvSphere + VMware NSX 환경에서의 eBPF 백도어 대응 vSphere(ESXi) 환경에서는 게스트 OS 내부 감시는 어렵지만, NSX를 통해 네트워크 단에서 이상 행위를 감지할 수 있습니다.\n가능한 탐지 방향 방법 설명 Distributed Firewall(DFW) 규칙 활용 예상치 못한 outbound 포트, C2 서버 연결 시도를 탐지하거나 차단 NSX IDS/IPS 기능 활성화 BPFDoor 스타일 통신 패턴(비정상 UDP, ICMP 터널링 등)을 탐지 Flow Analytics 활용 VM 간 비정상 통신(East-West Movement) 흐름을 NSX가 분석하고 이상 징후 감지 NSX Threat Intelligence NSX ATP(Advanced Threat Protection) 모듈이 활성화된 경우 Known IOC 매칭 가능 주의사항 NSX는 커널 내부 변조를 직접 탐지하지 못합니다. (네트워크 관점에서 탐지) 게스트 OS 내부 이상 행위에 대한 대응은 여전히 필요합니다. (Tracee, EDR 등 추가 권장) “vSphere 환경에서는 NSX를 활용해 비정상 네트워크 패턴을 탐지하고, 게스트 OS 내부에서는 별도의 런타임 보안 도구로 커널 활동을 모니터링하는 이중 구조가 가장 효과적이다.”\n공개된 eBPF 백도어 탐지 프레임워크 및 도구 최근 공개된 여러 오픈소스 도구와 프레임워크가 eBPF 악성 활용을 탐지하기 위해 개발되었습니다. 주요 도구와 그 특징은 다음과 같습니다:\n도구/프레임워크 접근 방식 및 주요 기능 비고 Tracee (Aqua Security) eBPF 기반 실시간 모니터링 도구로, 커널 이벤트를 추적하여 악성 행위를 탐지. 특히 eBPF 프로그램이 kprobe/tracepoint 등에 attach되는 순간 발생하는 bpf_attach 이벤트를 포착해 어떤 eBPF 프로그램(ID, 이름, 타입, 사용된 helper 함수 등)이 로드되는지 기록함​scitepress.org​aquasec.com. 오픈소스 (GitHub 제공)​scitepress.org. Aqua Security 연구팀이 개발하여 eBPF 루트킷과 멀웨어 탐지에 활용​scitepress.org. ebpfkit-monitor Datadog 연구원(Fournier)이 개발한 전용 탐지 툴로, eBPF 바이트코드를 정적 분석하거나 실행 시 모니터링하여 악의적인 eBPF 로딩을 탐지함. 원래 eBPF 루트킷인 ebpfkit을 검출하기 위해 설계되었으며, 의심스러운 eBPF 프로그램 로딩을 감시하고 차단 가능​scitepress.org. 오픈소스 (GitHub 제공). eBPF 루트킷 ebpfkit 대응으로 개발​github.com. Falco (CNCF/Sysdig) 호스트 침입 탐지(HIDS) 도구로, eBPF를 통해 시스템 콜 등을 모니터링하여 악성 행위를 탐지. 최근 버전에서는 bpf() 시스템콜 호출을 감시함으로써 권한 상승을 위한 eBPF 악용 시도를 탐지하고 경보를 발생시킬 수 있음​sysdig.com. 오픈소스 CNCF 프로젝트. 주로 컨테이너/클라우드 환경에서 활용되며, 정책을 설정해 eBPF 관련 이벤트를 추적 가능. bpftool (리눅스 기본 도구) 리눅스 커널에 내장된 BPF 디버깅/관리 도구로, 현재 로드된 eBPF 프로그램, 맵, 링크 정보를 나열할 수 있음. 수동 조사 시 bpftool prog, bpftool map, bpftool link, bpftool perf 등의 명령으로 의심스러운 eBPF 프로그램(예: kprobe 유형 백도어)과 연결 지점(어떤 함수에 붙었는지)을 확인 가능​redcanary.com​redcanary.com. 리눅스 4.x 이상에서 제공. 수동 조사나 스크립트로 활용하여 비정상적 BPF 객체(예: 알 수 없는 이름의 kprobe 프로그램 등) 탐지에 유용​redcanary.com​redcanary.com. Volatility eBPF 플러그인 메모리 포렌식 도구 Volatility용 플러그인으로, 메모리 덤프에서 eBPF 프로그램을 추출하고 분석함. 커널 내부의 prog_idr 구조체를 탐색하여 로드된 모든 eBPF 바이트코드와 메타데이터(이름, 길이, 타입, 사용 helper 함수 등)를 수집​scitepress.org​scitepress.org. 이를 바탕으로 악성 가능성이 높은 eBPF 프로그램을 선별하는 **분류기(classifier)**를 제공. 연구용 도구 (2024년 학술 연구에서 공개​scitepress.org​scitepress.org). 실행 중인 시스템에서는 루트킷에 의해 우회될 수 있으나, 하이퍼바이저나 오프라인 메모리 덤프 분석에 활용하여 내부 관찰자를 회피한 탐지가 가능함​scitepress.org. 이들 도구는 각각 장단점과 적용 범위가 다릅니다. 예를 들어 Tracee와 Falco는 실시간 탐지에 강점이 있어, eBPF 백도어가 로드되는 순간 탐지하거나 실행 중 수상한 시스템콜 패턴을 식별합니다​scitepress.org​sysdig.com. 반면 Volatility 플러그인과 같은 포렌식 도구는 사후 분석에 유용하며, 이미 설치되어 은신 중인 루트킷도 하이퍼바이저 수준에서 메모리를 덤프하여 찾아낼 수 있습니다​scitepress.org. 이러한 도구들을 상황에 맞게 조합하면 다층적인 탐지 전략을 구축할 수 있습니다.\n최신 탐지 방법론 (2023~2025)과 연구 동향 최근 공개된 연구 논문, 보안 보고서, 기술 블로그에서는 eBPF 백도어 탐지를 위한 다양한 접근법과 개선 사항을 제시하고 있습니다. 주요한 방법론은 다음과 같습니다:\n실시간 로드 모니터링: 가장 효과적인 탐지는 eBPF 프로그램이 커널에 로드될 때 이루어집니다​redcanary.com. Red Canary에 따르면, eBPF 기반 멀웨어는 로드 시점을 놓치면 탐지가 극도로 어려워지므로 EDR(Endpoint Detection \u0026 Response) 솔루션이나 커스텀 모니터링 도구가 bpf 시스템콜 호출, kprobe 등록 등의 이벤트를 실시간 감시해야 합니다​redcanary.com​redcanary.com. Aqua Security는 이와 관련해 Tracee 도구에 bpf_attach 이벤트 모니터링을 추가하여, 악성 eBPF 프로그램이 kprobe/uretprobe 등에 붙는 순간 자동으로 탐지하도록 구현했습니다​scitepress.org​aquasec.com. 실제로 2023년 Aqua 측은 PAM 인증 모듈을 훔쳐보는 Pamspy 멀웨어를 Tracee로 탐지해냈는데, pam_get_authtok 함수를 후킹한 eBPF uretprobe 프로그램(trace_pam_get_a)의 로드 이벤트를 포착함으로써 평문 크리덴셜 탈취 시도를 적발할 수 있었습니다​aquasec.com. 이처럼 커널 내부 이벤트에 대한 훅(hook) 모니터링은 최신 EDR과 오픈소스 도구에서 중요한 추세입니다.\n커널 내부 무결성 검사 및 제한: eBPF 백도어를 원천 차단하거나 탐지하기 위해 커널 자체에 보안장치를 두는 연구도 진행되고 있습니다. 예를 들어 Sysdig의 보고는, 최신 커널 설정에서 CONFIG_BPF_UNPRIV_DEFAULT_OFF를 통해 비권한 사용자에 의한 eBPF 사용을 막고, SYS_bpf 시스템콜을 루트만 사용하도록 제한하는 것을 권고합니다​sysdig.com. 또한 eBPF에 의한 커널 함수 변조를 막기 위해 CONFIG_BPF_KPROBE_OVERRIDE와 같은 옵션을 비활성화하고, 불필요한 kprobe 기능이나 eBPF 기능은 아예 컴파일 제외하는 식으로 공격 표면을 줄이는 전략도 제시됩니다​redcanary.com. 이러한 설정은 탐지라기보다는 예방적 수단이지만, eBPF 악용을 사전에 차단함으로써 탐지 부담을 낮추는 효과가 있습니다.\n하이퍼바이저 기반 감사(Audit): 호스트 OS 내부에서 동작하는 탐지기는 동일한 커널 권한을 가진 루트킷에 의해 우회될 위험이 있습니다​blog.thalium.re. 이를 보완하고자, 2023~2024년 연구들은 하이퍼바이저 레벨에서 게스트의 eBPF 동작을 감사하는 방안을 모색했습니다. 예를 들어 2023년 SIGCOMM 워크숍의 HyperBee 연구는, 하이퍼바이저가 게스트 OS에 로드되는 모든 eBPF 프로그램을 사전에 검사하도록 하여 악성 코드를 차단하는 프레임워크를 제안했습니다​conferences.sigcomm.org. 마찬가지로 2024년 한 연구에서는 경량 하이퍼바이저를 이용해 게스트 메모리를 스냅샷하고, Volatility 플러그인으로 eBPF 프로그램을 추출한 뒤 의심스러운 helper 함수 호출 여부 등을 분류하는 기법을 선보였습니다​scitepress.org​scitepress.org. 이러한 외부 감사 기법들은 은폐된 루트킷도 투명하게 들여다볼 수 있다는 점에서 향후 실용화 가능성이 주목됩니다.\n시스템 후속 검사 및 헌팅: 만약 실시간 탐지에 실패했다면, 보안 담당자에 의한 수동 헌팅과 분석이 필요합니다. 최신 보고서들은 관리자가 의심 상황에서 다음 사항을 점검하라고 조언합니다:\n예상치 못한 kprobe 존재 여부: /sys/kernel/debug/kprobes/list를 확인하여 등록된 kprobe 중 평소 시스템에서는 볼 수 없는 후킹 지점이 있는지 살펴봅니다​redcanary.com. 예를 들어 사용자 공간에 로드한 적 없는 함수에 대한 kprobe가 걸려 있다면 루트킷을 의심해야 합니다.\n로드된 eBPF 프로그램 나열: bpftool prog 명령으로 현재 메모리에 상주하는 eBPF 프로그램 목록을 확인합니다. 일반적인 시스템에도 cgroup_skb 등 몇몇 eBPF 프로그램이 있을 수 있지만, kprobe 유형 프로그램이나 이상한 이름/경로로 로드된 것이 있다면 주의해야 합니다​redcanary.com. 또한 bpftool perf로 eBPF가 연결된 퍼프 이벤트(perf event) 정보를 보면, 어떤 PID가 어떤 커널 함수에 kprobe/uretprobe를 걸었는지 알 수 있어 수상한 후킹을 찾아낼 수 있습니다​redcanary.com.\n네트워크 훅 및 XDP 확인: ip link show로 네트워크 인터페이스에 XDP 프로그램이 붙어있는지 (prog/xdp id ... 형태) 확인하고​redcanary.com, tc filter show로 트래픽 필터에 eBPF가 사용되었는지 검사합니다. 일반적인 시스템에서는 사용되지 않는 XDP나 TC 필터가 활성화되어 있다면 의심해볼 수 있습니다.\nBPF 가상파일시스템(bpffs) 점검: /sys/fs/bpf/ 디렉토리에 pinning된 객체(eBPF 프로그램이나 맵)가 존재하는지 확인합니다​redcanary.com. 공격자는 eBPF 객체를 pin시켜 영구 저장해두기도 하므로, 알 수 없는 핀 객체가 있다면 분석이 필요합니다.\n시스템 로그 모니터링: 커널 로그(dmesg) 등에 BPF 관련 경고나 오류 메시지가 남았는지 확인합니다. 예를 들어 권한 없는 사용자가 BPF를 시도하다 실패한 로그, 또는 bpf_override_return 등의 위험한 helper 함수 사용 경고가 기록되었을 수 있습니다.\n이상의 방법들은 2023~2024년 보안 블로그와 보고서들에서 공통적으로 권장되는 후속 탐지 기법들입니다​redcanary.com​redcanary.com. 핵심은 시스템 상태를 다각도로 검사하여 eBPF 백도어의 흔적을 찾는 것으로, 일반적인 패턴과 벗어나는 BPF 관련 항목은 모두 수집하여 심층 분석해야 합니다.\n실제 사례: eBPF 백도어 탐지와 대응 BPFDoor 백도어 사례는 eBPF 탐지의 중요성을 일깨워준 대표적 사건입니다. BPFDoor는 2010년대 후반부터 발견된 리눅스 백도어로, 리눅스의 클래식 BPF(cBPF) 필터를 이용해 특정 매직 패킷을 감지하면 공격자의 쉘 접속을 열어주는 방식으로 동작했습니다​trendmicro.com​trendmicro.com. 방화벽 규칙을 회피하고 포트 스캐닝으로 드러나지 않는 기법 탓에 “문이 없는 백도어”라고도 불렸습니다. 2022년 이 백도어가 공개된 후, 2023년에는 APT 공격자들이 BPF 필터 복잡도를 높이는 등 백도어를 고도화하여 계속 활용한 정황이 포착되었습니다​trendmicro.com​trendmicro.com.\n보안 업체들은 BPFDoor 탐지를 위해 네트워크 및 호스트 수준의 징후를 모두 활용했습니다. 예를 들어 Trend Micro는 자사 제품에 BPFDoor의 BPF 필터 패턴을 식별하는 시그니처를 추가하여 탐지율을 높였으며​trendmicro.com​trendmicro.com, 침해 조사 시 setsockopt로 BPF 필터를 삽입하는 행위를 로그에서 찾아내거나, 수상한 raw 소켓을 보유한 프로세스를 추적하는 방식으로 BPFDoor를 찾아냈습니다. 또한 최신 변종 분석을 통해 백도어 활성화 트리거 패킷의 매직 넘버나 BPF 명령어 수 등을 파악함으로써, 이후 샘플에서는 필터 명령이 6배 증가하는 등 진화 양상을 확인하고 방어에 반영했습니다​trendmicro.com​trendmicro.com. BPFDoor 사례는 eBPF 기반 백도어도 면밀히 탐지 가능함을 보여주었지만, 동시에 공격자들도 대응책을 우회하도록 기법을 꾸준히 업데이트하고 있음을 시사합니다.\n다른 실례로 앞서 언급한 Pamspy 멀웨어의 탐지 과정이 있습니다. Pamspy는 eBPF uretprobe를 이용해 libpam.so의 인증 함수 결과를 가로챈 신종 멀웨어인데, Aqua Security 연구진이 Tracee 오픈소스 도구로 이 공격을 탐지해 발표했습니다. Tracee의 경고 로그에는 pam_get_authtok 함수를 후킹한 eBPF 프로그램의 이름과 메모리 오프셋 등이 기록되었고, 이를 통해 시스템 내 숨겨진 백도어 프로세스 없이도 eBPF만으로 자격 증명을 유출하는 공격을 식별해낸 사례입니다​aquasec.com. 이처럼 최신 침해 사례에서는 eBPF 탐지 도구의 활용이 점점 중요해지고 있으며, 커뮤니티와 업체들이 관련 정보를 공유하면서 방어 전략을 발전시키고 있습니다.\n대응 전략 및 실용적 권고사항 eBPF 기반 백도어에 대응하기 위해서는 다층적인 탐지와 예방 전략이 요구됩니다. 아래는 실무적으로 적용할 수 있는 권고사항입니다:\n권한 관리 및 하드닝: 서버에서 eBPF가 불필요하다면 아예 커널 컴파일 옵션이나 sysctl 설정으로 비활성화해놓습니다​sysdig.com. 특히 비권한 사용자(CAP_BPF 권한 미보유)가 eBPF를 사용할 수 없도록 하고, CONFIG_BPF_JIT_ALWAYS_ON 등을 통해 eBPF JIT의 악용 가능성을 낮춥니다. 또한 사용하지 않는 kprobe/tracepoint 기능은 꺼두는 것이 좋습니다​redcanary.com.\n실시간 모니터링 도구 활용: 운영 환경에 오픈소스 HIDS/EDR 도구를 배포하여 eBPF 관련 이벤트를 모니터링합니다. 예를 들어 Falco를 사용하면 bpf() 시스템콜이나 perf_event_open 호출을 룰(rule) 기반으로 감시해 이상 행동을 경고할 수 있고​sysdig.com, Tracee를 데몬으로 실행하면 루트킷이 커널에 훅을 거는 순간 상세 정보를 로그로 남길 수 있습니다​scitepress.org. 이러한 도구는 가볍게 컨테이너화하여 배포할 수도 있으므로, 상시 탐지 체계로 활용합니다.\n정기적 무결성 검사: 크론(cron) 등을 활용해 일정 주기마다 bpftool을 실행하고 로드된 eBPF 프로그램 목록을 덤프하도록 스크립트를 구성합니다. 이전 출력과 **비교(diff)**하여 신규로 등장한 프로그램이나 변화가 있는지를 체크하고, 발견 시 보안 담당자에게 알림을 주도록 합니다. 특히 프로덕션 환경에서 평소 로드되지 않는 kprobe, tracepoint 유형의 프로그램 ID가 새로 생겼다면 즉시 분석이 필요합니다​redcanary.com. 이와 함께 /sys/fs/bpf 디렉토리 내용과 /sys/kernel/debug/kprobes/list도 정기 확인하면 은밀하게 상주하는 백도어를 걸러내는 데 도움이 됩니다​redcanary.com​redcanary.com.\n포렌식 대비: 고급 공격에 대비해 메모리 포렌식 절차를 마련해 둡니다. 중요 서버에는 가능하다면 하이퍼바이저 기반 스냅샷이나 원격 메모리 덤프 수단을 준비하고, 사고 발생 시 Volatility 플러그인 등을 활용해 커널 메모리를 분석함으로써 루트킷이 숨긴 흔적까지 탐지할 수 있도록 합니다​scitepress.org. 이러한 포렌식은 최후의 수단이지만, eBPF 백도어처럼 흔적을 남기지 않는 공격에 대한 마지막 안전망이 될 수 있습니다.\n업데이트 및 정보 공유: eBPF 보안은 최신 연구와 사례 공유가 활발히 이루어지는 분야입니다. 관리자들은 보안 업체의 블로그, 컨퍼런스 자료를 지속적으로 팔로업하여 **최신 IOC(Indicators of Compromise)**와 탐지 룰을 업데이트해야 합니다. 예를 들어 BPFDoor의 새로운 변종에 대응한 시그니처나, GitHub에 공개된 새로운 eBPF 루트킷 샘플 등을 빠르게 입수하여 자체적인 탐지 규칙에 반영해야 합니다.\n결론적으로, eBPF 백도어 탐지는 최신 기술 동향을 반영한 다층적 접근이 요구됩니다. 실시간 모니터링과 사후 검증, 예방적 하드닝을 조합하여 대응하고, 커뮤니티의 오픈소스 도구와 정보를 적극 활용하는 것이 중요합니다. eBPF는 향후에도 공격자에게 매력적인 도구인 만큼, 수비 측에서도 eBPF의 힘을 역이용해 커널을 감시하고 위협을 조기에 차단하는 노력이 필요합니다​sysdig.com. 지속적인 연구 개발과 정보 공유를 통해, 보안 전문가들은 새로운 eBPF 기반 공격 기법에도 한 발 앞선 탐지 능력을 갖추어 나가야 할 것입니다​redcanary.com.\n참고 자료: 주요 내용은 2023~2025년에 발표된 공개 자료를 참고하였으며, Aqua Security, Sysdig, Trend Micro, Red Canary 등의 공식 블로그와 학술 연구​scitepress.org​scitepress.org를 기반으로 정리되었습니다. 각주에 표시된 출처를 통해 세부 내용을 확인할 수 있습니다.\n","wordCount":"3120","inLanguage":"ko","datePublished":"2025-04-28T00:00:00Z","dateModified":"2025-04-28T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://windshock.github.io/ko/post/2025-04-29-ebpf-backdoor-detection-framework/"},"publisher":{"@type":"Organization","name":"Code Before Breach","logo":{"@type":"ImageObject","url":"https://windshock.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://windshock.github.io/ko/ accesskey=h title="Code Before Breach (Alt + H)"><img src=https://windshock.github.io/images/logo-terminal-animated.svg alt aria-label=logo class="h-7 w-auto" height=28>Code Before Breach</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://windshock.github.io/en/ title=English aria-label=English>En</a></li></ul></div></div><ul id=menu><li><a href=https://windshock.github.io/ko/search/ title="검색 (Alt + /)" accesskey=/><span>검색</span></a></li><li><a href=https://windshock.github.io/ko/tags/ title=태그><span>태그</span></a></li><li><a href=https://windshock.github.io/ko/categories/ title=카테고리><span>카테고리</span></a></li><li><a href=https://windshock.github.io/ko/archives/ title=아카이브><span>아카이브</span></a></li><li><a href=https://windshock.github.io/ko/about/ title=소개><span>소개</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://windshock.github.io/ko/>홈</a>&nbsp;»&nbsp;<a href=https://windshock.github.io/ko/post/>Posts</a></div><h1 class="post-title entry-hint-parent">eBPF 기반 백도어 탐지 프레임워크와 최신 방법론</h1><div class=post-meta><span title='2025-04-28 00:00:00 +0000 UTC'>4월 28, 2025</span>&nbsp;·&nbsp;15 분&nbsp;·&nbsp;3120 단어&nbsp;|&nbsp;번역:<ul class=i18n_list><li><a href=https://windshock.github.io/en/post/2025-04-29-ebpf-backdoor-detection-framework/>En</a></li></ul></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>목차</span></summary><div class=inner><ul><li><a href=#%ea%b0%9c%ec%9a%94-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4%ec%9d%98-%eb%b6%80%ec%83%81%ea%b3%bc-%ed%83%90%ec%a7%80-%ea%b3%bc%ec%a0%9c aria-label="개요: eBPF 백도어의 부상과 탐지 과제">개요: eBPF 백도어의 부상과 탐지 과제</a></li><li><a href=#ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4%ec%9d%98-%ed%83%90%ec%a7%80-%ec%96%b4%eb%a0%a4%ec%9b%80 aria-label="eBPF 백도어의 탐지 어려움">eBPF 백도어의 탐지 어려움</a></li><li><a href=#%eb%a6%ac%eb%88%85%ec%8a%a4-%eb%b0%b1%ec%8b%a0anti-virus%eb%a1%9c-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4%ea%b0%80-%ec%bb%a4%eb%b2%84%eb%90%98%ec%a7%80-%ec%95%8a%eb%8a%94-%ec%9d%b4%ec%9c%a0 aria-label="리눅스 백신(Anti-Virus)로 eBPF 백도어가 커버되지 않는 이유">리눅스 백신(Anti-Virus)로 eBPF 백도어가 커버되지 않는 이유</a><ul><li><a href=#%ec%a3%bc%ec%9a%94-%ec%9d%b4%ec%9c%a0 aria-label="주요 이유">주요 이유</a></li><li><a href=#%ed%98%84%ec%8b%a4%ec%a0%81-%ea%b2%b0%eb%a1%a0 aria-label="현실적 결론">현실적 결론</a></li></ul></li><li><a href=#tracee-vs-lkrg-%ea%b0%81%ea%b0%81%ec%9d%98-%ec%97%ad%ed%95%a0 aria-label="Tracee vs LKRG: 각각의 역할">Tracee vs LKRG: 각각의 역할</a><ul><li><a href=#%ec%9a%94%ec%95%bd aria-label=요약>요약</a></li></ul></li><li><a href=#bpfdoor-%ed%83%90%ec%a7%80%eb%a5%bc-%ec%9c%84%ed%95%9c-%ea%b0%84%eb%8b%a8%ed%95%9c-%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8 aria-label="BPFDoor 탐지를 위한 간단한 스크립트: bpfdoor_detector.sh">BPFDoor 탐지를 위한 간단한 스크립트: bpfdoor_detector.sh</a><ul><li><a href=#%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%ed%8a%b9%ec%a7%95 aria-label="스크립트 특징">스크립트 특징</a></li><li><a href=#%ec%82%ac%ec%9a%a9%eb%b2%95 aria-label=사용법>사용법</a></li><li><a href=#%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%ec%bd%94%eb%93%9c-%ec%a0%84%eb%ac%b8 aria-label="스크립트 코드 전문">스크립트 코드 전문</a></li><li><a href=#%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad aria-label=주의사항>주의사항</a></li></ul></li><li><a href=#openstack-%ed%99%98%ea%b2%bd%ec%97%90%ec%84%9c%ec%9d%98-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4-%ec%a0%90%ea%b2%80-%eb%b0%a9%eb%b2%95 aria-label="OpenStack 환경에서의 eBPF 백도어 점검 방법">OpenStack 환경에서의 eBPF 백도어 점검 방법</a><ul><li><a href=#bpftool%ec%9d%84-%ec%9d%b4%ec%9a%a9%ed%95%9c-%ec%a0%90%ea%b2%80-%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8 aria-label="bpftool을 이용한 점검 스크립트">bpftool을 이용한 점검 스크립트</a></li><li><a href=#%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%ec%83%81%ec%84%b8-%ec%84%a4%eb%aa%85 aria-label="스크립트 상세 설명">스크립트 상세 설명</a></li><li><a href=#%ec%b6%94%ea%b0%80-%ea%b3%a0%ea%b8%89-%eb%b0%a9%eb%b2%95-guest-os-%ea%b3%b5%ed%86%b5-%ed%8c%a8%ed%84%b4-%ec%a0%9c%ea%b1%b0-%eb%b0%8f-%ec%9d%b4%ec%83%81-%ec%a7%95%ed%9b%84-%ed%95%84%ed%84%b0%eb%a7%81 aria-label="추가 고급 방법: Guest OS 공통 패턴 제거 및 이상 징후 필터링">추가 고급 방법: Guest OS 공통 패턴 제거 및 이상 징후 필터링</a><ul><li><a href=#%ea%b0%84%eb%8b%a8%ed%95%9c-%ed%95%84%ed%84%b0%eb%a7%81-%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%ec%98%88%ec%8b%9c aria-label="간단한 필터링 스크립트 예시">간단한 필터링 스크립트 예시</a></li><li><a href=#%ec%84%a4%eb%aa%85 aria-label=설명>설명</a></li></ul></li><li><a href=#%ec%9e%90%eb%8f%99-%ed%95%99%ec%8a%b5-%ea%b8%b0%eb%b0%98-%ea%b3%b5%ed%86%b5-%ed%8c%a8%ed%84%b4-%ea%b0%b1%ec%8b%a0-diff-%eb%b0%a9%ec%8b%9d aria-label="자동 학습 기반 공통 패턴 갱신 (diff 방식)">자동 학습 기반 공통 패턴 갱신 (diff 방식)</a><ul><li><a href=#%ec%9e%90%eb%8f%99-%ed%95%99%ec%8a%b5-%ec%8a%a4%ed%81%ac%eb%a6%bd%ed%8a%b8-%ec%98%88%ec%8b%9c aria-label="자동 학습 스크립트 예시">자동 학습 스크립트 예시</a></li><li><a href=#%ec%84%a4%eb%aa%85-1 aria-label=설명>설명</a></li></ul></li></ul></li><li><a href=#vsphere--vmware-nsx-%ed%99%98%ea%b2%bd%ec%97%90%ec%84%9c%ec%9d%98-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4-%eb%8c%80%ec%9d%91 aria-label="vSphere + VMware NSX 환경에서의 eBPF 백도어 대응">vSphere + VMware NSX 환경에서의 eBPF 백도어 대응</a><ul><li><a href=#%ea%b0%80%eb%8a%a5%ed%95%9c-%ed%83%90%ec%a7%80-%eb%b0%a9%ed%96%a5 aria-label="가능한 탐지 방향">가능한 탐지 방향</a></li><li><a href=#%ec%a3%bc%ec%9d%98%ec%82%ac%ed%95%ad-1 aria-label=주의사항>주의사항</a></li></ul></li><li><a href=#%ea%b3%b5%ea%b0%9c%eb%90%9c-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4-%ed%83%90%ec%a7%80-%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac-%eb%b0%8f-%eb%8f%84%ea%b5%ac aria-label="공개된 eBPF 백도어 탐지 프레임워크 및 도구">공개된 eBPF 백도어 탐지 프레임워크 및 도구</a></li><li><a href=#%ec%b5%9c%ec%8b%a0-%ed%83%90%ec%a7%80-%eb%b0%a9%eb%b2%95%eb%a1%a0-20232025%ea%b3%bc-%ec%97%b0%ea%b5%ac-%eb%8f%99%ed%96%a5 aria-label="최신 탐지 방법론 (2023~2025)과 연구 동향">최신 탐지 방법론 (2023~2025)과 연구 동향</a></li><li><a href=#%ec%8b%a4%ec%a0%9c-%ec%82%ac%eb%a1%80-ebpf-%eb%b0%b1%eb%8f%84%ec%96%b4-%ed%83%90%ec%a7%80%ec%99%80-%eb%8c%80%ec%9d%91 aria-label="실제 사례: eBPF 백도어 탐지와 대응">실제 사례: eBPF 백도어 탐지와 대응</a></li><li><a href=#%eb%8c%80%ec%9d%91-%ec%a0%84%eb%9e%b5-%eb%b0%8f-%ec%8b%a4%ec%9a%a9%ec%a0%81-%ea%b6%8c%ea%b3%a0%ec%82%ac%ed%95%ad aria-label="대응 전략 및 실용적 권고사항">대응 전략 및 실용적 권고사항</a></li></ul></div></details></div><div class=post-content><p><img alt="ebpf hook overview" loading=lazy src=https://ebpf.io/static/99c69bbff092c35b9c83f00a80fed240/fb370/hook-overview.webp></p><h2 id=개요-ebpf-백도어의-부상과-탐지-과제><strong>개요: eBPF 백도어의 부상과 탐지 과제</strong><a hidden class=anchor aria-hidden=true href=#개요-ebpf-백도어의-부상과-탐지-과제>#</a></h2><p>eBPF(extended BPF)은 리눅스 커널에 동적으로 프로그램을 삽입할 수 있는 강력한 기술로, 원래 성능 모니터링이나 보안 등 <strong>정상적인 용도</strong>로 널리 활용되고 있습니다​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=eBPF%20has%20gained%20a%20lot,specified%29%20kernel%20events%20occur">sysdig.com</a>​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=In%20fact%2C%20in%20the%20many,and%20also%20enforce%20security%20policies">sysdig.com</a>. 그러나 최근 몇 년 사이 공격자들이 <strong>eBPF를 악용한 백도어 및 루트킷</strong>을 개발하면서, eBPF는 보안 측면에서 <em>양날의 검</em>이 되었습니다​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=protect%20organizations,malicious%20usage%20of%20the%20eBPF">aquasec.com</a>. 실제로 2023년 이후 eBPF를 이용한 루트킷(<code>ebpfkit</code>, <code>TripleCross</code> 등)과 멀웨어(<code>Pamspy</code> 등)이 등장하여 암암리에 인증 정보 탈취, 방화벽 우회 등의 <strong>악성 행위</strong>에 활용되고 있습니다​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=protect%20organizations,malicious%20usage%20of%20the%20eBPF">aquasec.com</a>. 이러한 eBPF 기반 백도어는 커널 레벨에서 동작하기 때문에 <strong>탐지가 매우 까다롭고</strong> 전통적인 보안 도구로는 놓치기 쉽습니다​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>. 아래에서는 공개된 탐지 프레임워크와 도구, 최신 연구 동향, 탐지의 어려움과 대응 전략, 실제 사례 및 활용 가능한 도구를 종합적으로 정리합니다.</p><h2 id=ebpf-백도어의-탐지-어려움><strong>eBPF 백도어의 탐지 어려움</strong><a hidden class=anchor aria-hidden=true href=#ebpf-백도어의-탐지-어려움>#</a></h2><p><strong>eBPF 백도어는 일반적인 루트킷 탐지 방식으로는 식별하기 어렵습니다.</strong> eBPF 프로그램은 기존 커널 모듈과 달리 별도 모듈로 표시되지 않고, 커널의 BPF VM 내에서 실행되므로 <strong>은폐</strong>에 유리합니다. 예를 들어 APT 공격에 사용된 <code>BPFDoor</code> 백도어는 커널에 패킷 필터를 삽입하여 <strong>방화벽 규칙을 우회</strong>하면서도 네트워크 포트가 열려 있지 않은 것처럼 위장하여 탐지를 회피했습니다​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>. 또한 eBPF 루트킷이 시스템에 설치되고 나면, <strong>시스템 진단 도구의 출력 자체를 조작</strong>하여 자신의 존재를 숨길 수 있습니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>. Red Canary 분석에 따르면, eBPF 기반 멀웨어가 일단 로드된 후에는 <code>bpftool</code>이나 <code>debugfs</code>와 같은 툴의 결과도 신뢰하기 어려울 정도로 교묘하게 숨길 수 있다고 합니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>. 따라서 <strong>로드 시점</strong>에 탐지하지 못하면 사후 탐지는 매우 난관이며, 이것이 eBPF 백도어 탐지의 핵심 어려움입니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>.</p><p>이러한 어려움을 극복하기 위해 <strong>실시간 모니터링</strong>과 <strong>사후 포렌식 기법</strong>을 모두 활용하는 전략이 필요합니다. 예를 들어 <strong>탐지 도구를 커널 수준에서 동작</strong>시켜 eBPF 프로그램의 로딩 이벤트를 가로채면, 악성 eBPF가 활동을 시작하는 <strong>초기에 탐지</strong>할 수 있습니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>. 반면, 이미 활성화된 루트킷에 대해서는 <strong>하이퍼바이저나 메모리 포렌식</strong>을 통해 바깥에서 커널 메모리를 검사하는 기법이 고려됩니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>. 아래에서는 이러한 <strong>실시간 탐지 프레임워크</strong>들과 <strong>연구 기반 방법론</strong>을 상세히 살펴보고, 각 접근법의 특징과 한계를 논의합니다.</p><h2 id=리눅스-백신anti-virus로-ebpf-백도어가-커버되지-않는-이유><strong>리눅스 백신(Anti-Virus)로 eBPF 백도어가 커버되지 않는 이유</strong><a hidden class=anchor aria-hidden=true href=#리눅스-백신anti-virus로-ebpf-백도어가-커버되지-않는-이유>#</a></h2><p><strong>결론:</strong> 일반 리눅스 백신(Anti-Virus)으로는 eBPF 기반 백도어를 탐지하거나 차단할 수 없습니다.</p><h3 id=주요-이유><strong>주요 이유</strong><a hidden class=anchor aria-hidden=true href=#주요-이유>#</a></h3><ul><li><strong>eBPF 백도어는 파일 기반이 아님</strong>: 리눅스 백신은 파일 시스템 상에 존재하는 악성 파일을 스캔하는데 최적화되어 있습니다. 하지만 eBPF 프로그램은 커널 BPF 서브시스템 안에 로드되어 특정 이벤트에 연결되어 실행되므로, 파일 시스템에는 직접 존재하지 않습니다.</li><li><strong>커널 내부 활동은 감시 불가</strong>: 전통적인 리눅스 백신은 유저스페이스 프로세스와 디스크 I/O를 주로 감시합니다. 커널 스페이스에서 동작하는 eBPF 프로그램은 탐지 대상이 아닙니다.</li><li><strong>정보 조작 가능성</strong>: eBPF 루트킷은 시스템콜, 프로세스 목록, 파일 목록을 조작할 수 있습니다. 따라서 백신이 보는 정보 자체가 변조되어 있을 수 있습니다.</li><li><strong>백신 스캐너는 BPF Hook까지 감지하지 못함</strong>: 시스템콜 테이블 후킹, kprobe/uprobe attach 등 커널 레벨 후킹은 전통 백신의 탐지 범위를 넘어서 있습니다.</li></ul><h3 id=현실적-결론><strong>현실적 결론</strong><a hidden class=anchor aria-hidden=true href=#현실적-결론>#</a></h3><ul><li><strong>파일형 악성코드</strong>(웹쉘, 트로이목마)는 커버 가능</li><li><strong>커널 스페이스 eBPF 백도어</strong>는 커버 불가</li><li><strong>커널 모듈 기반 루트킷</strong>도 커버 불가</li></ul><p>&ldquo;리눅스 백신은 기본적으로 eBPF 백도어를 탐지할 수 없다. 커널 수준 무결성 보호 없이는 신뢰할 수 없다.&rdquo;</p><p><strong>따라서 LKRG(Linux Kernel Runtime Guard)와 같은 커널 무결성 보호 모듈이 필요합니다.</strong></p><hr><h2 id=tracee-vs-lkrg-각각의-역할><strong>Tracee vs LKRG: 각각의 역할</strong><a hidden class=anchor aria-hidden=true href=#tracee-vs-lkrg-각각의-역할>#</a></h2><p>eBPF 백도어나 커널 루트킷에 대응할 때, Tracee와 LKRG는 서로 다른 층위를 보완합니다.</p><table><thead><tr><th>항목</th><th>Tracee</th><th>LKRG</th></tr></thead><tbody><tr><td><strong>무엇을 감시?</strong></td><td>커널 이벤트 (bpf 호출, execve, open 등)</td><td>커널 객체 무결성 (시스템콜 테이블, 크리덴셜 등)</td></tr><tr><td><strong>언제 감시?</strong></td><td>공격 &ldquo;행위(Event)&rdquo; 발생 시 탐지</td><td>커널 구조 변조 &ldquo;시도&rdquo; 발생 시 탐지</td></tr><tr><td><strong>탐지 포인트</strong></td><td>시스템콜 레벨</td><td>커널 메모리 구조체 레벨</td></tr><tr><td><strong>초점</strong></td><td>이상 징후 헌팅 (Hunting)</td><td>무결성 보장 및 방어 (Protection)</td></tr><tr><td><strong>방식</strong></td><td>이벤트 기록 및 경보 (Passive)</td><td>무결성 위반 시 즉시 차단 또는 경고 (Active)</td></tr><tr><td><strong>성격</strong></td><td>사고 후 대응 중심</td><td>사고 사전 차단 중심</td></tr></tbody></table><h3 id=요약><strong>요약</strong><a hidden class=anchor aria-hidden=true href=#요약>#</a></h3><ul><li><strong>Tracee</strong>는 이상 행위를 &ldquo;찍어서&rdquo; 기록하는 보안 CCTV 역할을 합니다.</li><li><strong>LKRG</strong>는 커널 구조 자체를 감시해서 변조를 &ldquo;막는&rdquo; 방범창 역할을 합니다.</li></ul><p><strong>둘을 함께 사용할 때 가장 강력한 보호가 가능합니다.</strong></p><p>&ldquo;Tracee만 쓰면 사고는 기록되지만 막을 수 없고, LKRG만 쓰면 기록은 남지 않는다. 따라서 둘을 병행해야 탐지와 방어가 동시에 이뤄진다.&rdquo;</p><h2 id=bpfdoor-탐지를-위한-간단한-스크립트><strong>BPFDoor 탐지를 위한 간단한 스크립트: <code>bpfdoor_detector.sh</code></strong><a hidden class=anchor aria-hidden=true href=#bpfdoor-탐지를-위한-간단한-스크립트>#</a></h2><p>eBPF 백도어 중 하나인 <strong>BPFDoor</strong>와 유사한 행동을 보이는 프로세스를 탐지하기 위해 설계된 경량 스크립트입니다.</p><h3 id=스크립트-특징><strong>스크립트 특징</strong><a hidden class=anchor aria-hidden=true href=#스크립트-특징>#</a></h3><ul><li><strong>삭제된 실행파일</strong> <code>(deleted)</code> 상태로 실행 중인 프로세스 탐지</li><li><strong>BPF 소켓</strong>을 사용하는 프로세스 필터링</li><li><strong>정상적인 BPF 사용 프로그램 제외</strong> (<code>tcpdump</code>, <code>wireshark</code>, <code>dhclient</code> 등)</li><li><strong>간단한 네트워크 연결 정보 표시</strong></li></ul><h3 id=사용법><strong>사용법</strong><a hidden class=anchor aria-hidden=true href=#사용법>#</a></h3><p>sudo ./bpfdoor_detector.sh</p><ul><li>반드시 루트 권한으로 실행해야 합니다.</li><li>필요 명령어: <code>ps</code>, <code>grep</code>, <code>readlink</code>, <code>ss</code></li></ul><h3 id=스크립트-코드-전문><strong>스크립트 코드 전문</strong><a hidden class=anchor aria-hidden=true href=#스크립트-코드-전문>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># BPFDoor-like Suspicious Process Detector</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check for root permission</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>id -u<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> -ne <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;[!] This script must be run as root.&#34;</span>
</span></span><span style=display:flex><span>  exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Check required commands</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> cmd in ps grep readlink ss; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> ! command -v $cmd &amp;&gt;/dev/null; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;[!] </span>$cmd<span style=color:#e6db74> command is required. Please install it first.&#34;</span>
</span></span><span style=display:flex><span>    exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Starting focused BPFDoor-like process detection...&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>found<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Iterate over all PIDs</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> pid in <span style=color:#66d9ef>$(</span>ls /proc/ | grep -E <span style=color:#e6db74>&#39;^[0-9]+$&#39;</span><span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>[</span> -d <span style=color:#e6db74>&#34;/proc/</span>$pid<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  exe_path<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>readlink /proc/$pid/exe 2&gt;/dev/null<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> $exe_path <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;(deleted)&#34;</span> <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -r /proc/$pid/net/packet <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -s /proc/$pid/net/packet <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      cmdline<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>ps -p $pid -o cmd<span style=color:#f92672>=</span> 2&gt;/dev/null<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> ! $cmdline <span style=color:#f92672>=</span>~ <span style=color:#e6db74>&#34;tcpdump|wireshark|dhclient&#34;</span> <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;[!] Suspicious process detected:&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;    - PID: </span>$pid<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;    - Command: </span>$cmdline<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;    - Deleted executable: </span>$exe_path<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;    - BPF socket is active&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ss -p -n 2&gt;/dev/null | grep <span style=color:#e6db74>&#34;pid=</span>$pid<span style=color:#e6db74>,&#34;</span> | awk <span style=color:#e6db74>&#39;{print &#34;    - Network: &#34; $0}&#39;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        found<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> $found -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;[*] No suspicious processes found.&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Detection completed.&#34;</span>
</span></span></code></pre></div><h3 id=주의사항><strong>주의사항</strong><a hidden class=anchor aria-hidden=true href=#주의사항>#</a></h3><ul><li>이 스크립트는 프로세스 레벨에서 간단한 힌트만 제공하는 <strong>경량 탐지 도구</strong>입니다.</li><li>고급 eBPF 루트킷은 <code>/proc</code> 정보까지 조작할 수 있으므로, 이 스크립트만으로는 완전한 보장이 되지 않습니다.</li><li><strong>커널 무결성 보호 모듈</strong>(예: LKRG)과 함께 사용할 것을 강력히 권장합니다.</li></ul><p>Without kernel integrity protection like LKRG, even detection results can be faked.</p><h2 id=openstack-환경에서의-ebpf-백도어-점검-방법><strong>OpenStack 환경에서의 eBPF 백도어 점검 방법</strong><a hidden class=anchor aria-hidden=true href=#openstack-환경에서의-ebpf-백도어-점검-방법>#</a></h2><p>OpenStack 환경에서는 호스트 OS(KVM Hypervisor)에서 직접 eBPF 활동을 점검할 수 있습니다.</p><h3 id=bpftool을-이용한-점검-스크립트><strong>bpftool을 이용한 점검 스크립트</strong><a hidden class=anchor aria-hidden=true href=#bpftool을-이용한-점검-스크립트>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># List all BPF programs</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Listing currently loaded BPF programs...&#34;</span>
</span></span><span style=display:flex><span>bpftool prog show
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># List all BPF maps</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Listing currently loaded BPF maps...&#34;</span>
</span></span><span style=display:flex><span>bpftool map show
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Optional: Check for unexpected XDP attachments</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Checking for XDP programs attached to network interfaces...&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> iface in <span style=color:#66d9ef>$(</span>ls /sys/class/net/<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  ip link show dev <span style=color:#e6db74>&#34;</span>$iface<span style=color:#e6db74>&#34;</span> | grep -q <span style=color:#e6db74>&#34;xdp&#34;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;[!] XDP attached: </span>$iface<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Optional: Check for TC filters</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Checking for TC filters...&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> iface in <span style=color:#66d9ef>$(</span>ls /sys/class/net/<span style=color:#66d9ef>)</span>; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>  tc filter show dev <span style=color:#e6db74>&#34;</span>$iface<span style=color:#e6db74>&#34;</span> 2&gt;/dev/null | grep -i <span style=color:#e6db74>&#34;bpf&#34;</span> <span style=color:#f92672>&amp;&amp;</span> echo <span style=color:#e6db74>&#34;[!] BPF TC filter detected on: </span>$iface<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] BPF scan completed.&#34;</span>
</span></span></code></pre></div><h3 id=스크립트-상세-설명><strong>스크립트 상세 설명</strong><a hidden class=anchor aria-hidden=true href=#스크립트-상세-설명>#</a></h3><ul><li><strong>bpftool prog show</strong>: 현재 커널에 로드되어 있는 eBPF 프로그램 전체 목록을 출력합니다. 악성 BPF 프로그램이 로드되어 있을 수 있으므로 필수 점검 항목입니다.</li><li><strong>bpftool map show</strong>: BPF 프로그램이 사용하는 데이터 맵(BPF map)을 모두 출력합니다. C2 명령 제어나 세션 유지에 악용될 수 있는 맵을 탐지하는 데 사용합니다.</li><li><strong>XDP (eXpress Data Path) attachment 검사</strong>:<ul><li><code>ip link show</code> 명령으로 각 네트워크 인터페이스에 XDP 프로그램이 붙어 있는지 검사합니다.</li><li>XDP는 NIC(Level 2)에서 바로 패킷을 가로채는 고속 패스 기술로, BPFDoor 같은 백도어가 은밀히 트래픽을 조작하거나 필터링하는 데 사용될 수 있습니다.</li></ul></li><li><strong>TC (Traffic Control) filter 검사</strong>:<ul><li><code>tc filter show</code> 명령으로 인터페이스에 연결된 BPF 기반 트래픽 필터를 확인합니다.</li><li>TC 필터는 네트워크 흐름을 조작하거나 특정 조건에서만 통신을 허용/차단하는 데 악용될 수 있습니다.</li></ul></li></ul><p>요약: bpftool 스크립트는 프로그램, 맵, XDP, TC 필터 네 가지 핵심 지점을 점검하여, OpenStack 호스트 수준에서 eBPF 백도어의 흔적을 조기에 탐지할 수 있습니다.</p><hr><h3 id=추가-고급-방법-guest-os-공통-패턴-제거-및-이상-징후-필터링><strong>추가 고급 방법: Guest OS 공통 패턴 제거 및 이상 징후 필터링</strong><a hidden class=anchor aria-hidden=true href=#추가-고급-방법-guest-os-공통-패턴-제거-및-이상-징후-필터링>#</a></h3><p>bpftool을 통해 수집한 모든 BPF 프로그램 정보는 OpenStack Hypervisor(KVM) 기준, 게스트 VM마다 공통적으로 로드된 정상 프로그램들도 포함되어 있습니다.</p><p>이때, 모든 Guest OS에 공통적으로 존재하는 정상 eBPF 프로그램은 필터링하고, 튀는(비정상적인) 프로그램만 추출하는 방식으로 점검 효율을 높일 수 있습니다.</p><h4 id=간단한-필터링-스크립트-예시><strong>간단한 필터링 스크립트 예시</strong><a hidden class=anchor aria-hidden=true href=#간단한-필터링-스크립트-예시>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e># Collect current BPF programs</span>
</span></span><span style=display:flex><span>bpftool prog show &gt; /tmp/bpf_prog_list_all.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Define known common patterns (adjust based on your environment)</span>
</span></span><span style=display:flex><span>COMMON_PATTERNS<span style=color:#f92672>=(</span><span style=color:#e6db74>&#34;kube-proxy&#34;</span> <span style=color:#e6db74>&#34;cilium&#34;</span> <span style=color:#e6db74>&#34;flannel&#34;</span> <span style=color:#e6db74>&#34;calico&#34;</span> <span style=color:#e6db74>&#34;ovs-vswitchd&#34;</span> <span style=color:#e6db74>&#34;normal VM agent&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Filter out common entries</span>
</span></span><span style=display:flex><span>grep -v -E <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>IFS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;|&#39;</span>; echo <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>COMMON_PATTERNS[*]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> /tmp/bpf_prog_list_all.txt &gt; /tmp/bpf_prog_suspicious.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Suspicious BPF programs after filtering:&#34;</span>
</span></span><span style=display:flex><span>cat /tmp/bpf_prog_suspicious.txt
</span></span></code></pre></div><h4 id=설명><strong>설명</strong><a hidden class=anchor aria-hidden=true href=#설명>#</a></h4><ul><li><strong>COMMON_PATTERNS</strong>: OpenStack 환경에서 VM들이 공통으로 사용하는 정상적인 BPF 프로그램 이름을 배열로 설정합니다.</li><li><strong>grep -v -E</strong>: 정상 패턴에 일치하지 않는 항목만 남깁니다.</li><li><strong>결과 파일</strong>: <code>/tmp/bpf_prog_suspicious.txt</code>에 비정상적으로 보이는 항목만 남겨 분석합니다.</li></ul><p>요약: 공통 정상 패턴을 제거하고 튀는 것만 보는 방식으로 필터링하면, OpenStack 호스트 수준에서도 eBPF 백도어를 훨씬 빠르게 식별할 수 있습니다.</p><hr><h3 id=자동-학습-기반-공통-패턴-갱신-diff-방식><strong>자동 학습 기반 공통 패턴 갱신 (diff 방식)</strong><a hidden class=anchor aria-hidden=true href=#자동-학습-기반-공통-패턴-갱신-diff-방식>#</a></h3><p>시간이 지남에 따라 Guest OS 공통 패턴은 변경될 수 있습니다. 따라서 수동으로 패턴을 관리하는 대신, 과거와 현재의 bpftool 결과를 비교(diff)하여 자동으로 갱신할 수 있습니다.</p><h4 id=자동-학습-스크립트-예시><strong>자동 학습 스크립트 예시</strong><a hidden class=anchor aria-hidden=true href=#자동-학습-스크립트-예시>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>BASELINE_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/opt/bpf_baseline.txt&#34;</span>
</span></span><span style=display:flex><span>CURRENT_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/tmp/bpf_current.txt&#34;</span>
</span></span><span style=display:flex><span>NEW_SUSPICIOUS_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/tmp/bpf_diff_suspicious.txt&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Collect current BPF programs</span>
</span></span><span style=display:flex><span>bpftool prog show &gt; <span style=color:#e6db74>&#34;</span>$CURRENT_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># If no baseline exists, create one</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -f <span style=color:#e6db74>&#34;</span>$BASELINE_FILE<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;[*] No baseline found. Creating initial baseline...&#34;</span>
</span></span><span style=display:flex><span>  cp <span style=color:#e6db74>&#34;</span>$CURRENT_FILE<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$BASELINE_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Compare current with baseline</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Comparing current BPF programs with baseline...&#34;</span>
</span></span><span style=display:flex><span>diff --unchanged-line-format<span style=color:#f92672>=</span> --old-line-format<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span>$BASELINE_FILE<span style=color:#e6db74>&#34;</span> --new-line-format<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;%L&#39;</span> <span style=color:#e6db74>&#34;</span>$CURRENT_FILE<span style=color:#e6db74>&#34;</span> &gt; <span style=color:#e6db74>&#34;</span>$NEW_SUSPICIOUS_FILE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;[*] Newly detected suspicious BPF programs:&#34;</span>
</span></span><span style=display:flex><span>cat <span style=color:#e6db74>&#34;</span>$NEW_SUSPICIOUS_FILE<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h4 id=설명-1><strong>설명</strong><a hidden class=anchor aria-hidden=true href=#설명-1>#</a></h4><ul><li><strong>BASELINE_FILE</strong>: 정상적인 BPF 프로그램 목록(기준)을 저장합니다.</li><li><strong>CURRENT_FILE</strong>: 현재 스캔한 BPF 프로그램 목록입니다.</li><li><strong>diff</strong> 명령어를 사용해 기준과 현재를 비교하고, 새로운 항목만 추출합니다.</li><li>새로운 eBPF 프로그램이 발견되면 바로 탐지할 수 있습니다.</li></ul><p>요약: 정기적으로 bpftool 스캔 결과를 저장하고, diff를 통해 변화를 추적하면 자동으로 튀는 프로그램만 선별할 수 있습니다.</p><hr><h2 id=vsphere--vmware-nsx-환경에서의-ebpf-백도어-대응><strong>vSphere + VMware NSX 환경에서의 eBPF 백도어 대응</strong><a hidden class=anchor aria-hidden=true href=#vsphere--vmware-nsx-환경에서의-ebpf-백도어-대응>#</a></h2><p>vSphere(ESXi) 환경에서는 게스트 OS 내부 감시는 어렵지만, NSX를 통해 네트워크 단에서 이상 행위를 감지할 수 있습니다.</p><h3 id=가능한-탐지-방향><strong>가능한 탐지 방향</strong><a hidden class=anchor aria-hidden=true href=#가능한-탐지-방향>#</a></h3><table><thead><tr><th>방법</th><th>설명</th></tr></thead><tbody><tr><td><strong>Distributed Firewall(DFW) 규칙 활용</strong></td><td>예상치 못한 outbound 포트, C2 서버 연결 시도를 탐지하거나 차단</td></tr><tr><td><strong>NSX IDS/IPS 기능 활성화</strong></td><td>BPFDoor 스타일 통신 패턴(비정상 UDP, ICMP 터널링 등)을 탐지</td></tr><tr><td><strong>Flow Analytics 활용</strong></td><td>VM 간 비정상 통신(East-West Movement) 흐름을 NSX가 분석하고 이상 징후 감지</td></tr><tr><td><strong>NSX Threat Intelligence</strong></td><td>NSX ATP(Advanced Threat Protection) 모듈이 활성화된 경우 Known IOC 매칭 가능</td></tr></tbody></table><h3 id=주의사항-1><strong>주의사항</strong><a hidden class=anchor aria-hidden=true href=#주의사항-1>#</a></h3><ul><li>NSX는 커널 내부 변조를 직접 탐지하지 못합니다. (네트워크 관점에서 탐지)</li><li>게스트 OS 내부 이상 행위에 대한 대응은 여전히 필요합니다. (Tracee, EDR 등 추가 권장)</li></ul><p>&ldquo;vSphere 환경에서는 NSX를 활용해 비정상 네트워크 패턴을 탐지하고, 게스트 OS 내부에서는 별도의 런타임 보안 도구로 커널 활동을 모니터링하는 이중 구조가 가장 효과적이다.&rdquo;</p><h2 id=공개된-ebpf-백도어-탐지-프레임워크-및-도구><strong>공개된 eBPF 백도어 탐지 프레임워크 및 도구</strong><a hidden class=anchor aria-hidden=true href=#공개된-ebpf-백도어-탐지-프레임워크-및-도구>#</a></h2><p>최근 공개된 여러 <strong>오픈소스 도구와 프레임워크</strong>가 eBPF 악성 활용을 탐지하기 위해 개발되었습니다. 주요 도구와 그 특징은 다음과 같습니다:</p><table><thead><tr><th>도구/프레임워크</th><th>접근 방식 및 주요 기능</th><th>비고</th></tr></thead><tbody><tr><td><strong>Tracee (Aqua Security)</strong></td><td>eBPF 기반 <strong>실시간 모니터링</strong> 도구로, 커널 이벤트를 추적하여 악성 행위를 탐지. 특히 eBPF 프로그램이 kprobe/tracepoint 등에 <strong>attach되는 순간</strong> 발생하는 <code>bpf_attach</code> 이벤트를 포착해 어떤 eBPF 프로그램(ID, 이름, 타입, 사용된 helper 함수 등)이 로드되는지 기록함​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Aqua%20Tracee%20%E2%80%93%20Out">aquasec.com</a>.</td><td>오픈소스 (GitHub 제공)​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=Security%2C%20A,In%202018%2011th">scitepress.org</a>. Aqua Security 연구팀이 개발하여 eBPF 루트킷과 멀웨어 탐지에 활용​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>.</td></tr><tr><td><strong>ebpfkit-monitor</strong></td><td>Datadog 연구원(Fournier)이 개발한 <strong>전용 탐지 툴</strong>로, eBPF 바이트코드를 <strong>정적 분석</strong>하거나 <strong>실행 시 모니터링</strong>하여 악의적인 eBPF 로딩을 탐지함. 원래 eBPF 루트킷인 <code>ebpfkit</code>을 검출하기 위해 설계되었으며, 의심스러운 eBPF 프로그램 로딩을 감시하고 차단 가능​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=On%20the%20other%20hand%2C%20ebpfkit,Such%20rootkits%20can%20hide%20themselves">scitepress.org</a>.</td><td>오픈소스 (GitHub 제공). eBPF 루트킷 <strong>ebpfkit</strong> 대응으로 개발​<a href="https://github.com/Gui774ume/ebpfkit-monitor#:~:text=%60ebpfkit,specifically%20designed%20to%20detect%20ebpfkit">github.com</a>.</td></tr><tr><td><strong>Falco (CNCF/Sysdig)</strong></td><td><strong>호스트 침입 탐지(HIDS)</strong> 도구로, eBPF를 통해 시스템 콜 등을 모니터링하여 악성 행위를 탐지. 최근 버전에서는 <code>bpf()</code> <strong>시스템콜 호출을 감시</strong>함으로써 권한 상승을 위한 eBPF 악용 시도를 탐지하고 경보를 발생시킬 수 있음​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>.</td><td>오픈소스 CNCF 프로젝트. 주로 컨테이너/클라우드 환경에서 활용되며, 정책을 설정해 eBPF 관련 이벤트를 추적 가능.</td></tr><tr><td><strong>bpftool (리눅스 기본 도구)</strong></td><td>리눅스 커널에 내장된 <strong>BPF 디버깅/관리 도구</strong>로, 현재 로드된 eBPF 프로그램, 맵, 링크 정보를 나열할 수 있음. 수동 조사 시 <code>bpftool prog</code>, <code>bpftool map</code>, <code>bpftool link</code>, <code>bpftool perf</code> 등의 명령으로 <strong>의심스러운 eBPF 프로그램</strong>(예: kprobe 유형 백도어)과 <strong>연결 지점</strong>(어떤 함수에 붙었는지)을 확인 가능​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,kretprobe%20func%20inet_csk_accept%20offset%200">redcanary.com</a>.</td><td>리눅스 4.x 이상에서 제공. 수동 조사나 스크립트로 활용하여 비정상적 BPF 객체(예: 알 수 없는 이름의 kprobe 프로그램 등) 탐지에 유용​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>.</td></tr><tr><td><strong>Volatility eBPF 플러그인</strong></td><td>메모리 포렌식 도구 <strong>Volatility</strong>용 플러그인으로, <strong>메모리 덤프에서 eBPF 프로그램을 추출</strong>하고 분석함. 커널 내부의 <code>prog_idr</code> 구조체를 탐색하여 로드된 모든 eBPF 바이트코드와 메타데이터(이름, 길이, 타입, 사용 helper 함수 등)를 수집​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=the%20compiled%20eBPF%20programs,the%20called%20functions%20are%20identified">scitepress.org</a>​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=The%20plugin%20output%20lists%20the,points%20to%20the%20compiled%20pro%02gram">scitepress.org</a>. 이를 바탕으로 악성 가능성이 높은 eBPF 프로그램을 선별하는 **분류기(classifier)**를 제공.</td><td>연구용 도구 (2024년 학술 연구에서 공개​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=the%20compiled%20eBPF%20programs,loading%20time%2C%20type%2C%20and%20code">scitepress.org</a>​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>). 실행 중인 시스템에서는 루트킷에 의해 우회될 수 있으나, <strong>하이퍼바이저나 오프라인 메모리 덤프</strong> 분석에 활용하여 내부 관찰자를 회피한 탐지가 가능함​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>.</td></tr></tbody></table><p>이들 도구는 각각 <strong>장단점과 적용 범위</strong>가 다릅니다. 예를 들어 <strong>Tracee</strong>와 <strong>Falco</strong>는 <strong>실시간 탐지</strong>에 강점이 있어, eBPF 백도어가 <strong>로드되는 순간</strong> 탐지하거나 실행 중 수상한 시스템콜 패턴을 식별합니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>. 반면 <strong>Volatility 플러그인</strong>과 같은 포렌식 도구는 <em>사후 분석</em>에 유용하며, <strong>이미 설치되어 은신 중인 루트킷</strong>도 하이퍼바이저 수준에서 메모리를 덤프하여 찾아낼 수 있습니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>. 이러한 도구들을 상황에 맞게 조합하면 다층적인 탐지 전략을 구축할 수 있습니다.</p><h2 id=최신-탐지-방법론-20232025과-연구-동향><strong>최신 탐지 방법론 (2023~2025)과 연구 동향</strong><a hidden class=anchor aria-hidden=true href=#최신-탐지-방법론-20232025과-연구-동향>#</a></h2><p>최근 공개된 <strong>연구 논문, 보안 보고서, 기술 블로그</strong>에서는 eBPF 백도어 탐지를 위한 다양한 접근법과 개선 사항을 제시하고 있습니다. 주요한 방법론은 다음과 같습니다:</p><ul><li><p><strong>실시간 로드 모니터링:</strong> 가장 효과적인 탐지는 eBPF 프로그램이 <strong>커널에 로드될 때</strong> 이루어집니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=If%20you%20suspect%20there%20may,based%20malware">redcanary.com</a>. Red Canary에 따르면, eBPF 기반 멀웨어는 로드 시점을 놓치면 탐지가 극도로 어려워지므로 EDR(Endpoint Detection & Response) 솔루션이나 커스텀 모니터링 도구가 <strong>bpf 시스템콜 호출, kprobe 등록</strong> 등의 이벤트를 실시간 감시해야 합니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=If%20you%20suspect%20there%20may,based%20malware">redcanary.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=If%20you%20suspect%20there%20may,can%E2%80%99t%20trust%20the%20data%20you">redcanary.com</a>. Aqua Security는 이와 관련해 Tracee 도구에 <code>bpf_attach</code> 이벤트 모니터링을 추가하여, 악성 eBPF 프로그램이 kprobe/uretprobe 등에 붙는 순간 자동으로 탐지하도록 구현했습니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Aqua%20Tracee%20%E2%80%93%20Out">aquasec.com</a>. 실제로 2023년 Aqua 측은 PAM 인증 모듈을 훔쳐보는 <strong>Pamspy 멀웨어</strong>를 Tracee로 탐지해냈는데, <code>pam_get_authtok</code> 함수를 후킹한 eBPF uretprobe 프로그램(<code>trace_pam_get_a</code>)의 로드 이벤트를 포착함으로써 <strong>평문 크리덴셜 탈취 시도를 적발</strong>할 수 있었습니다​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Below%20you%20can%20see%20a,clear%20text%20username%20and%20password">aquasec.com</a>. 이처럼 <strong>커널 내부 이벤트에 대한 훅(hook) 모니터링</strong>은 최신 EDR과 오픈소스 도구에서 중요한 추세입니다.</p></li><li><p><strong>커널 내부 무결성 검사 및 제한:</strong> eBPF 백도어를 원천 차단하거나 탐지하기 위해 <strong>커널 자체에 보안장치</strong>를 두는 연구도 진행되고 있습니다. 예를 들어 Sysdig의 보고는, 최신 커널 설정에서 <code>CONFIG_BPF_UNPRIV_DEFAULT_OFF</code>를 통해 비권한 사용자에 의한 eBPF 사용을 막고, <strong>SYS_bpf 시스템콜을 루트만 사용</strong>하도록 제한하는 것을 권고합니다​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20most%20effective%20way%20to,Kprobe%2C%20TC%2C%20and%20so%20on">sysdig.com</a>. 또한 eBPF에 의한 커널 함수 변조를 막기 위해 <code>CONFIG_BPF_KPROBE_OVERRIDE</code>와 같은 옵션을 비활성화하고, 불필요한 kprobe 기능이나 eBPF 기능은 아예 컴파일 제외하는 식으로 <strong>공격 표면을 줄이는 전략</strong>도 제시됩니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,programmatically%20disable%20things%20like%20kprobes">redcanary.com</a>. 이러한 설정은 탐지라기보다는 <strong>예방적 수단</strong>이지만, eBPF 악용을 사전에 차단함으로써 탐지 부담을 낮추는 효과가 있습니다.</p></li><li><p><strong>하이퍼바이저 기반 감사(Audit):</strong> 호스트 OS 내부에서 동작하는 탐지기는 동일한 커널 권한을 가진 루트킷에 의해 <strong>우회</strong>될 위험이 있습니다​<a href="https://blog.thalium.re/posts/linux-kernel-rust-module-for-rootkit-detection/#:~:text=to%20place%20our%20EDR%20in,the%20kernel">blog.thalium.re</a>. 이를 보완하고자, 2023~2024년 연구들은 <strong>하이퍼바이저 레벨</strong>에서 게스트의 eBPF 동작을 감사하는 방안을 모색했습니다. 예를 들어 2023년 SIGCOMM 워크숍의 <strong>HyperBee</strong> 연구는, 하이퍼바이저가 게스트 OS에 로드되는 모든 eBPF 프로그램을 <strong>사전에 검사</strong>하도록 하여 악성 코드를 차단하는 프레임워크를 제안했습니다​<a href="https://conferences.sigcomm.org/sigcomm/2023/files/workshop-ebpf/10-HyperBee.pdf#:~:text=Comprehensiveness,and%20their%20user%20space">conferences.sigcomm.org</a>. 마찬가지로 2024년 한 연구에서는 경량 하이퍼바이저를 이용해 <strong>게스트 메모리를 스냅샷</strong>하고, Volatility 플러그인으로 eBPF 프로그램을 추출한 뒤 <strong>의심스러운 helper 함수 호출 여부</strong> 등을 분류하는 기법을 선보였습니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=the%20compiled%20eBPF%20programs,the%20called%20functions%20are%20identified">scitepress.org</a>​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=The%20plugin%20output%20lists%20the,points%20to%20the%20compiled%20pro%02gram">scitepress.org</a>. 이러한 외부 감사 기법들은 <strong>은폐된 루트킷도 투명하게 들여다볼 수 있다는 점</strong>에서 향후 실용화 가능성이 주목됩니다.</p></li><li><p><strong>시스템 후속 검사 및 헌팅:</strong> 만약 실시간 탐지에 실패했다면, <strong>보안 담당자에 의한 수동 헌팅</strong>과 분석이 필요합니다. 최신 보고서들은 관리자가 의심 상황에서 다음 사항을 점검하라고 조언합니다:</p><ul><li><p><strong>예상치 못한 kprobe 존재 여부:</strong> <code>/sys/kernel/debug/kprobes/list</code>를 확인하여 등록된 kprobe 중 평소 시스템에서는 볼 수 없는 후킹 지점이 있는지 살펴봅니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>. 예를 들어 사용자 공간에 로드한 적 없는 함수에 대한 kprobe가 걸려 있다면 루트킷을 의심해야 합니다.</p></li><li><p><strong>로드된 eBPF 프로그램 나열:</strong> <code>bpftool prog</code> 명령으로 현재 메모리에 상주하는 eBPF 프로그램 목록을 확인합니다. 일반적인 시스템에도 <code>cgroup_skb</code> 등 몇몇 eBPF 프로그램이 있을 수 있지만, <code>kprobe</code> 유형 프로그램이나 이상한 이름/경로로 로드된 것이 있다면 주의해야 합니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>. 또한 <code>bpftool perf</code>로 <strong>eBPF가 연결된 퍼프 이벤트(perf event)</strong> 정보를 보면, 어떤 PID가 어떤 커널 함수에 kprobe/uretprobe를 걸었는지 알 수 있어 수상한 후킹을 찾아낼 수 있습니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,kretprobe%20func%20inet_csk_accept%20offset%200">redcanary.com</a>.</p></li><li><p><strong>네트워크 훅 및 XDP 확인:</strong> <code>ip link show</code>로 네트워크 인터페이스에 <code>XDP</code> 프로그램이 붙어있는지 (<code>prog/xdp id ...</code> 형태) 확인하고​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20loaded%20XDP%20programs,to%20this%20in%20the%20output">redcanary.com</a>, <code>tc filter show</code>로 <strong>트래픽 필터</strong>에 eBPF가 사용되었는지 검사합니다. 일반적인 시스템에서는 사용되지 않는 XDP나 TC 필터가 활성화되어 있다면 의심해볼 수 있습니다.</p></li><li><p><strong>BPF 가상파일시스템(bpffs) 점검:</strong> <code>/sys/fs/bpf/</code> 디렉토리에 <strong>pinning</strong>된 객체(eBPF 프로그램이나 맵)가 존재하는지 확인합니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Check%20if%20there%20are%20any,BPF%20filesystem">redcanary.com</a>. 공격자는 eBPF 객체를 pin시켜 영구 저장해두기도 하므로, 알 수 없는 핀 객체가 있다면 분석이 필요합니다.</p></li><li><p><strong>시스템 로그 모니터링:</strong> 커널 로그(<code>dmesg</code>) 등에 BPF 관련 경고나 오류 메시지가 남았는지 확인합니다. 예를 들어 권한 없는 사용자가 BPF를 시도하다 실패한 로그, 또는 <code>bpf_override_return</code> 등의 <strong>위험한 helper 함수 사용 경고</strong>가 기록되었을 수 있습니다.</p></li></ul></li></ul><p>이상의 방법들은 <strong>2023~2024년 보안 블로그와 보고서</strong>들에서 공통적으로 권장되는 후속 탐지 기법들입니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Check%20if%20there%20are%20any,BPF%20filesystem">redcanary.com</a>. 핵심은 <strong>시스템 상태를 다각도로 검사하여</strong> eBPF 백도어의 흔적을 찾는 것으로, 일반적인 패턴과 벗어나는 BPF 관련 항목은 모두 수집하여 심층 분석해야 합니다.</p><h2 id=실제-사례-ebpf-백도어-탐지와-대응><strong>실제 사례: eBPF 백도어 탐지와 대응</strong><a hidden class=anchor aria-hidden=true href=#실제-사례-ebpf-백도어-탐지와-대응>#</a></h2><p><strong>BPFDoor 백도어</strong> 사례는 eBPF 탐지의 중요성을 일깨워준 대표적 사건입니다. BPFDoor는 2010년대 후반부터 발견된 리눅스 백도어로, 리눅스의 <strong>클래식 BPF(cBPF) 필터</strong>를 이용해 특정 <strong>매직 패킷</strong>을 감지하면 공격자의 쉘 접속을 열어주는 방식으로 동작했습니다​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=BPFDoor%20samples%20load%20classic%20BPF,uniquely%20stand%20for%20specific%20identifiers">trendmicro.com</a>​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=The%20reverse%20connection%20is%20then,it%20opens%20is%20also%20privileged">trendmicro.com</a>. 방화벽 규칙을 회피하고 포트 스캐닝으로 드러나지 않는 기법 탓에 “문이 없는 백도어”라고도 불렸습니다. 2022년 이 백도어가 공개된 후, 2023년에는 APT 공격자들이 BPF 필터 복잡도를 높이는 등 <strong>백도어를 고도화</strong>하여 계속 활용한 정황이 포착되었습니다​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=This%20entry%20shows%20how%20Red,of%20BPFDoor%20in%20infected%20systems">trendmicro.com</a>​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=From%20a%20technical%20perspective%2C%20the,refer%20to%20the%20same%20technology">trendmicro.com</a>.</p><p>보안 업체들은 BPFDoor 탐지를 위해 <strong>네트워크 및 호스트 수준의 징후</strong>를 모두 활용했습니다. 예를 들어 <strong>Trend Micro</strong>는 자사 제품에 BPFDoor의 BPF 필터 패턴을 식별하는 <strong>시그니처</strong>를 추가하여 탐지율을 높였으며​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=Solaris%20operating%20systems%20%28OS%29,Trend%20products%E2%80%99%20monitoring%20and%20detection">trendmicro.com</a>, 침해 조사 시 <strong>setsockopt로 BPF 필터를 삽입</strong>하는 행위를 로그에서 찾아내거나, 수상한 <strong>raw 소켓을 보유한 프로세스</strong>를 추적하는 방식으로 BPFDoor를 찾아냈습니다. 또한 최신 변종 분석을 통해 <strong>백도어 활성화 트리거 패킷</strong>의 매직 넘버나 BPF 명령어 수 등을 파악함으로써, 이후 샘플에서는 필터 명령이 6배 증가하는 등 진화 양상을 확인하고 방어에 반영했습니다​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=This%20entry%20shows%20how%20Red,of%20BPFDoor%20in%20infected%20systems">trendmicro.com</a>​<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=From%20a%20technical%20perspective%2C%20the,refer%20to%20the%20same%20technology">trendmicro.com</a>. BPFDoor 사례는 <strong>eBPF 기반 백도어도 면밀히 탐지 가능</strong>함을 보여주었지만, 동시에 공격자들도 대응책을 우회하도록 기법을 꾸준히 업데이트하고 있음을 시사합니다.</p><p>다른 실례로 앞서 언급한 <strong>Pamspy</strong> 멀웨어의 탐지 과정이 있습니다. Pamspy는 eBPF <strong>uretprobe</strong>를 이용해 <code>libpam.so</code>의 인증 함수 결과를 가로챈 신종 멀웨어인데, Aqua Security 연구진이 <strong>Tracee 오픈소스 도구</strong>로 이 공격을 탐지해 발표했습니다. Tracee의 경고 로그에는 <code>pam_get_authtok</code> 함수를 후킹한 eBPF 프로그램의 이름과 메모리 오프셋 등이 기록되었고, 이를 통해 <strong>시스템 내 숨겨진 백도어 프로세스 없이도</strong> eBPF만으로 자격 증명을 유출하는 공격을 식별해낸 사례입니다​<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Below%20you%20can%20see%20a,clear%20text%20username%20and%20password">aquasec.com</a>. 이처럼 <em>최신 침해 사례에서는 eBPF 탐지 도구의 활용</em>이 점점 중요해지고 있으며, 커뮤니티와 업체들이 관련 정보를 공유하면서 방어 전략을 발전시키고 있습니다.</p><h2 id=대응-전략-및-실용적-권고사항><strong>대응 전략 및 실용적 권고사항</strong><a hidden class=anchor aria-hidden=true href=#대응-전략-및-실용적-권고사항>#</a></h2><p>eBPF 기반 백도어에 대응하기 위해서는 <strong>다층적인 탐지와 예방 전략</strong>이 요구됩니다. 아래는 실무적으로 적용할 수 있는 권고사항입니다:</p><ul><li><p><strong>권한 관리 및 하드닝:</strong> 서버에서 eBPF가 불필요하다면 아예 커널 컴파일 옵션이나 sysctl 설정으로 <strong>비활성화</strong>해놓습니다​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20most%20effective%20way%20to,Kprobe%2C%20TC%2C%20and%20so%20on">sysdig.com</a>. 특히 비권한 사용자(<code>CAP_BPF</code> 권한 미보유)가 eBPF를 사용할 수 없도록 하고, <code>CONFIG_BPF_JIT_ALWAYS_ON</code> 등을 통해 eBPF JIT의 악용 가능성을 낮춥니다. 또한 사용하지 않는 kprobe/tracepoint 기능은 꺼두는 것이 좋습니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,programmatically%20disable%20things%20like%20kprobes">redcanary.com</a>.</p></li><li><p><strong>실시간 모니터링 도구 활용:</strong> 운영 환경에 <strong>오픈소스 HIDS/EDR</strong> 도구를 배포하여 eBPF 관련 이벤트를 모니터링합니다. 예를 들어 <strong>Falco</strong>를 사용하면 <code>bpf()</code> 시스템콜이나 <code>perf_event_open</code> 호출을 룰(rule) 기반으로 감시해 이상 행동을 경고할 수 있고​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>, <strong>Tracee</strong>를 데몬으로 실행하면 루트킷이 커널에 훅을 거는 순간 상세 정보를 로그로 남길 수 있습니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>. 이러한 도구는 가볍게 컨테이너화하여 배포할 수도 있으므로, <strong>상시 탐지 체계</strong>로 활용합니다.</p></li><li><p><strong>정기적 무결성 검사:</strong> 크론(cron) 등을 활용해 일정 주기마다 <code>bpftool</code>을 실행하고 <strong>로드된 eBPF 프로그램 목록을 덤프</strong>하도록 스크립트를 구성합니다. 이전 출력과 **비교(diff)**하여 신규로 등장한 프로그램이나 변화가 있는지를 체크하고, 발견 시 보안 담당자에게 알림을 주도록 합니다. 특히 프로덕션 환경에서 평소 로드되지 않는 <code>kprobe</code>, <code>tracepoint</code> 유형의 프로그램 ID가 새로 생겼다면 즉시 분석이 필요합니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>. 이와 함께 <code>/sys/fs/bpf</code> 디렉토리 내용과 <code>/sys/kernel/debug/kprobes/list</code>도 정기 확인하면 은밀하게 상주하는 백도어를 걸러내는 데 도움이 됩니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Check%20if%20there%20are%20any,BPF%20filesystem">redcanary.com</a>.</p></li><li><p><strong>포렌식 대비:</strong> 고급 공격에 대비해 <strong>메모리 포렌식 절차</strong>를 마련해 둡니다. 중요 서버에는 가능하다면 <strong>하이퍼바이저 기반 스냅샷</strong>이나 원격 메모리 덤프 수단을 준비하고, 사고 발생 시 Volatility 플러그인 등을 활용해 커널 메모리를 분석함으로써 <strong>루트킷이 숨긴 흔적까지 탐지</strong>할 수 있도록 합니다​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>. 이러한 포렌식은 최후의 수단이지만, eBPF 백도어처럼 흔적을 남기지 않는 공격에 대한 <em>마지막 안전망</em>이 될 수 있습니다.</p></li><li><p><strong>업데이트 및 정보 공유:</strong> eBPF 보안은 최신 연구와 사례 공유가 활발히 이루어지는 분야입니다. 관리자들은 보안 업체의 블로그, 컨퍼런스 자료를 지속적으로 팔로업하여 **최신 IOC(Indicators of Compromise)**와 탐지 룰을 업데이트해야 합니다. 예를 들어 BPFDoor의 새로운 변종에 대응한 시그니처나, GitHub에 공개된 새로운 eBPF 루트킷 샘플 등을 빠르게 입수하여 자체적인 탐지 규칙에 반영해야 합니다.</p></li></ul><p>결론적으로, eBPF 백도어 탐지는 <strong>최신 기술 동향을 반영한 다층적 접근</strong>이 요구됩니다. 실시간 모니터링과 사후 검증, 예방적 하드닝을 조합하여 대응하고, 커뮤니티의 오픈소스 도구와 정보를 적극 활용하는 것이 중요합니다. eBPF는 향후에도 공격자에게 매력적인 도구인 만큼, 수비 측에서도 <strong>eBPF의 힘을 역이용</strong>해 커널을 감시하고 위협을 조기에 차단하는 노력이 필요합니다​<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>. 지속적인 연구 개발과 정보 공유를 통해, 보안 전문가들은 새로운 eBPF 기반 공격 기법에도 한 발 앞선 탐지 능력을 갖추어 나가야 할 것입니다​<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=come%20to%20better%20understand%20how,how%20best%20to%20detect%20it">redcanary.com</a>.</p><p><strong>참고 자료:</strong> 주요 내용은 2023~2025년에 발표된 공개 자료를 참고하였으며, Aqua Security, Sysdig, Trend Micro, Red Canary 등의 공식 블로그와 학술 연구​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=Rootkits%20based%20on%20eBPF%20programs,to%20detect%20malicious%20eBPF%20programs">scitepress.org</a>​<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>를 기반으로 정리되었습니다. 각주에 표시된 출처를 통해 세부 내용을 확인할 수 있습니다.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://windshock.github.io/ko/tags/ebpf/>EBPF</a></li><li><a href=https://windshock.github.io/ko/tags/%EB%A3%A8%ED%8A%B8%ED%82%B7-%ED%83%90%EC%A7%80/>루트킷 탐지</a></li><li><a href=https://windshock.github.io/ko/tags/bpfdoor/>BPFDoor</a></li><li><a href=https://windshock.github.io/ko/tags/%EC%BB%A4%EB%84%90-%EB%B3%B4%EC%95%88/>커널 보안</a></li><li><a href=https://windshock.github.io/ko/tags/tracee/>Tracee</a></li><li><a href=https://windshock.github.io/ko/tags/lkrg/>LKRG</a></li><li><a href=https://windshock.github.io/ko/tags/hypervisor-audit/>Hypervisor Audit</a></li><li><a href=https://windshock.github.io/ko/tags/%ED%8F%AC%EB%A0%8C%EC%8B%9D/>포렌식</a></li></ul><nav class=paginav><a class=next href=https://windshock.github.io/ko/post/2025-04-28-telecom-security-breach-analysis/><span class=title>다음 페이지 »</span><br><span>통신 보안 심층 분석 리포트: SKT 해킹 사건과 글로벌 사례 분석</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on x" href="https://x.com/intent/tweet/?text=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&amp;hashtags=eBPF%2c%eb%a3%a8%ed%8a%b8%ed%82%b7%ed%83%90%ec%a7%80%2cBPFDoor%2c%ec%bb%a4%eb%84%90%eb%b3%b4%ec%95%88%2cTracee%2cLKRG%2cHypervisorAudit%2c%ed%8f%ac%eb%a0%8c%ec%8b%9d"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&amp;title=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0&amp;summary=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0&amp;source=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&title=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on whatsapp" href="https://api.whatsapp.com/send?text=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0%20-%20https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on telegram" href="https://telegram.me/share/url?text=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share eBPF 기반 백도어 탐지 프레임워크와 최신 방법론 on ycombinator" href="https://news.ycombinator.com/submitlink?t=eBPF%20%ea%b8%b0%eb%b0%98%20%eb%b0%b1%eb%8f%84%ec%96%b4%20%ed%83%90%ec%a7%80%20%ed%94%84%eb%a0%88%ec%9e%84%ec%9b%8c%ed%81%ac%ec%99%80%20%ec%b5%9c%ec%8b%a0%20%eb%b0%a9%eb%b2%95%eb%a1%a0&u=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://windshock.github.io/ko/>Code Before Breach</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>function loadGiscus(e){document.querySelectorAll('.giscus-frame, script[src*="giscus.app"]').forEach(e=>e.remove());const t=document.createElement("script");t.src="https://giscus.app/client.js",t.setAttribute("data-repo","windshock/windshock.github.io"),t.setAttribute("data-repo-id","MDEwOlJlcG9zaXRvcnkxODQ2MDMyMTk="),t.setAttribute("data-category","General"),t.setAttribute("data-category-id","DIC_kwDOCwDSU84CoqLg"),t.setAttribute("data-mapping","pathname"),t.setAttribute("data-reactions-enabled","1"),t.setAttribute("data-theme",e),t.setAttribute("data-lang","en"),t.setAttribute("data-input-position","bottom"),t.setAttribute("data-loading","lazy"),t.crossOrigin="anonymous",t.async=!0,document.body.appendChild(t)}const currentTheme=document.body.classList.contains("dark")?"dark":"light";loadGiscus(currentTheme);const observer=new MutationObserver(()=>{const e=document.body.classList.contains("dark")?"dark":"light";loadGiscus(e)});observer.observe(document.body,{attributes:!0,attributeFilter:["class"]})</script><script>function initSwiperIfNeeded(){if(typeof Swiper=="undefined")return setTimeout(initSwiperIfNeeded,50);document.querySelector(".swiper")?(new Swiper(".swiper",{slidesPerView:1.2,spaceBetween:16,loop:!0,preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0},pagination:{el:".swiper-pagination",clickable:!0},breakpoints:{768:{slidesPerView:2.5},1024:{slidesPerView:3.2}}}),document.querySelectorAll("img.swiper-lazy").forEach(e=>{e.src=e.dataset.src})):setTimeout(initSwiperIfNeeded,100)}initSwiperIfNeeded()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="복사";function s(){t.innerHTML="복사 완료!",setTimeout(()=>{t.innerHTML="복사"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>