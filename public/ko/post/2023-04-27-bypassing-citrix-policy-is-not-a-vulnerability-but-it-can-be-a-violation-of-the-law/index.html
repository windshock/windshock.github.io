<!DOCTYPE html>
<html lang="ko" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 | Code Before Breach</title>
<meta name="keywords" content="">
<meta name="description" content="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다
주의!!
cert.org의 VINCE를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.
관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.">
<meta name="author" content="">
<link rel="canonical" href="https://windshock.github.io/ko/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://windshock.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://windshock.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://windshock.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://windshock.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://windshock.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://windshock.github.io/en/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/">
<link rel="alternate" hreflang="ko" href="https://windshock.github.io/ko/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://windshock.github.io/ko/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/">
  <meta property="og:site_name" content="Code Before Breach">
  <meta property="og:title" content="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다">
  <meta property="og:description" content="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 주의!! cert.org의 VINCE를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.
관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.">
  <meta property="og:locale" content="ko-KR">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:published_time" content="2023-04-27T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-04-27T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다">
<meta name="twitter:description" content="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다
주의!!
cert.org의 VINCE를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.
관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://windshock.github.io/ko/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "시트릭스 정책 우회는 취약점이 아니라 법률 위반이다",
      "item": "https://windshock.github.io/ko/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "시트릭스 정책 우회는 취약점이 아니라 법률 위반이다",
  "name": "시트릭스 정책 우회는 취약점이 아니라 법률 위반이다",
  "description": "시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 주의!! cert.org의 VINCE를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.\n관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.\n",
  "keywords": [
    
  ],
  "articleBody": "시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 주의!! cert.org의 VINCE를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.\n관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.\n설명 Citrix VDI 에이전트(PicaSvc2.exe)는 Citrix 관리 서버로부터 정책을 수신하고, 이를 레지스트리(HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Citrix\\1\\User)에 기록한 후, 레지스트리에서 읽어 정책을 적용하는 구조로 보입니다. 공격자는 아래의 개념 증명(POC)을 참고하여, 레지스트리 조작을 통해 Citrix 정책 서버가 강제하는 드라이브, 네트워크 접근, 클립보드 작업 등의 보안 정책을 우회할 수 있습니다.\nCitrix의 Common Criteria 인증 문서에 따르면, 이러한 구성 데이터(Configdata)가 공격자에 의해 변경되지 않도록 보호하는 메커니즘이 설계되어 있습니다. 이와 같은 우회는 구현상의 결함으로 간주될 수 있습니다.\n폐쇄되거나 격리된 네트워크 환경에서 VDI를 사용할 경우, Citrix 정책을 우회하여 VDI를 강제로 인터넷에 연결하게 되면 민감한 내부 정보가 외부로 유출될 위험이 있습니다. 특히 대한민국에서는 이러한 행위가 명백한 법 위반으로 간주되며, 네트워크 격리 대책에 대한 재검토가 필요합니다.\n개념 증명 (POC) 공격자는 우선 회사 계정에 접근한 후, 회사의 Citrix VDI(Windows 10 실행 중)에 로그인해야 합니다. VDI 환경은 일반적으로 네트워크 접근, 프린터 사용, 외부 드라이브 연결, 클립보드 접근 등이 제한되어 있습니다.\n공격자는 VDI에 로그인하여 레지스트리를 지속적으로 수정하는 배치 파일(다운로드 링크)을 실행한 후, VDI 세션에서 로그아웃합니다.\n배치 파일을 실행하여 레지스트리를 수정한 후, 공격자는 VDI에서 로그아웃합니다. 재로그인 시, 레지스트리 값이 변조되어 Citrix 정책을 우회할 수 있게 됩니다.\n예시 레지스트리 수정 내용:\nWindows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Citrix\\1\\User] \"AutoConnectDrives\"=dword:00000001 \"AllowCdromDrives\"=dword:00000001 \"AllowFixedDrives\"=dword:00000001 \"AllowFloppyDrives\"=dword:00000001 \"AllowNetworkDrives\"=dword:00000001 \"AllowRemoveableDrives\"=dword:00000001 \"UseAsyncWrites\"=dword:00000001 \"ReadOnlyMappedDrive\"=dword:00000000 VDI에 다시 로그인하면, PicaSvc2.exe가 Citrix 서버로부터 정책 설정을 가져와 레지스트리에 저장합니다.\nPicaSvc2.exe가 정책을 쓰고 읽는 동안, 이미 배치 파일에 의해 레지스트리 값이 조작되어 있습니다.\nPicaSvc2.exe는 조작된 정책을 VDI 환경에 적용합니다.\n추가 사항:\n연결 PC의 레지스트리를 수정함으로써 하드웨어 리디렉션이 활성화되어 무단 네트워크 접근이 가능해질 수 있습니다. Citrix의 기본 정책은 USB 클래스 FFh를 허용하므로, iPhone을 테더링 용도로 사용하거나 USB 기반 무선 카드를 통해 네트워크 격리를 우회할 수 있습니다. iPhone 테더링을 활성화하려면, 공격자는 iTunes 설치 프로그램에서 추출한 드라이버인 Apple 네트워크 드라이버와 Apple USB 드라이버를 설치해야 합니다. Citrix 세션에서 iPhone을 리디렉션하면, 네트워크 격리 환경에서도 인터넷 접근이 가능해집니다. 영향 VDI를 사용하여 논리적 네트워크 분리를 유지하는 기업의 경우, 이 취약점을 통해 내부 정보 유출 및 내부 서버에 대한 무단 접근이 발생할 수 있습니다.\n잠재적 영향을 고려할 때, 이러한 공격을 실시간으로 탐지하고 완화하는 것이 매우 중요합니다. 아래는 잠재적인 우회 활동을 발견하고 모니터링하는 단계입니다.\n탐지 이 문제를 탐지하기 위해:\nProcmon을 사용하여 PicaSvc2.exe의 동작을 모니터링합니다. Citrix 에이전트가 정책 설정을 저장하는 레지스트리 키를 조사합니다. 해당 레지스트리 값의 변경 효과를 조작하고 관찰합니다. 설계 분석 Citrix의 Common Criteria 인증 문서에는 구성 데이터의 무단 변경을 방지하기 위한 조치들이 포함되어 있습니다. Citrix의 Common Criteria 인증 정보에 따르면, 가상 데스크탑이나 애플리케이션의 설정과 할당에 필요한 데이터의 기밀성과 무결성이 서버 간 전송 중에도 유지됩니다. 이 설계에는 공격자, 애플리케이션 사용자 또는 데스크탑 사용자가 구성 데이터를 변경하지 못하도록 하는 예방 조치도 포함되어 있습니다.\nCitrix가 위에 언급된 보안 기능들을 구현했음에도 불구하고, 특히 대한민국과 같이 엄격한 네트워크 격리 법규가 적용되는 지역에서는 법적 고려사항도 반드시 검토되어야 합니다.\nCitrix의 보안 목표인 O.Secure_Setup_Data, OE.TLS, OE.Encryption 등은 서버 간 처리 및 전송 중에 구성 데이터의 기밀성과 무결성을 보장합니다.\n자세한 보안 목표와 관리 기능의 역할에 대해서는 다음을 참조하세요:\nFMT_SMF.1/Authorise: 엔드포인트 데이터 접근 제어 정책 관리 FMT_MSA.1/Desktop FMT_MSA.3/Desktop FMT_MSA.1/Application FMT_MSA.3/Application FPT_ITT.1 법적 고려사항 대한민국에서는 전자금융거래법에 따라 금융감독원이 논리적 네트워크 분리를 선택적으로 구현할 수 있는 조치를 도입하였습니다. 금융 기관은 민감한 데이터가 외부 공격으로부터 보호받도록 네트워크 격리 조치를 채택하여 무단 접근을 차단하고 사고를 예방해야 합니다.\n해당 공격은 관리자 권한이 필요하므로, 기업은 논리적으로 분리된 네트워크 환경에서 PC 사용자에 대한 관리자 권한 제거 정책을 재검토해야 합니다. 또한, 이러한 시스템의 오남용을 방지할 수 있는 규정을 포함하도록 법적 개선이 필요합니다.\n한계 관리자 권한 및 설치 권한이 제한되더라도, 화면 캡처 등의 방법으로 인한 데이터 유출을 완전히 방지하기는 어렵습니다. 논리적 네트워크 격리 모델에 대한 보다 자세한 분석과 해결책은 이 보고서에서 확인할 수 있습니다.\n이러한 한계는 관리자 권한이 제거된 경우에도 조직이 여전히 취약함을 시사하며, 최근 은행 부문에서 유사 사건에 대응하는 사례에서도 보듯이, 기술적 및 규제적 차원에서 이러한 문제들을 해결하는 것이 중요함을 강조합니다.\n관련 이슈 2011년 농협 해킹 사건 이후, 대한민국의 여러 주요 은행은 개인 정보의 유출, 절도 또는 변조를 방지하기 위해 내부-외부 네트워크 분리를 시행하기 시작했습니다. 네트워크 격리는 개인 데이터의 안전을 보장하기 위한 핵심 권고사항으로 남아 있습니다. 관련 지침은 여기에서, ISMS-P 인증 관련 정보는 여기에서 확인할 수 있습니다.\n추가로 Citrix Common Criteria 인증에 관한 정보는 여기와 여기에서 확인할 수 있습니다.\n",
  "wordCount" : "727",
  "inLanguage": "ko",
  "datePublished": "2023-04-27T00:00:00Z",
  "dateModified": "2023-04-27T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://windshock.github.io/ko/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Code Before Breach",
    "logo": {
      "@type": "ImageObject",
      "url": "https://windshock.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://windshock.github.io/ko/" accesskey="h" title="Code Before Breach (Alt + H)">Code Before Breach</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://windshock.github.io/en/" title="English"
                            aria-label="English">En</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://windshock.github.io/ko/search/" title="검색 (Alt &#43; /)" accesskey=/>
                    <span>검색</span>
                </a>
            </li>
            <li>
                <a href="https://windshock.github.io/ko/tags/" title="태그">
                    <span>태그</span>
                </a>
            </li>
            <li>
                <a href="https://windshock.github.io/ko/categories/" title="카테고리">
                    <span>카테고리</span>
                </a>
            </li>
            <li>
                <a href="https://windshock.github.io/ko/archives/" title="아카이브">
                    <span>아카이브</span>
                </a>
            </li>
            <li>
                <a href="https://windshock.github.io/ko/about/" title="소개">
                    <span>소개</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://windshock.github.io/ko/">홈</a>&nbsp;»&nbsp;<a href="https://windshock.github.io/ko/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      시트릭스 정책 우회는 취약점이 아니라 법률 위반이다
    </h1>
    <div class="post-meta"><span title='2023-04-27 00:00:00 +0000 UTC'>4월 27, 2023</span>&nbsp;·&nbsp;4 분&nbsp;·&nbsp;727 단어&nbsp;|&nbsp;번역:
<ul class="i18n_list">
    <li>
        <a href="https://windshock.github.io/en/post/2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law/">En</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">목차</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4-%ec%a0%95%ec%b1%85-%ec%9a%b0%ed%9a%8c%eb%8a%94-%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4-%ec%95%84%eb%8b%88%eb%9d%bc-%eb%b2%95%eb%a5%a0-%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4" aria-label="시트릭스 정책 우회는 취약점이 아니라 법률 위반이다">시트릭스 정책 우회는 취약점이 아니라 법률 위반이다</a><ul>
                        
                <li>
                    <a href="#%ec%a3%bc%ec%9d%98" aria-label="주의!!">주의!!</a></li>
                <li>
                    <a href="#%ec%84%a4%eb%aa%85" aria-label="설명">설명</a></li>
                <li>
                    <a href="#%ea%b0%9c%eb%85%90-%ec%a6%9d%eb%aa%85-poc" aria-label="개념 증명 (POC)">개념 증명 (POC)</a></li>
                <li>
                    <a href="#%ec%98%81%ed%96%a5" aria-label="영향">영향</a></li>
                <li>
                    <a href="#%ed%83%90%ec%a7%80" aria-label="탐지">탐지</a></li>
                <li>
                    <a href="#%ec%84%a4%ea%b3%84-%eb%b6%84%ec%84%9d" aria-label="설계 분석">설계 분석</a></li>
                <li>
                    <a href="#%eb%b2%95%ec%a0%81-%ea%b3%a0%eb%a0%a4%ec%82%ac%ed%95%ad" aria-label="법적 고려사항">법적 고려사항</a></li>
                <li>
                    <a href="#%ed%95%9c%ea%b3%84" aria-label="한계">한계</a></li>
                <li>
                    <a href="#%ea%b4%80%eb%a0%a8-%ec%9d%b4%ec%8a%88" aria-label="관련 이슈">관련 이슈</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h3 id="시트릭스-정책-우회는-취약점이-아니라-법률-위반이다">시트릭스 정책 우회는 취약점이 아니라 법률 위반이다<a hidden class="anchor" aria-hidden="true" href="#시트릭스-정책-우회는-취약점이-아니라-법률-위반이다">#</a></h3>
<h4 id="주의">주의!!<a hidden class="anchor" aria-hidden="true" href="#주의">#</a></h4>
<p>cert.org의 <a href="https://kb.cert.org/vince/comm/case/1022/">VINCE</a>를 통한 Citrix와의 논의를 바탕으로, 이 문제는 관리 권한이 필요하기 때문에 취약점으로 분류되지 않는 것으로 결론지어졌습니다. 따라서 보안상의 문제 없이 이 정보를 공유할 수 있습니다. 그러나 보안상의 이유로, 논리적으로 격리되거나 폐쇄된 네트워크와 같은 특수 환경에서는 Xendesktop (VDI)의 사용을 권장하지 않습니다. 만약 VDI를 반드시 사용해야 한다면, 관리자 권한을 제거하고 보안 전용 소프트웨어를 설치해야 합니다.</p>
<p><strong>관리자 권한이 필요하다는 점은 위험을 낮출 수 있지만, 잠재적인 영향력을 완전히 제거하지는 않습니다. 아래는 Citrix 정책이 어떻게 우회될 수 있는지에 대한 상세한 기술 설명입니다.</strong></p>
<h4 id="설명">설명<a hidden class="anchor" aria-hidden="true" href="#설명">#</a></h4>
<p>Citrix VDI 에이전트(PicaSvc2.exe)는 Citrix 관리 서버로부터 정책을 수신하고, 이를 레지스트리(<code>HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Citrix\1\User</code>)에 기록한 후, 레지스트리에서 읽어 정책을 적용하는 구조로 보입니다. 공격자는 아래의 개념 증명(POC)을 참고하여, 레지스트리 조작을 통해 Citrix 정책 서버가 강제하는 드라이브, 네트워크 접근, 클립보드 작업 등의 보안 정책을 우회할 수 있습니다.</p>
<p>Citrix의 <a href="http://www.citrix.com/about/legal/security-compliance/common-criteria.html">Common Criteria 인증 문서</a>에 따르면, 이러한 구성 데이터(Configdata)가 공격자에 의해 변경되지 않도록 보호하는 메커니즘이 설계되어 있습니다. 이와 같은 우회는 구현상의 결함으로 간주될 수 있습니다.</p>
<p><strong>폐쇄되거나 격리된 네트워크 환경에서 VDI를 사용할 경우, Citrix 정책을 우회하여 VDI를 강제로 인터넷에 연결하게 되면 민감한 내부 정보가 외부로 유출될 위험이 있습니다. 특히 대한민국에서는 이러한 행위가 명백한 법 위반으로 간주되며, 네트워크 격리 대책에 대한 재검토가 필요합니다.</strong></p>
<h4 id="개념-증명-poc">개념 증명 (POC)<a hidden class="anchor" aria-hidden="true" href="#개념-증명-poc">#</a></h4>
<p>공격자는 우선 회사 계정에 접근한 후, 회사의 Citrix VDI(Windows 10 실행 중)에 로그인해야 합니다. VDI 환경은 일반적으로 네트워크 접근, 프린터 사용, 외부 드라이브 연결, 클립보드 접근 등이 제한되어 있습니다.</p>
<ol>
<li>
<p>공격자는 VDI에 로그인하여 레지스트리를 지속적으로 수정하는 배치 파일(<a href="/bypass.zip">다운로드 링크</a>)을 실행한 후, VDI 세션에서 로그아웃합니다.</p>
<p><strong>배치 파일을 실행하여 레지스트리를 수정한 후, 공격자는 VDI에서 로그아웃합니다. 재로그인 시, 레지스트리 값이 변조되어 Citrix 정책을 우회할 수 있게 됩니다.</strong></p>
<p>예시 레지스트리 수정 내용:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>Windows Registry Editor Version 5.00
</span></span><span style="display:flex;"><span>[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Citrix\1\User]
</span></span><span style="display:flex;"><span>&#34;AutoConnectDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;AllowCdromDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;AllowFixedDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;AllowFloppyDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;AllowNetworkDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;AllowRemoveableDrives&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;UseAsyncWrites&#34;=dword:00000001
</span></span><span style="display:flex;"><span>&#34;ReadOnlyMappedDrive&#34;=dword:00000000
</span></span></code></pre></div></li>
<li>
<p>VDI에 다시 로그인하면, <code>PicaSvc2.exe</code>가 Citrix 서버로부터 정책 설정을 가져와 레지스트리에 저장합니다.</p>
</li>
<li>
<p><code>PicaSvc2.exe</code>가 정책을 쓰고 읽는 동안, 이미 배치 파일에 의해 레지스트리 값이 조작되어 있습니다.</p>
</li>
<li>
<p><code>PicaSvc2.exe</code>는 조작된 정책을 VDI 환경에 적용합니다.</p>
</li>
</ol>
<p>추가 사항:</p>
<ul>
<li>연결 PC의 레지스트리를 수정함으로써 하드웨어 리디렉션이 활성화되어 무단 네트워크 접근이 가능해질 수 있습니다.</li>
<li>Citrix의 기본 정책은 <a href="https://www.usb.org/defined-class-codes#anchor_BaseClassFFh">USB 클래스 FFh</a>를 허용하므로, iPhone을 테더링 용도로 사용하거나 USB 기반 무선 카드를 통해 네트워크 격리를 우회할 수 있습니다.</li>
<li>iPhone 테더링을 활성화하려면, 공격자는 iTunes 설치 프로그램에서 추출한 드라이버인 <a href="/applenetworkdriver.zip">Apple 네트워크 드라이버</a>와 <a href="/appleusbdriver.zip">Apple USB 드라이버</a>를 설치해야 합니다.</li>
<li>Citrix 세션에서 iPhone을 리디렉션하면, 네트워크 격리 환경에서도 인터넷 접근이 가능해집니다.</li>
</ul>
<h4 id="영향">영향<a hidden class="anchor" aria-hidden="true" href="#영향">#</a></h4>
<p>VDI를 사용하여 논리적 네트워크 분리를 유지하는 기업의 경우, 이 취약점을 통해 내부 정보 유출 및 내부 서버에 대한 무단 접근이 발생할 수 있습니다.</p>
<p><strong>잠재적 영향을 고려할 때, 이러한 공격을 실시간으로 탐지하고 완화하는 것이 매우 중요합니다. 아래는 잠재적인 우회 활동을 발견하고 모니터링하는 단계입니다.</strong></p>
<h4 id="탐지">탐지<a hidden class="anchor" aria-hidden="true" href="#탐지">#</a></h4>
<p>이 문제를 탐지하기 위해:</p>
<ol>
<li><a href="https://learn.microsoft.com/en-us/sysinternals/downloads/procmon">Procmon</a>을 사용하여 <code>PicaSvc2.exe</code>의 동작을 모니터링합니다.</li>
<li>Citrix 에이전트가 정책 설정을 저장하는 레지스트리 키를 조사합니다.</li>
<li>해당 레지스트리 값의 변경 효과를 조작하고 관찰합니다.</li>
</ol>
<h4 id="설계-분석">설계 분석<a hidden class="anchor" aria-hidden="true" href="#설계-분석">#</a></h4>
<p>Citrix의 Common Criteria 인증 문서에는 구성 데이터의 무단 변경을 방지하기 위한 조치들이 포함되어 있습니다. Citrix의 <a href="https://www.citrix.com/about/legal/security-compliance/common-criteria.html">Common Criteria 인증 정보</a>에 따르면, 가상 데스크탑이나 애플리케이션의 설정과 할당에 필요한 데이터의 기밀성과 무결성이 서버 간 전송 중에도 유지됩니다. 이 설계에는 공격자, 애플리케이션 사용자 또는 데스크탑 사용자가 구성 데이터를 변경하지 못하도록 하는 예방 조치도 포함되어 있습니다.</p>
<p><strong>Citrix가 위에 언급된 보안 기능들을 구현했음에도 불구하고, 특히 대한민국과 같이 엄격한 네트워크 격리 법규가 적용되는 지역에서는 법적 고려사항도 반드시 검토되어야 합니다.</strong></p>
<p>Citrix의 보안 목표인 <code>O.Secure_Setup_Data</code>, <code>OE.TLS</code>, <code>OE.Encryption</code> 등은 서버 간 처리 및 전송 중에 구성 데이터의 기밀성과 무결성을 보장합니다.</p>
<p>자세한 보안 목표와 관리 기능의 역할에 대해서는 다음을 참조하세요:</p>
<ul>
<li>FMT_SMF.1/Authorise: 엔드포인트 데이터 접근 제어 정책 관리</li>
<li>FMT_MSA.1/Desktop</li>
<li>FMT_MSA.3/Desktop</li>
<li>FMT_MSA.1/Application</li>
<li>FMT_MSA.3/Application</li>
<li>FPT_ITT.1</li>
</ul>
<h4 id="법적-고려사항">법적 고려사항<a hidden class="anchor" aria-hidden="true" href="#법적-고려사항">#</a></h4>
<p>대한민국에서는 전자금융거래법에 따라 금융감독원이 논리적 네트워크 분리를 선택적으로 구현할 수 있는 조치를 도입하였습니다. 금융 기관은 민감한 데이터가 외부 공격으로부터 보호받도록 네트워크 격리 조치를 채택하여 무단 접근을 차단하고 사고를 예방해야 합니다.</p>
<p><strong>해당 공격은 관리자 권한이 필요하므로, 기업은 논리적으로 분리된 네트워크 환경에서 PC 사용자에 대한 관리자 권한 제거 정책을 재검토해야 합니다. 또한, 이러한 시스템의 오남용을 방지할 수 있는 규정을 포함하도록 법적 개선이 필요합니다.</strong></p>
<h4 id="한계">한계<a hidden class="anchor" aria-hidden="true" href="#한계">#</a></h4>
<p>관리자 권한 및 설치 권한이 제한되더라도, 화면 캡처 등의 방법으로 인한 데이터 유출을 완전히 방지하기는 어렵습니다. 논리적 네트워크 격리 모델에 대한 보다 자세한 분석과 해결책은 <a href="https://koreascience.kr/article/JAKO202031064817799.pdf">이 보고서</a>에서 확인할 수 있습니다.</p>
<p><strong>이러한 한계는 관리자 권한이 제거된 경우에도 조직이 여전히 취약함을 시사하며, 최근 은행 부문에서 유사 사건에 대응하는 사례에서도 보듯이, 기술적 및 규제적 차원에서 이러한 문제들을 해결하는 것이 중요함을 강조합니다.</strong></p>
<hr>
<h4 id="관련-이슈">관련 이슈<a hidden class="anchor" aria-hidden="true" href="#관련-이슈">#</a></h4>
<p>2011년 농협 해킹 사건 이후, 대한민국의 여러 주요 은행은 개인 정보의 유출, 절도 또는 변조를 방지하기 위해 내부-외부 네트워크 분리를 시행하기 시작했습니다. 네트워크 격리는 개인 데이터의 안전을 보장하기 위한 핵심 권고사항으로 남아 있습니다. 관련 지침은 <a href="https://blogger.pe.kr/618">여기</a>에서, ISMS-P 인증 관련 정보는 <a href="https://itwiki.kr/w/ISMS-P_%EC%9D%B8%EC%A6%9D_%EA%B8%B0%EC%A4%80_2.6.7.%EC%9D%B8%ED%84%B0%EB%84%B7_%EC%A0%91%EC%86%8D_%ED%86%B5%EC%A0%9C">여기</a>에서 확인할 수 있습니다.</p>
<p>추가로 Citrix Common Criteria 인증에 관한 정보는 <a href="http://www.bikorea.net/news/articleView.html?idxno=11295">여기</a>와 <a href="http://www.citrix.com/about/legal/security-compliance/common-criteria.html">여기</a>에서 확인할 수 있습니다.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://windshock.github.io/ko/post/2024-05-22-can-development-culture-influence-security-levels/">
    <span class="title">« 이전 페이지</span>
    <br>
    <span>개발문화가 보안수준에 영향을 미칠 수 있을까?</span>
  </a>
  <a class="next" href="https://windshock.github.io/ko/post/2023-04-18-strengthening-cybersecurity-through-government-ngos-and-bug-bounty-programs/">
    <span class="title">다음 페이지 »</span>
    <br>
    <span>정부 NGO 및 버그 바운티 프로그램을 통한 사이버 보안 강화</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on x"
            href="https://x.com/intent/tweet/?text=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f&amp;hashtags=">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f&amp;title=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4&amp;summary=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4&amp;source=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f&title=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on whatsapp"
            href="https://api.whatsapp.com/send?text=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4%20-%20https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on telegram"
            href="https://telegram.me/share/url?text=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4&amp;url=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 시트릭스 정책 우회는 취약점이 아니라 법률 위반이다 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%ec%8b%9c%ed%8a%b8%eb%a6%ad%ec%8a%a4%20%ec%a0%95%ec%b1%85%20%ec%9a%b0%ed%9a%8c%eb%8a%94%20%ec%b7%a8%ec%95%bd%ec%a0%90%ec%9d%b4%20%ec%95%84%eb%8b%88%eb%9d%bc%20%eb%b2%95%eb%a5%a0%20%ec%9c%84%eb%b0%98%ec%9d%b4%eb%8b%a4&u=https%3a%2f%2fwindshock.github.io%2fko%2fpost%2f2023-04-27-bypassing-citrix-policy-is-not-a-vulnerability-but-it-can-be-a-violation-of-the-law%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://windshock.github.io/ko/">Code Before Breach</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
  function getCurrentTheme() {
    return document.body.classList.contains("dark") ? "dark" : "light";
  }

  
  function sendGiscusTheme() {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;

    try {
      iframe.contentWindow.postMessage({
        giscus: {
          setConfig: {
            theme: getCurrentTheme(),
          }
        }
      }, '*');
    } catch (e) {
      console.warn('[Giscus] 테마 적용 실패:', e);
    }
  }

  
  const maxAttempts = 20;
  let attempt = 0;
  const interval = setInterval(() => {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (iframe && iframe.contentWindow) {
      sendGiscusTheme();
      clearInterval(interval);
    }

    attempt++;
    if (attempt > maxAttempts) {
      clearInterval(interval);
      console.warn('[Giscus] iframe 로드를 감지하지 못했습니다.');
    }
  }, 500);
  
  const observer = new MutationObserver(() => {
    sendGiscusTheme();
  });

  observer.observe(document.documentElement, {
    attributes: true,
    attributeFilter: ['class'],
  });

</script>

  <script src="https://giscus.app/client.js"
    data-repo="windshock/windshock.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkxODQ2MDMyMTk="
    data-category="General"
    data-category-id="DIC_kwDOCwDSU84CoqLg"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-theme="light"
    data-lang="en"
    data-input-position="bottom"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '복사';

        function copyingDone() {
            copybutton.innerHTML = '복사 완료!';
            setTimeout(() => {
                copybutton.innerHTML = '복사';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
