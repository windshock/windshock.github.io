<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors | Code Before Breach</title>
<meta name="keywords" content="eBPF, Rootkit Detection, BPFDoor, Kernel Security, Tracee, LKRG, Hypervisor Audit, Forensics">
<meta name="description" content="This article analyzes the rise of backdoors and rootkits exploiting eBPF, the detection challenges they pose, and comprehensively summarizes the latest countermeasures and research trends (2023â€“2025), including Tracee, LKRG, bpftool, and hypervisor-based auditing.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/en/post/2025-04-29-ebpf-backdoor-detection-framework/">
<link href="https://fonts.googleapis.com/css2?family=Spectral:wght@400;700&display=swap" rel="stylesheet">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/en/post/2025-04-29-ebpf-backdoor-detection-framework/">
<link rel="alternate" hreflang="ko" href="http://localhost:1313/ko/post/2025-04-29-ebpf-backdoor-detection-framework/">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script defer src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/en/" accesskey="h" title="Code Before Breach (Alt + H)">
                <img src="http://localhost:1313/images/logo-terminal-animated.svg" alt="" aria-label="logo" class="h-7 w-auto"
                    height="28">Code Before Breach</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/ko/" title="í•œêµ­ì–´"
                            aria-label="í•œêµ­ì–´">Ko</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/en/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/about/" title="About">
                    <span>About</span>
                </a>
            </li>
        </ul>
    </nav>
</header>



<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/en/">Home</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/en/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors
    </h1>
    <div class="post-meta"><span title='2025-04-28 00:00:00 +0000 UTC'>April 28, 2025</span>&nbsp;Â·&nbsp;14 min&nbsp;Â·&nbsp;2960 words&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="http://localhost:1313/ko/post/2025-04-29-ebpf-backdoor-detection-framework/">Ko</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#overview-the-rise-of-ebpf-backdoors-and-detection-challenges" aria-label="Overview: The Rise of eBPF Backdoors and Detection Challenges">Overview: The Rise of eBPF Backdoors and Detection Challenges</a></li>
                <li>
                    <a href="#detection-challenges-of-ebpf-backdoors" aria-label="Detection Challenges of eBPF Backdoors">Detection Challenges of eBPF Backdoors</a></li>
                <li>
                    <a href="#why-linux-anti-virus-cannot-cover-ebpf-backdoors" aria-label="Why Linux Anti-Virus Cannot Cover eBPF Backdoors">Why Linux Anti-Virus Cannot Cover eBPF Backdoors</a><ul>
                        
                <li>
                    <a href="#key-reasons" aria-label="Key Reasons">Key Reasons</a></li>
                <li>
                    <a href="#practical-summary" aria-label="Practical Summary">Practical Summary</a></li></ul>
                </li>
                <li>
                    <a href="#tracee-vs-lkrg-their-complementary-roles" aria-label="Tracee vs LKRG: Their Complementary Roles">Tracee vs LKRG: Their Complementary Roles</a><ul>
                        
                <li>
                    <a href="#summary" aria-label="Summary">Summary</a></li></ul>
                </li>
                <li>
                    <a href="#simple-script-for-detecting-bpfdoor-like-behavior" aria-label="Simple Script for Detecting BPFDoor-like Behavior: bpfdoor_detector.sh">Simple Script for Detecting BPFDoor-like Behavior: bpfdoor_detector.sh</a><ul>
                        
                <li>
                    <a href="#script-features" aria-label="Script Features">Script Features</a></li>
                <li>
                    <a href="#usage" aria-label="Usage">Usage</a></li>
                <li>
                    <a href="#full-script-code" aria-label="Full Script Code">Full Script Code</a></li>
                <li>
                    <a href="#cautions" aria-label="Cautions">Cautions</a></li></ul>
                </li>
                <li>
                    <a href="#checking-for-ebpf-backdoors-in-openstack-environments" aria-label="Checking for eBPF Backdoors in OpenStack Environments">Checking for eBPF Backdoors in OpenStack Environments</a><ul>
                        
                <li>
                    <a href="#usage-1" aria-label="Usage">Usage</a></li>
                <li>
                    <a href="#inspection-script-using-bpftoolscan_" aria-label="Inspection Script Using bpftool(scan_bpf.sh)">Inspection Script Using bpftool(scan_bpf.sh)</a></li>
                <li>
                    <a href="#script-explanation" aria-label="Script Explanation">Script Explanation</a></li></ul>
                </li>
                <li>
                    <a href="#dealing-with-ebpf-backdoors-in-vsphere--vmware-nsx-environments" aria-label="Dealing with eBPF Backdoors in vSphere &#43; VMware NSX Environments">Dealing with eBPF Backdoors in vSphere + VMware NSX Environments</a><ul>
                        
                <li>
                    <a href="#possible-detection-strategies" aria-label="Possible Detection Strategies">Possible Detection Strategies</a></li>
                <li>
                    <a href="#cautions-1" aria-label="Cautions">Cautions</a></li></ul>
                </li>
                <li>
                    <a href="#publicly-available-ebpf-backdoor-detection-frameworks-and-tools" aria-label="Publicly Available eBPF Backdoor Detection Frameworks and Tools">Publicly Available eBPF Backdoor Detection Frameworks and Tools</a></li>
                <li>
                    <a href="#latest-detection-methodologies-20232025-and-research-trends" aria-label="Latest Detection Methodologies (2023â€“2025) and Research Trends">Latest Detection Methodologies (2023â€“2025) and Research Trends</a><ul>
                        
                <li>
                    <a href="#1-real-time-load-monitoring" aria-label="1. Real-Time Load Monitoring">1. Real-Time Load Monitoring</a></li>
                <li>
                    <a href="#2-kernel-integrity-checking-and-hardening" aria-label="2. Kernel Integrity Checking and Hardening">2. Kernel Integrity Checking and Hardening</a></li>
                <li>
                    <a href="#3-hypervisor-based-auditing" aria-label="3. Hypervisor-Based Auditing">3. Hypervisor-Based Auditing</a></li>
                <li>
                    <a href="#4-post-incident-inspection-and-hunting" aria-label="4. Post-Incident Inspection and Hunting">4. Post-Incident Inspection and Hunting</a></li></ul>
                </li>
                <li>
                    <a href="#real-world-case-studies-detecting-and-responding-to-ebpf-backdoors" aria-label="Real-World Case Studies: Detecting and Responding to eBPF Backdoors">Real-World Case Studies: Detecting and Responding to eBPF Backdoors</a></li>
                <li>
                    <a href="#response-strategies-and-practical-recommendations" aria-label="Response Strategies and Practical Recommendations">Response Strategies and Practical Recommendations</a><ul>
                        
                <li>
                    <a href="#1-privilege-management-and-hardening" aria-label="1. Privilege Management and Hardening">1. Privilege Management and Hardening</a></li>
                <li>
                    <a href="#2-deploy-real-time-monitoring-tools" aria-label="2. Deploy Real-Time Monitoring Tools">2. Deploy Real-Time Monitoring Tools</a></li>
                <li>
                    <a href="#3-conduct-regular-integrity-checks" aria-label="3. Conduct Regular Integrity Checks">3. Conduct Regular Integrity Checks</a></li>
                <li>
                    <a href="#4-prepare-forensic-capabilities" aria-label="4. Prepare Forensic Capabilities">4. Prepare Forensic Capabilities</a></li>
                <li>
                    <a href="#5-continuously-update-and-share-intelligence" aria-label="5. Continuously Update and Share Intelligence">5. Continuously Update and Share Intelligence</a></li></ul>
                </li>
                <li>
                    <a href="#-additional-note-kernel-integrity-validation-must-be-strengthened-in-national-security-requirements" aria-label="ðŸ“Œ Additional Note: Kernel Integrity Validation Must Be Strengthened in National Security Requirements">ðŸ“Œ Additional Note: Kernel Integrity Validation Must Be Strengthened in National Security Requirements</a><ul>
                        
                <li>
                    <a href="#related-materials" aria-label="Related Materials">Related Materials</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><img alt="ebpf hook overview" loading="lazy" src="https://ebpf.io/static/99c69bbff092c35b9c83f00a80fed240/fb370/hook-overview.webp"></p>
<h2 id="overview-the-rise-of-ebpf-backdoors-and-detection-challenges"><strong>Overview: The Rise of eBPF Backdoors and Detection Challenges</strong><a hidden class="anchor" aria-hidden="true" href="#overview-the-rise-of-ebpf-backdoors-and-detection-challenges">#</a></h2>
<p>eBPF (extended BPF) is a powerful technology that allows dynamic injection of programs into the Linux kernel, originally intended for legitimate use cases such as <strong>performance monitoring and security enforcement</strong>â€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=eBPF%20has%20gained%20a%20lot,specified%29%20kernel%20events%20occur">sysdig.com</a>)â€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=In%20fact%2C%20in%20the%20many,and%20also%20enforce%20security%20policies">sysdig.com</a>). However, in recent years, attackers have increasingly <strong>abused eBPF to develop backdoors and rootkits</strong>, making eBPF a <em>double-edged sword</em> in the security landscapeâ€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=protect%20organizations,malicious%20usage%20of%20the%20eBPF">aquasec.com</a>).<br>
Since 2023, several rootkits (<code>ebpfkit</code>, <code>TripleCross</code>) and malware (<code>Pamspy</code>) utilizing eBPF have emerged, enabling <strong>malicious activities</strong> such as credential theft and firewall evasionâ€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=protect%20organizations,malicious%20usage%20of%20the%20eBPF">aquasec.com</a>).<br>
Because eBPF-based backdoors operate at the kernel level, they are <strong>extremely difficult to detect</strong> and are often missed by traditional security toolsâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>)â€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>).<br>
In this article, we comprehensively summarize open detection frameworks, tools, the latest research trends, challenges, strategies, case studies, and practical utilities for dealing with eBPF-based backdoors.</p>
<h2 id="detection-challenges-of-ebpf-backdoors"><strong>Detection Challenges of eBPF Backdoors</strong><a hidden class="anchor" aria-hidden="true" href="#detection-challenges-of-ebpf-backdoors">#</a></h2>
<p><strong>eBPF backdoors are extremely difficult to detect using traditional rootkit detection methods.</strong><br>
Unlike conventional kernel modules, eBPF programs do not appear as separate modules; instead, they execute inside the kernelâ€™s BPF virtual machine, making them <strong>inherently stealthy</strong>.<br>
For example, the <code>BPFDoor</code> backdoor used in APT attacks inserted packet filters into the kernel to <strong>bypass firewall rules</strong> while masquerading as if no network ports were openâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>).<br>
Once an eBPF rootkit is installed, it can even <strong>manipulate the outputs of system diagnostic tools</strong> to hide its presenceâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>).<br>
According to Red Canaryâ€™s analysis, once loaded, eBPF malware can stealthily alter results from tools like <code>bpftool</code> and <code>debugfs</code>, making post-compromise detection extremely difficultâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>).<br>
Thus, if detection <strong>fails at the loading stage</strong>, identifying the backdoor afterward becomes extremely challengingâ€”this is the <strong>core difficulty</strong> in detecting eBPF backdoorsâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Detection">redcanary.com</a>).</p>
<p>To overcome these challenges, a strategy combining <strong>real-time monitoring</strong> and <strong>post-incident forensic techniques</strong> is essential.<br>
For example, <strong>kernel-level monitoring tools</strong> that intercept eBPF program loading events can detect malicious eBPF activity <strong>at its inception</strong>â€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>).<br>
Conversely, if a rootkit is already active, <strong>hypervisor-based</strong> or <strong>memory forensic approaches</strong> must be employed to examine kernel memory externallyâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>).<br>
Below, we will explore these <strong>real-time detection frameworks</strong> and <strong>research-driven methodologies</strong>, analyzing their characteristics and limitations in detail.</p>
<h2 id="why-linux-anti-virus-cannot-cover-ebpf-backdoors"><strong>Why Linux Anti-Virus Cannot Cover eBPF Backdoors</strong><a hidden class="anchor" aria-hidden="true" href="#why-linux-anti-virus-cannot-cover-ebpf-backdoors">#</a></h2>
<p><strong>Conclusion:</strong><br>
General-purpose Linux anti-virus solutions cannot detect or block eBPF-based backdoors.</p>
<h3 id="key-reasons"><strong>Key Reasons</strong><a hidden class="anchor" aria-hidden="true" href="#key-reasons">#</a></h3>
<ul>
<li>
<p><strong>eBPF backdoors are not file-based:</strong><br>
Traditional Linux anti-virus tools are optimized for scanning malicious files in the file system.<br>
However, eBPF programs are loaded into the kernelâ€™s BPF subsystem and are executed upon specific events, meaning they do <strong>not exist directly</strong> in the file system.</p>
</li>
<li>
<p><strong>Inability to monitor internal kernel activities:</strong><br>
Conventional Linux AV solutions primarily monitor user-space processes and disk I/O activities.<br>
eBPF programs operate within kernel space, far beyond the reach of traditional AV monitoring.</p>
</li>
<li>
<p><strong>Potential for information manipulation:</strong><br>
eBPF rootkits can tamper with system calls, process lists, and file lists.<br>
Therefore, the data seen by the AV scanner itself may already be <strong>forged</strong>.</p>
</li>
<li>
<p><strong>Inability to detect BPF-level hooks:</strong><br>
Traditional anti-virus scanners cannot capture kernel-level activities like system call table hooking, kprobe/uprobes attachment, or eBPF event interception.</p>
</li>
</ul>
<h3 id="practical-summary"><strong>Practical Summary</strong><a hidden class="anchor" aria-hidden="true" href="#practical-summary">#</a></h3>
<ul>
<li><strong>File-based malware</strong> (e.g., web shells, trojans): <strong>Detectable</strong></li>
<li><strong>Kernel-space eBPF backdoors</strong>: <strong>Not detectable</strong></li>
<li><strong>Kernel module-based rootkits</strong>: <strong>Not detectable</strong></li>
</ul>
<blockquote>
<p>&ldquo;Linux antivirus solutions fundamentally cannot detect eBPF backdoors.<br>
Without kernel-level integrity protection, no output can be trusted.&rdquo;</p></blockquote>
<p><strong>Therefore, the use of kernel integrity protection modules like LKRG (Linux Kernel Runtime Guard) is strongly recommended.</strong></p>
<h2 id="tracee-vs-lkrg-their-complementary-roles"><strong>Tracee vs LKRG: Their Complementary Roles</strong><a hidden class="anchor" aria-hidden="true" href="#tracee-vs-lkrg-their-complementary-roles">#</a></h2>
<p>When addressing eBPF backdoors and kernel rootkits, Tracee and LKRG complement each other at different layers.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Aspect</th>
          <th style="text-align: left">Tracee</th>
          <th style="text-align: left">LKRG</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>What is monitored?</strong></td>
          <td style="text-align: left">Kernel events (e.g., bpf calls, execve, open)</td>
          <td style="text-align: left">Kernel object integrity (e.g., syscall table, credentials)</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>When is monitoring performed?</strong></td>
          <td style="text-align: left">Detection upon the occurrence of <strong>attack events</strong></td>
          <td style="text-align: left">Detection upon <strong>attempts to tamper</strong> with kernel structures</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Detection focus</strong></td>
          <td style="text-align: left">System call level</td>
          <td style="text-align: left">Kernel memory structure level</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Primary goal</strong></td>
          <td style="text-align: left">Threat hunting (detect anomalies)</td>
          <td style="text-align: left">Integrity enforcement and protection</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Operation method</strong></td>
          <td style="text-align: left">Passive event logging and alerting</td>
          <td style="text-align: left">Active prevention or alerting on integrity violations</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Nature</strong></td>
          <td style="text-align: left">Incident response-oriented</td>
          <td style="text-align: left">Incident prevention-oriented</td>
      </tr>
  </tbody>
</table>
<h3 id="summary"><strong>Summary</strong><a hidden class="anchor" aria-hidden="true" href="#summary">#</a></h3>
<ul>
<li><strong>Tracee</strong> acts as a <strong>security camera</strong>, recording anomalous activities after they happen.</li>
<li><strong>LKRG</strong> serves as <strong>security bars</strong>, actively monitoring kernel structures and preventing tampering.</li>
</ul>
<blockquote>
<p>&ldquo;Using only Tracee records incidents but cannot block them.<br>
Using only LKRG blocks tampering but leaves no forensic trail.<br>
<strong>Using both together provides the strongest protection, combining detection and prevention.</strong>&rdquo;</p></blockquote>
<h2 id="simple-script-for-detecting-bpfdoor-like-behavior"><strong>Simple Script for Detecting BPFDoor-like Behavior: <code>bpfdoor_detector.sh</code></strong><a hidden class="anchor" aria-hidden="true" href="#simple-script-for-detecting-bpfdoor-like-behavior">#</a></h2>
<p>This is a lightweight script designed to detect processes exhibiting behaviors similar to the <strong>BPFDoor</strong> eBPF backdoor.</p>
<h3 id="script-features"><strong>Script Features</strong><a hidden class="anchor" aria-hidden="true" href="#script-features">#</a></h3>
<ul>
<li>Detects processes running with <strong>deleted executables</strong> (<code>(deleted)</code> state).</li>
<li>Filters processes that are using <strong>BPF sockets</strong>.</li>
<li><strong>Excludes</strong> legitimate programs that use BPF, such as <code>tcpdump</code>, <code>wireshark</code>, and <code>dhclient</code>.</li>
<li>Displays <strong>basic network connection information</strong> for suspicious processes.</li>
</ul>
<h3 id="usage"><strong>Usage</strong><a hidden class="anchor" aria-hidden="true" href="#usage">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ./bpfdoor_detector.sh
</span></span></code></pre></div><ul>
<li>Must be run with <strong>root privileges</strong>.</li>
<li>Required commands: <code>ps</code>, <code>grep</code>, <code>readlink</code>, <code>ss</code></li>
</ul>
<h3 id="full-script-code"><strong>Full Script Code</strong><a hidden class="anchor" aria-hidden="true" href="#full-script-code">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># BPFDoor-like Suspicious Process Detector</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check for root permission</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>id -u<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> -ne <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;[!] This script must be run as root.&#34;</span>
</span></span><span style="display:flex;"><span>  exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check required commands</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> cmd in ps grep readlink ss; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ! command -v $cmd &amp;&gt;/dev/null; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#e6db74">&#34;[!] </span>$cmd<span style="color:#e6db74"> command is required. Please install it first.&#34;</span>
</span></span><span style="display:flex;"><span>    exit <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Starting focused BPFDoor-like process detection...&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>found<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Iterate over all PIDs</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> pid in <span style="color:#66d9ef">$(</span>ls /proc/ | grep -E <span style="color:#e6db74">&#39;^[0-9]+$&#39;</span><span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">[</span> -d <span style="color:#e6db74">&#34;/proc/</span>$pid<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  exe_path<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>readlink /proc/$pid/exe 2&gt;/dev/null<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $exe_path <span style="color:#f92672">==</span> *<span style="color:#e6db74">&#34;(deleted)&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -r /proc/$pid/net/packet <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> -s /proc/$pid/net/packet <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>      cmdline<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ps -p $pid -o cmd<span style="color:#f92672">=</span> 2&gt;/dev/null<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> ! $cmdline <span style="color:#f92672">=</span>~ <span style="color:#e6db74">&#34;tcpdump|wireshark|dhclient&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;[!] Suspicious process detected:&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;    - PID: </span>$pid<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;    - Command: </span>$cmdline<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;    - Deleted executable: </span>$exe_path<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;    - BPF socket is active&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ss -p -n 2&gt;/dev/null | grep <span style="color:#e6db74">&#34;pid=</span>$pid<span style="color:#e6db74">,&#34;</span> | awk <span style="color:#e6db74">&#39;{print &#34;    - Network: &#34; $0}&#39;</span>
</span></span><span style="display:flex;"><span>        echo <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        found<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span> $found -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;[*] No suspicious processes found.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Detection completed.&#34;</span>
</span></span></code></pre></div><h3 id="cautions"><strong>Cautions</strong><a hidden class="anchor" aria-hidden="true" href="#cautions">#</a></h3>
<ul>
<li>This script provides <strong>only lightweight hints</strong> at the process level.</li>
<li><strong>Advanced eBPF rootkits can tamper with <code>/proc</code></strong>, so relying solely on this script is <strong>not sufficient</strong>.</li>
<li>It is <strong>strongly recommended to use this script in combination with kernel integrity protection modules</strong> like LKRG.</li>
</ul>
<blockquote>
<p>Without kernel integrity protection like LKRG, even detection results may be forged.</p></blockquote>
<h2 id="checking-for-ebpf-backdoors-in-openstack-environments"><strong>Checking for eBPF Backdoors in OpenStack Environments</strong><a hidden class="anchor" aria-hidden="true" href="#checking-for-ebpf-backdoors-in-openstack-environments">#</a></h2>
<p>In OpenStack environments, you can directly inspect eBPF activities occurring on the host OS (KVM Hypervisor), but you cannot directly observe eBPF activities inside guest VMs without additional interaction.
This command allows you to inspect eBPF activities inside guest VMs directly from the host OS in an OpenStack environment:</p>
<h3 id="usage-1"><strong>Usage</strong><a hidden class="anchor" aria-hidden="true" href="#usage-1">#</a></h3>
<p>openstack server ssh &ndash;vm-id &ldquo;$VM_ID&rdquo; &ndash; bash -c &ldquo;$(cat scan_bpf.sh)&rdquo; &gt; &ldquo;result_${VM_ID}.txt&rdquo; 2&gt;&amp;1</p>
<h3 id="inspection-script-using-bpftoolscan_"><strong>Inspection Script Using bpftool(scan_bpf.sh)</strong><a hidden class="anchor" aria-hidden="true" href="#inspection-script-using-bpftoolscan_">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># List all BPF programs</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Listing currently loaded BPF programs...&#34;</span>
</span></span><span style="display:flex;"><span>bpftool prog show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># List all BPF maps</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Listing currently loaded BPF maps...&#34;</span>
</span></span><span style="display:flex;"><span>bpftool map show
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Optional: Check for unexpected XDP attachments</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Checking for XDP programs attached to network interfaces...&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> iface in <span style="color:#66d9ef">$(</span>ls /sys/class/net/<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  ip link show dev <span style="color:#e6db74">&#34;</span>$iface<span style="color:#e6db74">&#34;</span> | grep -q <span style="color:#e6db74">&#34;xdp&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;[!] XDP attached: </span>$iface<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Optional: Check for TC filters</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] Checking for TC filters...&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> iface in <span style="color:#66d9ef">$(</span>ls /sys/class/net/<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  tc filter show dev <span style="color:#e6db74">&#34;</span>$iface<span style="color:#e6db74">&#34;</span> 2&gt;/dev/null | grep -i <span style="color:#e6db74">&#34;bpf&#34;</span> <span style="color:#f92672">&amp;&amp;</span> echo <span style="color:#e6db74">&#34;[!] BPF TC filter detected on: </span>$iface<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;[*] BPF scan completed.&#34;</span>
</span></span></code></pre></div><h3 id="script-explanation"><strong>Script Explanation</strong><a hidden class="anchor" aria-hidden="true" href="#script-explanation">#</a></h3>
<ul>
<li><strong><code>bpftool prog show</code></strong>: Lists all currently loaded eBPF programs in the kernel. Essential for spotting potentially malicious BPF programs.</li>
<li><strong><code>bpftool map show</code></strong>: Lists all BPF maps. Malicious actors may exploit maps for C2 command control or session management.</li>
<li><strong>Checking XDP attachments</strong>:
<ul>
<li>Use <code>ip link show</code> to check if any XDP programs are attached to network interfaces.</li>
<li>XDP (eXpress Data Path) allows direct packet interception at the NIC (Layer 2) level and may be exploited by backdoors like BPFDoor to manipulate traffic stealthily.</li>
</ul>
</li>
<li><strong>Checking TC (Traffic Control) filters</strong>:
<ul>
<li>Use <code>tc filter show</code> to check if BPF-based traffic filters are applied to network interfaces.</li>
<li>TC filters can be used to selectively manipulate network traffic.</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Summary</strong>:<br>
By inspecting BPF programs, maps, XDP attachments, and TC filters, you can detect traces of eBPF backdoors early from the OpenStack host level.</p></blockquote>
<h2 id="dealing-with-ebpf-backdoors-in-vsphere--vmware-nsx-environments"><strong>Dealing with eBPF Backdoors in vSphere + VMware NSX Environments</strong><a hidden class="anchor" aria-hidden="true" href="#dealing-with-ebpf-backdoors-in-vsphere--vmware-nsx-environments">#</a></h2>
<p>In vSphere (ESXi) environments, direct inspection inside guest OSs is difficult,<br>
but NSX allows detection of abnormal behaviors at the <strong>network level</strong>.</p>
<h3 id="possible-detection-strategies"><strong>Possible Detection Strategies</strong><a hidden class="anchor" aria-hidden="true" href="#possible-detection-strategies">#</a></h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Method</th>
          <th style="text-align: left">Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>Using Distributed Firewall (DFW) Rules</strong></td>
          <td style="text-align: left">Detect or block unexpected outbound port usage or C2 server connection attempts.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Activating NSX IDS/IPS Features</strong></td>
          <td style="text-align: left">Detect communication patterns similar to BPFDoor (e.g., abnormal UDP, ICMP tunneling).</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Using Flow Analytics</strong></td>
          <td style="text-align: left">Analyze East-West traffic between VMs to detect abnormal communication flows.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Leveraging NSX Threat Intelligence</strong></td>
          <td style="text-align: left">If NSX ATP (Advanced Threat Protection) modules are enabled, detect known IOCs (Indicators of Compromise).</td>
      </tr>
  </tbody>
</table>
<h3 id="cautions-1"><strong>Cautions</strong><a hidden class="anchor" aria-hidden="true" href="#cautions-1">#</a></h3>
<ul>
<li>NSX <strong>cannot detect internal kernel tampering</strong>. (Detection is purely from a network perspective.)</li>
<li><strong>Separate monitoring inside guest OSs</strong> is still necessary. (e.g., using Tracee, EDR, etc.)</li>
</ul>
<blockquote>
<p>&ldquo;<strong>In vSphere environments, the most effective approach is a dual-layered structure:<br>
use NSX for network-level anomaly detection, and deploy separate runtime security tools inside guest OSs for kernel monitoring.</strong>&rdquo;</p></blockquote>
<h2 id="publicly-available-ebpf-backdoor-detection-frameworks-and-tools"><strong>Publicly Available eBPF Backdoor Detection Frameworks and Tools</strong><a hidden class="anchor" aria-hidden="true" href="#publicly-available-ebpf-backdoor-detection-frameworks-and-tools">#</a></h2>
<p>Several <strong>open-source tools and frameworks</strong> have recently been developed to detect malicious eBPF activities.<br>
Here are key tools and their characteristics:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Tool/Framework</th>
          <th style="text-align: left">Approach and Features</th>
          <th style="text-align: left">Remarks</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><strong>Tracee (Aqua Security)</strong></td>
          <td style="text-align: left">An <strong>eBPF-based real-time monitoring tool</strong> that traces kernel events to detect malicious behaviors. Especially captures <code>bpf_attach</code> events at the moment an eBPF program attaches to a kprobe/tracepoint, recording ID, name, type, and used helper functionsâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>)â€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Aqua%20Tracee%20%E2%80%93%20Out">aquasec.com</a>).</td>
          <td style="text-align: left">Open-source (available on GitHub). Developed by Aqua Security for detecting eBPF rootkits and malware.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>ebpfkit-monitor</strong></td>
          <td style="text-align: left">A specialized tool developed by Datadog researchers (Fournier) that <strong>statically analyzes</strong> eBPF bytecode or <strong>monitors execution</strong> to detect malicious eBPF loadingâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=On%20the%20other%20hand%2C%20ebpfkit,Such%20rootkits%20can%20hide%20themselves">scitepress.org</a>).</td>
          <td style="text-align: left">Open-source (available on GitHub). Originally designed to detect the <code>ebpfkit</code> rootkit.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Falco (CNCF/Sysdig)</strong></td>
          <td style="text-align: left">A <strong>Host Intrusion Detection System (HIDS)</strong> that uses eBPF to monitor system calls for malicious activities. Recent versions can <strong>monitor <code>bpf()</code> syscall invocations</strong> to detect privilege escalation attempts using eBPFâ€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>).</td>
          <td style="text-align: left">Open-source CNCF project. Often used in container/cloud environments with customizable rules.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>bpftool (Linux native tool)</strong></td>
          <td style="text-align: left">A <strong>built-in BPF debugging/management tool</strong> that lists loaded eBPF programs, maps, and links. Manual inspection using <code>bpftool prog</code>, <code>bpftool map</code>, etc., can help detect suspicious BPF objects and attachment pointsâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>).</td>
          <td style="text-align: left">Available in Linux 4.x and above. Useful for manual inspections or lightweight scripting.</td>
      </tr>
      <tr>
          <td style="text-align: left"><strong>Volatility eBPF Plugin</strong></td>
          <td style="text-align: left">A plugin for the memory forensic tool <strong>Volatility</strong>, allowing <strong>extraction and analysis of eBPF programs from memory dumps</strong> by searching the <code>prog_idr</code> structureâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=the%20compiled%20eBPF%20programs,the%20called%20functions%20are%20identified">scitepress.org</a>). Includes a <strong>classifier</strong> to identify potentially malicious programs.</td>
          <td style="text-align: left">Research-grade tool (released in 2024). Most effective for hypervisor/offline memory dump analysis, as active rootkits can tamper with live systems.</td>
      </tr>
  </tbody>
</table>
<hr>
<p>These tools vary in <strong>strengths and use cases</strong>.<br>
For example, <strong>Tracee</strong> and <strong>Falco</strong> are strong in <strong>real-time detection</strong>, catching the exact moment an eBPF program is loaded or detecting suspicious system call patternsâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>)â€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>).</p>
<p>In contrast, forensic tools like the <strong>Volatility plugin</strong> are valuable for <strong>post-compromise investigations</strong>, enabling detection of stealthy backdoors by analyzing hypervisor-level memory dumpsâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>).</p>
<blockquote>
<p><strong>Summary</strong>:<br>
Combining these tools according to the situation allows building a <strong>multi-layered eBPF threat detection strategy</strong>.</p></blockquote>
<h2 id="latest-detection-methodologies-20232025-and-research-trends"><strong>Latest Detection Methodologies (2023â€“2025) and Research Trends</strong><a hidden class="anchor" aria-hidden="true" href="#latest-detection-methodologies-20232025-and-research-trends">#</a></h2>
<p>Recent <strong>academic papers, security reports, and technical blogs</strong> have introduced various approaches and improvements for detecting eBPF-based backdoors.<br>
Key methodologies include:</p>
<h3 id="1-real-time-load-monitoring"><strong>1. Real-Time Load Monitoring</strong><a hidden class="anchor" aria-hidden="true" href="#1-real-time-load-monitoring">#</a></h3>
<p>The most effective detection occurs <strong>at the moment an eBPF program is loaded into the kernel</strong>â€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=If%20you%20suspect%20there%20may,based%20malware">redcanary.com</a>).</p>
<p>According to Red Canary, if you miss the loading event, detecting eBPF malware becomes <strong>extremely difficult</strong>.<br>
Thus, EDR (Endpoint Detection and Response) solutions or custom monitoring tools must watch for <strong><code>bpf()</code> syscalls</strong>, <strong>kprobe registrations</strong>, and similar events in real-timeâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=If%20you%20suspect%20there%20may,can%E2%80%99t%20trust%20the%20data%20you">redcanary.com</a>).</p>
<p>Aqua Security incorporated <code>bpf_attach</code> event monitoring into <strong>Tracee</strong>, enabling automatic detection the moment a malicious eBPF program hooks into a kprobe or uretprobeâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>)â€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Aqua%20Tracee%20%E2%80%93%20Out">aquasec.com</a>).</p>
<p>In 2023, Aqua detected the <strong>Pamspy malware</strong>, which hijacked PAM authentication using an eBPF uretprobe.<br>
By capturing the loading event of the <code>trace_pam_get_a</code> eBPF program, they identified <strong>plaintext credential theft attempts</strong>â€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Below%20you%20can%20see%20a,clear%20text%20username%20and%20password">aquasec.com</a>).</p>
<blockquote>
<p><strong>Summary</strong>:<br>
<strong>Kernel event hook monitoring</strong> is becoming a crucial trend in modern EDRs and open-source tools.</p></blockquote>
<hr>
<h3 id="2-kernel-integrity-checking-and-hardening"><strong>2. Kernel Integrity Checking and Hardening</strong><a hidden class="anchor" aria-hidden="true" href="#2-kernel-integrity-checking-and-hardening">#</a></h3>
<p>Research efforts also focus on embedding <strong>security controls inside the kernel</strong> to block or detect eBPF backdoors proactively.</p>
<p>Recommendations include:</p>
<ul>
<li>Enabling <code>CONFIG_BPF_UNPRIV_DEFAULT_OFF</code> to prevent unprivileged users from using eBPFâ€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20most%20effective%20way%20to,Kprobe%2C%20TC%2C%20and%20so%20on">sysdig.com</a>).</li>
<li>Restricting <code>SYS_bpf</code> syscall usage to root users only.</li>
<li>Disabling unnecessary options like <code>CONFIG_BPF_KPROBE_OVERRIDE</code> and reducing the attack surface by <strong>removing kprobe features</strong> during kernel compilationâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,programmatically%20disable%20things%20like%20kprobes">redcanary.com</a>).</li>
</ul>
<blockquote>
<p>These approaches are <strong>preventive</strong>, aiming to reduce the risk before an attack happens.</p></blockquote>
<hr>
<h3 id="3-hypervisor-based-auditing"><strong>3. Hypervisor-Based Auditing</strong><a hidden class="anchor" aria-hidden="true" href="#3-hypervisor-based-auditing">#</a></h3>
<p>Host-based detection tools can be <strong>bypassed by rootkits</strong> with kernel-level privilegesâ€‹ (<a href="https://blog.thalium.re/posts/linux-kernel-rust-module-for-rootkit-detection/#:~:text=to%20place%20our%20EDR%20in,the%20kernel">blog.thalium.re</a>).</p>
<p>To address this, 2023â€“2024 research explored <strong>auditing eBPF activities from the hypervisor layer</strong>.</p>
<p>Examples:</p>
<ul>
<li>The <strong>HyperBee</strong> framework proposed inspecting eBPF programs loaded in guest OSs <strong>before execution</strong>â€‹ (<a href="https://conferences.sigcomm.org/sigcomm/2023/files/workshop-ebpf/10-HyperBee.pdf#:~:text=Comprehensiveness,and%20their%20user%20space">conferences.sigcomm.org</a>).</li>
<li>Another 2024 study showed <strong>snapshotting guest memory</strong> with lightweight hypervisors and using Volatility plugins to extract and classify suspicious eBPF helper functionsâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=the%20compiled%20eBPF%20programs,the%20called%20functions%20are%20identified">scitepress.org</a>).</li>
</ul>
<blockquote>
<p>Hypervisor-based techniques offer a promising path to detect <strong>stealthy rootkits</strong> without relying on compromised guest OSs.</p></blockquote>
<hr>
<h3 id="4-post-incident-inspection-and-hunting"><strong>4. Post-Incident Inspection and Hunting</strong><a hidden class="anchor" aria-hidden="true" href="#4-post-incident-inspection-and-hunting">#</a></h3>
<p>If real-time detection fails, <strong>manual threat hunting</strong> becomes necessary.<br>
Recommendations from recent reports include:</p>
<ul>
<li>
<p><strong>Checking for unexpected kprobes</strong>:<br>
Inspect <code>/sys/kernel/debug/kprobes/list</code> for unusual hooks on unfamiliar functionsâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>).</p>
</li>
<li>
<p><strong>Listing loaded eBPF programs</strong>:<br>
Use <code>bpftool prog</code> to enumerate in-memory eBPF programs. Pay special attention to suspicious types like <code>kprobe</code>â€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>).</p>
</li>
<li>
<p><strong>Checking BPF-linked perf events</strong>:<br>
<code>bpftool perf</code> can reveal which PIDs have attached probes.</p>
</li>
<li>
<p><strong>Inspecting XDP and TC hooks</strong>:<br>
Verify if unexpected XDP programs (<code>ip link show</code>) or TC filters (<code>tc filter show</code>) are attached.</p>
</li>
<li>
<p><strong>Monitoring the BPF filesystem (<code>bpffs</code>)</strong>:<br>
Look into <code>/sys/fs/bpf/</code> for <strong>pinned objects</strong> that attackers may use for persistenceâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Check%20if%20there%20are%20any,BPF%20filesystem">redcanary.com</a>).</p>
</li>
<li>
<p><strong>Checking system logs</strong>:<br>
Review <code>dmesg</code> for BPF-related warnings, such as unauthorized <code>bpf()</code> usage or dangerous helper functions like <code>bpf_override_return</code>.</p>
</li>
</ul>
<blockquote>
<p><strong>Summary</strong>:<br>
Modern threat hunting involves <strong>multi-angle system inspection</strong>, collecting any suspicious BPF-related evidence for deep analysis.</p></blockquote>
<hr>
<h2 id="real-world-case-studies-detecting-and-responding-to-ebpf-backdoors"><strong>Real-World Case Studies: Detecting and Responding to eBPF Backdoors</strong><a hidden class="anchor" aria-hidden="true" href="#real-world-case-studies-detecting-and-responding-to-ebpf-backdoors">#</a></h2>
<p>One representative case that highlights the importance of eBPF detection is the <strong>BPFDoor backdoor</strong>.</p>
<p><strong>BPFDoor</strong> is a Linux backdoor discovered in the late 2010s, which utilized <strong>classic BPF (cBPF) filters</strong> to detect specific <strong>magic packets</strong> and open reverse shells for attackersâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=BPFDoor%20samples%20load%20classic%20BPF,uniquely%20stand%20for%20specific%20identifiers">trendmicro.com</a>).<br>
Because it bypassed firewall rules and hid network ports from scans, it was dubbed a &ldquo;<strong>doorless backdoor</strong>.&rdquo;</p>
<p>In 2022, BPFDoor was publicly exposed, and by 2023, APT attackers had enhanced it, making BPF filters even more complexâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=This%20entry%20shows%20how%20Red,of%20BPFDoor%20in%20infected%20systems">trendmicro.com</a>).</p>
<p><strong>Security vendors used both network-level and host-level indicators</strong> to detect BPFDoor:</p>
<ul>
<li><strong>Trend Micro</strong> updated their products to detect BPFDoorâ€™s BPF filter patternsâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=difficult%20to%20detect%20due%20to,protection%20solutions%20in%20Linux%20and">trendmicro.com</a>).</li>
<li>They investigated <strong>setsockopt calls inserting BPF filters</strong> and tracked suspicious <strong>raw socket processes</strong>.</li>
<li>Trend Micro also noted that newer variants increased BPF filter complexity sixfold, indicating ongoing evolutionâ€‹ (<a href="https://www.trendmicro.com/en_us/research/23/g/detecting-bpfdoor-backdoor-variants-abusing-bpf-filters.html#:~:text=From%20a%20technical%20perspective%2C%20the,refer%20to%20the%20same%20technology">trendmicro.com</a>).</li>
</ul>
<blockquote>
<p><strong>Takeaway</strong>:<br>
BPFDoor proved that <strong>BPF-based backdoors are detectable</strong>, but attackers are constantly adapting.</p></blockquote>
<hr>
<p>Another notable case is the detection of the <strong>Pamspy malware</strong>:</p>
<ul>
<li><strong>Pamspy</strong> exploited an eBPF <strong>uretprobe</strong> to intercept results from authentication functions inside <code>libpam.so</code>.</li>
<li>Aqua Security researchers detected it using their open-source tool <strong>Tracee</strong>.</li>
<li>The Tracee logs captured detailed information such as the <strong>hooked function name</strong> (<code>pam_get_authtok</code>) and <strong>memory offsets</strong>,<br>
allowing the detection of <strong>credential theft attempts without needing hidden processes</strong>â€‹ (<a href="https://www.aquasec.com/blog/detecting-ebpf-malware-with-tracee/#:~:text=Below%20you%20can%20see%20a,clear%20text%20username%20and%20password">aquasec.com</a>).</li>
</ul>
<blockquote>
<p><strong>Summary</strong>:<br>
<strong>Modern breaches increasingly involve eBPF-based tactics</strong>, and community sharing of tools and case studies is advancing defensive strategies.</p></blockquote>
<h2 id="response-strategies-and-practical-recommendations"><strong>Response Strategies and Practical Recommendations</strong><a hidden class="anchor" aria-hidden="true" href="#response-strategies-and-practical-recommendations">#</a></h2>
<p>To counter eBPF-based backdoors, <strong>a multilayered detection and prevention strategy is essential</strong>.<br>
Here are actionable recommendations for practical environments:</p>
<h3 id="1-privilege-management-and-hardening"><strong>1. Privilege Management and Hardening</strong><a hidden class="anchor" aria-hidden="true" href="#1-privilege-management-and-hardening">#</a></h3>
<ul>
<li><strong>Disable eBPF</strong> entirely via kernel compile options or sysctl settings if not neededâ€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20most%20effective%20way%20to,Kprobe%2C%20TC%2C%20and%20so%20on">sysdig.com</a>).</li>
<li>Restrict <code>CAP_BPF</code> capabilities and enforce <code>CONFIG_BPF_UNPRIV_DEFAULT_OFF</code>.</li>
<li>Set <code>CONFIG_BPF_JIT_ALWAYS_ON</code> to minimize eBPF JIT exploitation risks.</li>
<li>Disable unused kprobe/tracepoint features to reduce attack surfaceâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=,programmatically%20disable%20things%20like%20kprobes">redcanary.com</a>).</li>
</ul>
<hr>
<h3 id="2-deploy-real-time-monitoring-tools"><strong>2. Deploy Real-Time Monitoring Tools</strong><a hidden class="anchor" aria-hidden="true" href="#2-deploy-real-time-monitoring-tools">#</a></h3>
<ul>
<li>Deploy <strong>open-source HIDS/EDR tools</strong> that can monitor eBPF-related events.</li>
<li><strong>Falco</strong> can track suspicious <code>bpf()</code> or <code>perf_event_open</code> system calls with rule-based alertsâ€‹ (<a href="https://sysdig.com/blog/ebpf-offensive-capabilities/#:~:text=The%20best%20way%20to%20deal,kernel%20and%20detect%20suspicious%20activities">sysdig.com</a>).</li>
<li><strong>Tracee</strong> can log kernel hook events in real timeâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=out%3A%20Tracee%20,event%20oc%02curs%20whenever%20an%20eBPF">scitepress.org</a>).</li>
<li>Consider containerizing these tools for lightweight deployment and <strong>always-on detection</strong>.</li>
</ul>
<hr>
<h3 id="3-conduct-regular-integrity-checks"><strong>3. Conduct Regular Integrity Checks</strong><a hidden class="anchor" aria-hidden="true" href="#3-conduct-regular-integrity-checks">#</a></h3>
<ul>
<li>Schedule regular scans using <code>bpftool</code> to <strong>dump the list of loaded eBPF programs</strong>.</li>
<li>Compare (diff) with previous outputs to identify new or suspicious entries.</li>
<li>Focus especially on newly appeared <code>kprobe</code>, <code>tracepoint</code>, or unknown eBPF programsâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Use%20,programs">redcanary.com</a>).</li>
<li>Regularly inspect <code>/sys/fs/bpf/</code> and <code>/sys/kernel/debug/kprobes/list</code> for unusual activityâ€‹ (<a href="https://redcanary.com/blog/threat-detection/ebpf-malware/#:~:text=Look%20for%20unexpected%20kprobes%20loaded%3A">redcanary.com</a>).</li>
</ul>
<hr>
<h3 id="4-prepare-forensic-capabilities"><strong>4. Prepare Forensic Capabilities</strong><a hidden class="anchor" aria-hidden="true" href="#4-prepare-forensic-capabilities">#</a></h3>
<ul>
<li>Establish <strong>memory forensic procedures</strong> for critical servers.</li>
<li>Prepare hypervisor-based snapshots or remote memory dump capabilities.</li>
<li>Use tools like <strong>Volatility plugins</strong> to extract eBPF-related structures post-incidentâ€‹ (<a href="https://www.scitepress.org/Papers/2024/124708/124708.pdf#:~:text=While%20these%20two%20tools%20provide,is%20believed%20to%20be%20secure">scitepress.org</a>).</li>
<li>Memory forensics acts as a <strong>last line of defense</strong> against stealthy eBPF backdoors.</li>
</ul>
<hr>
<h3 id="5-continuously-update-and-share-intelligence"><strong>5. Continuously Update and Share Intelligence</strong><a hidden class="anchor" aria-hidden="true" href="#5-continuously-update-and-share-intelligence">#</a></h3>
<ul>
<li>Stay updated on the latest security blogs, conferences, and GitHub repositories.</li>
<li>Actively incorporate new IOCs (Indicators of Compromise) and detection rules.</li>
<li>Quickly analyze and reflect new backdoor variants or malware samples (e.g., updated BPFDoor variants) into internal security measures.</li>
</ul>
<blockquote>
<p><strong>Summary</strong>:<br>
eBPF backdoor detection demands <strong>a proactive, multilayered defense</strong> combining real-time monitoring, post-incident validation, preventive hardening, and continuous intelligence updates.<br>
Security professionals must leverage eBPF itself to <strong>watch the kernel from within</strong>, turning attackers&rsquo; tools into defenders&rsquo; shields.</p></blockquote>
<hr>
<h2 id="-additional-note-kernel-integrity-validation-must-be-strengthened-in-national-security-requirements">ðŸ“Œ Additional Note: Kernel Integrity Validation Must Be Strengthened in National Security Requirements<a hidden class="anchor" aria-hidden="true" href="#-additional-note-kernel-integrity-validation-must-be-strengthened-in-national-security-requirements">#</a></h2>
<p>In the National Security Requirements (South Korea), kernel integrity validation is currently marked as &ldquo;conditionally mandatory.&rdquo;<br>
However, for <strong>critical infrastructure</strong>, <strong>public-facing servers</strong>, and <strong>sensitive information servers</strong>,<br>
it should be treated as an <strong>absolute mandatory</strong> requirement.<br>
Without kernel integrity validation, it is impossible to prove the security of the system.</p>
<ul>
<li>ðŸ“„ National security requirements reference (Korean): <a href="https://www.nis.go.kr/AF/1_7_2_4/view.do?seq=98">Official link from the National Intelligence Service (NIS)</a></li>
</ul>
<blockquote>
<p>â€» As of the latest version (Server Common Security Requirements v3.0), integrity validation of the operating system kernel or kernel-level modules is required conditionally.</p></blockquote>
<h3 id="related-materials">Related Materials<a hidden class="anchor" aria-hidden="true" href="#related-materials">#</a></h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Category</th>
          <th style="text-align: left">Image</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">National Security Requirements Framework</td>
          <td style="text-align: left"><img alt="National Security Requirements Framework" loading="lazy" src="/images/post/NationalSecurityRequirementsFramework.webp"></td>
      </tr>
      <tr>
          <td style="text-align: left">Kernel Integrity Validation Requirements (Excerpt)</td>
          <td style="text-align: left"><img alt="Kernel Integrity Validation Item" loading="lazy" src="/images/post/KernelIntegrityValidationItem.webp"></td>
      </tr>
  </tbody>
</table>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/en/tags/ebpf/">EBPF</a></li>
      <li><a href="http://localhost:1313/en/tags/rootkit-detection/">Rootkit Detection</a></li>
      <li><a href="http://localhost:1313/en/tags/bpfdoor/">BPFDoor</a></li>
      <li><a href="http://localhost:1313/en/tags/kernel-security/">Kernel Security</a></li>
      <li><a href="http://localhost:1313/en/tags/tracee/">Tracee</a></li>
      <li><a href="http://localhost:1313/en/tags/lkrg/">LKRG</a></li>
      <li><a href="http://localhost:1313/en/tags/hypervisor-audit/">Hypervisor Audit</a></li>
      <li><a href="http://localhost:1313/en/tags/forensics/">Forensics</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/en/post/2025-05-07-ai-insight-vs-human/">
    <span class="title">Â« Prev</span>
    <br>
    <span>Human Insight and Artificial Intelligence: Dialogue at an Impossible Crossroads</span>
  </a>
  <a class="next" href="http://localhost:1313/en/post/2025-04-28-telecom-security-breach-analysis/">
    <span class="title">Next Â»</span>
    <br>
    <span>In-Depth Report on Telecommunication Security: SKT Breach and Global Case Studies</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on x"
            href="https://x.com/intent/tweet/?text=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&amp;hashtags=eBPF%2cRootkitDetection%2cBPFDoor%2cKernelSecurity%2cTracee%2cLKRG%2cHypervisorAudit%2cForensics">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&amp;title=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors&amp;summary=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors&amp;source=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f&title=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on whatsapp"
            href="https://api.whatsapp.com/send?text=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors%20-%20http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on telegram"
            href="https://telegram.me/share/url?text=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Detection Frameworks and Latest Methodologies for eBPF-Based Backdoors on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Detection%20Frameworks%20and%20Latest%20Methodologies%20for%20eBPF-Based%20Backdoors&u=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-04-29-ebpf-backdoor-detection-framework%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/en/">Code Before Breach</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
  function loadGiscus(theme) {
    
    document.querySelectorAll('.giscus-frame, script[src*="giscus.app"]').forEach(el => el.remove());

    
    const giscusScript = document.createElement("script");
    giscusScript.src = "https://giscus.app/client.js";
    giscusScript.setAttribute("data-repo", "windshock\/windshock.github.io");
    giscusScript.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnkxODQ2MDMyMTk=");
    giscusScript.setAttribute("data-category", "General");
    giscusScript.setAttribute("data-category-id", "DIC_kwDOCwDSU84CoqLg");
    giscusScript.setAttribute("data-mapping", "pathname");
    giscusScript.setAttribute("data-reactions-enabled", "1");
    giscusScript.setAttribute("data-theme", theme); 
    giscusScript.setAttribute("data-lang", "en");
    giscusScript.setAttribute("data-input-position", "bottom");
    giscusScript.setAttribute("data-loading", "lazy");
    giscusScript.crossOrigin = "anonymous";
    giscusScript.async = true;

    document.body.appendChild(giscusScript);
  }

  
  const currentTheme = document.body.classList.contains("dark") ? "dark" : "light";
  loadGiscus(currentTheme);

  
  const observer = new MutationObserver(() => {
    const newTheme = document.body.classList.contains("dark") ? "dark" : "light";
    loadGiscus(newTheme);
  });

  observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
</script>



<script>
  function initSwiperIfNeeded() {
    if (typeof Swiper === 'undefined') {
      
      return setTimeout(initSwiperIfNeeded, 50);
    }

    if (document.querySelector('.swiper')) {
      new Swiper('.swiper', {
        slidesPerView: 1.2,
        spaceBetween: 16,
        loop: true,
        preloadImages: false,
        lazy: {
          loadOnTransitionStart: true,
          loadPrevNext: true,
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true
        },
        breakpoints: {
          768: { slidesPerView: 2.5 },
          1024: { slidesPerView: 3.2 }
        }
      });

      
      document.querySelectorAll('img.swiper-lazy').forEach(img => {
        img.src = img.dataset.src;
      });
    } else {
      setTimeout(initSwiperIfNeeded, 100);
    }
  }

  
  initSwiperIfNeeded();
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
