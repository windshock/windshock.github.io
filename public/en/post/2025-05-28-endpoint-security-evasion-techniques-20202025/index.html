<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR | Code Before Breach</title>
<meta name="keywords" content="Mind, EDR, BYOVD, BYOI, DLL Hijacking, Service Tampering, AV Evasion, Malware, Ransomware">
<meta name="description" content="This post analyzes the evolution of endpoint evasion techniques from 2020 to 2025. It covers BYOI, BYOVD, DLL hijacking, service tampering, and other sophisticated methods attackers use to bypass EDR and AV. Real-world ransomware cases and vendor impact are discussed, along with defensive insights.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/en/post/2025-05-28-endpoint-security-evasion-techniques-20202025/">
<link href="https://fonts.googleapis.com/css2?family=Spectral:wght@400;700&display=swap" rel="stylesheet">
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://localhost:1313/index.xml" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css" integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF&#43;13Dyqob6ASlTrTye8=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/en/post/2025-05-28-endpoint-security-evasion-techniques-20202025/">
<link rel="alternate" hreflang="ko" href="http://localhost:1313/ko/post/2025-05-28-endpoint-security-evasion-techniques-20202025/">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script defer src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/en/" accesskey="h" title="Code Before Breach (Alt + H)">
                <img src="http://localhost:1313/images/logo-terminal-animated.svg" alt="" aria-label="logo" class="h-7 w-auto"
                    height="28">Code Before Breach</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="http://localhost:1313/ko/" title="한국어"
                            aria-label="한국어">Ko</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/en/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/en/index.xml" title="RSS">
                    <span>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>



<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/en/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/en/post/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR
    </h1>
    <div class="post-meta"><span title='2025-05-28 00:00:00 +0000 UTC'>May 28, 2025</span>&nbsp;·&nbsp;33 min&nbsp;·&nbsp;6903 words&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="http://localhost:1313/ko/post/2025-05-28-endpoint-security-evasion-techniques-20202025/">Ko</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#endpoint-security-evasion-techniques-20202025--a-technical-deep-dive" aria-label="Endpoint Security Evasion Techniques (2020–2025) – A Technical Deep Dive">Endpoint Security Evasion Techniques (2020–2025) – A Technical Deep Dive</a><ul>
                        
                <li>
                    <a href="#introduction-and-key-trends-20202025" aria-label="Introduction and Key Trends (2020–2025)">Introduction and Key Trends (2020–2025)</a></li>
                <li>
                    <a href="#bring-your-own-installer-byoi--abusing-installers-to-disable-edr" aria-label="Bring Your Own Installer (BYOI) – Abusing Installers to Disable EDR">Bring Your Own Installer (BYOI) – Abusing Installers to Disable EDR</a></li>
                <li>
                    <a href="#bring-your-own-vulnerable-driver-byovd--kernel-mode-edr-killers" aria-label="Bring Your Own Vulnerable Driver (BYOVD) – Kernel-Mode EDR Killers">Bring Your Own Vulnerable Driver (BYOVD) – Kernel-Mode EDR Killers</a></li>
                <li>
                    <a href="#dll-hijacking-and-side-loading--subverting-trust-to-inject-malicious-code" aria-label="DLL Hijacking and Side-Loading – Subverting Trust to Inject Malicious Code">DLL Hijacking and Side-Loading – Subverting Trust to Inject Malicious Code</a></li>
                <li>
                    <a href="#service-abuse--tampering--abusing-system-tools-and-modes-to-disable-protection" aria-label="Service Abuse &amp; Tampering – Abusing System Tools and Modes to Disable Protection">Service Abuse &amp; Tampering – Abusing System Tools and Modes to Disable Protection</a><ul>
                        
                <li>
                    <a href="#techniques-vs-affected-vendors-20202025" aria-label="Techniques vs. Affected Vendors (2020–2025)">Techniques vs. Affected Vendors (2020–2025)</a></li>
                <li>
                    <a href="#timeline-of-evasion-techniques-emergence-20202025" aria-label="Timeline of Evasion Techniques Emergence (2020–2025)">Timeline of Evasion Techniques Emergence (2020–2025)</a></li>
                <li>
                    <a href="#mitigation-approaches-and-defensive-measures" aria-label="Mitigation Approaches and Defensive Measures">Mitigation Approaches and Defensive Measures</a></li></ul>
                </li>
                <li>
                    <a href="#defensive-recommendations-for-edr-evasion" aria-label="Defensive Recommendations for EDR Evasion">Defensive Recommendations for EDR Evasion</a></li>
                <li>
                    <a href="#reference-links--edr-evasion-research20202025" aria-label="Reference Links – EDR Evasion Research(2020–2025)">Reference Links – EDR Evasion Research(2020–2025)</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/VEhcKYgN7Sw?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<h1 id="endpoint-security-evasion-techniques-20202025--a-technical-deep-dive"><strong>Endpoint Security Evasion Techniques (2020–2025) – A Technical Deep Dive</strong><a hidden class="anchor" aria-hidden="true" href="#endpoint-security-evasion-techniques-20202025--a-technical-deep-dive">#</a></h1>
<h2 id="introduction-and-key-trends-20202025"><strong>Introduction and Key Trends (2020–2025)</strong><a hidden class="anchor" aria-hidden="true" href="#introduction-and-key-trends-20202025">#</a></h2>
<p>Over the past five years, threat actors have aggressively developed new techniques to <strong>bypass, disable, or blind endpoint detection and response (EDR) and antivirus tools</strong>. Rather than relying solely on malware obfuscation, attackers are increasingly exploiting design flaws in security products and operating system features to neutralize defenses. In multiple high-profile cases between 2020 and 2025, ransomware gangs (e.g. Babuk, LockBit, BlackByte, AvosLocker) and APT actors (e.g. ToddyCat) leveraged tactics like <strong>installer abuse, vulnerable drivers, DLL hijacking, and service manipulation</strong> to undermine EDR/AV protectionsfile-4pcvlwhk3myukez4vihgen<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a>. These in-the-wild attacks demonstrate that <strong>simply running an EDR agent is not a panacea</strong> – if adversaries can turn the security software’s own functionality against itself, they can freely deploy ransomware or steal data once defenses are down.</p>
<p><strong>Key points:</strong></p>
<ul>
<li>
<p><strong>“Bring Your Own Installer” (BYOI) Abuse –</strong> Attackers found they could <strong>leverage legitimate security product installers/updaters to disable the product itself</strong> during an upgrade or reinstall process<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a>. For example, in an incident investigated in 2025, Babuk ransomware operators used SentinelOne’s <strong>own installer</strong> to bypass its tamper protection, leaving the endpoint unprotected for malware execution<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a>. This technique exploits a window of opportunity when the EDR agent intentionally stops itself to perform an update<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=The%20technique%2C%20uncovered%20by%20researchers,to%20terminate%20active%20EDR%20processes">halcyon.ai</a>.</p>
</li>
<li>
<p><strong>“Bring Your Own Vulnerable Driver” (BYOVD) Attacks –</strong> The use of <strong>legitimate but vulnerable drivers</strong> has become a widespread EDR-killer tactic<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=This%20tool%20utilizes%20the%20Bring,unobstructed%20execution%20of%20ransomware%20encryptors">halcyon.ai</a>. Ransomware groups developed or adopted tools that <strong>load old, signed drivers with known flaws</strong> to gain kernel-level privileges and <strong>terminate security processes</strong><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=A%20recent%20analysis%20has%20uncovered,software%20on%20compromised%20systems">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Takeaway%3A%20Threat%20actors%20are%20getting,defenses%20without%20raising%20an%20eyebrow">halcyon.ai</a>. This method was observed across numerous Ransomware-as-a-Service (RaaS) operations (LockBit, BlackByte, Play, Medusa, BianLian, etc.), indicating significant investment in custom “EDR killer” malware<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a><a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a>.</p>
</li>
<li>
<p><strong>DLL Hijacking &amp; Side-Loading –</strong> Advanced attackers targeted <strong>insecure DLL loading paths or abused trusted binaries</strong> to inject malicious code and neutralize security tools. In a notable 2024 case, the ToddyCat APT exploited a <strong>DLL load vulnerability in ESET’s command-line scanner</strong> to load a malicious module <em>inside</em> the AV process, disabling its monitoring capabilities<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a><a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=The%20strings%20are%20not%20obfuscated,system%20or%20a%20load%20event">securelist.com</a>. Similarly, LockBit affiliates abused Windows Defender’s CLI (<code>MpCmdRun.exe</code>) to <strong>side-load a fake DLL</strong> and run Cobalt Strike payloads, bypassing normal EDR detection<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>.</p>
</li>
<li>
<p><strong>Service Abuse &amp; Anti-Tampering Gaps –</strong> Attackers also abused OS features and weaknesses in security service protections. Ransomware like <strong>Snatch and AvosLocker rebooted systems into Safe Mode</strong> (where most security software is inactive) to evade endpoint protection<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a><a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a>. In 2023, researchers even discovered a logic flaw in <strong>CrowdStrike Falcon</strong> that allowed an attacker with sufficient privileges to <strong>suspend the EDR’s core processes</strong>, effectively disabling protectionfile-4pcvlwhk3myukez4vihgen. These examples underscore how <strong>built-in maintenance or fail-safe modes</strong> can be manipulated to turn off security controls.</p>
</li>
</ul>
<p>In the sections below, we dive into each category of evasion technique – <strong>BYOI, BYOVD, DLL Hijacking, and Service Abuse</strong> – explaining their technical mechanics, real-world cases, affected vendors, and countermeasures. We then provide comparative tables (techniques vs. vendors, timeline of emergence, and mitigations) and conclude with strategic recommendations for defenders to harden their endpoint security configurations.</p>
<h2 id="bring-your-own-installer-byoi--abusing-installers-to-disable-edr"><strong>Bring Your Own Installer (BYOI) – Abusing Installers to Disable EDR</strong><a hidden class="anchor" aria-hidden="true" href="#bring-your-own-installer-byoi--abusing-installers-to-disable-edr">#</a></h2>
<p>“Bring Your Own Installer” refers to <strong>leveraging a security product’s own installation or upgrade process to disable it</strong>. Modern EDR/AV agents have self-protection: they cannot be easily killed or uninstalled without special authorization. However, during a legitimate upgrade or reinstall, the agent <strong>intentionally stops or removes the old service</strong> before installing an updated version. Attackers discovered that by <em>manually initiating an install/upgrade and then interrupting it</em>, they could <strong>halt the EDR service indefinitely</strong> without needing any uninstall password or exploit<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=The%20technique%2C%20uncovered%20by%20researchers,to%20terminate%20active%20EDR%20processes">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>.</p>
<p><strong>Technical mechanics –</strong> In practice, the attacker must have already gained privileged (Administrator) access on the endpoint. They then run the official EDR installer/updater (often an MSI or setup executable) for the same or a slightly older agent version. <strong>The installer will shut down the running EDR agent and service as a first step</strong> (assuming an upgrade is about to happen)<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=The%20technique%2C%20uncovered%20by%20researchers,to%20terminate%20active%20EDR%20processes">halcyon.ai</a>. At this point, protections are offline. The attacker then <strong>kills or aborts the installer process (e.g. <code>msiexec.exe</code>) at the critical moment</strong>, preventing the new agent from finishing installation<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. The result: the old agent is gone or inactive, and no new agent is running – the endpoint is left <strong>unprotected and “blind” in the EDR console</strong><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. This is essentially a race condition, exploiting the EDR’s <em>own update logic</em> rather than any code vulnerability.</p>
<p><strong>Real-world example –</strong> In early 2025, an incident response team at Aon’s Stroz Friedberg encountered this BYOI technique during a ransomware investigation<a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=The%20attack%20was%20discovered%20by,ransomware%20attack%20earlier%20this%20year">bleepingcomputer.com</a>. The attackers (affiliates of the Babuk ransomware group) had compromised a publicly exposed server and escalated to local admin. They executed the legitimate <strong>SentinelOne Windows installer</strong> on the host and then forcibly terminated the installation process mid-way<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. Logs showed that the SentinelOne agent was stopped and never restarted, causing the endpoint to appear <em>“offline”</em> in the management console<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. The attackers proceeded to deploy Babuk ransomware on the unprotected machine, which <strong>encrypted data without any EDR interference</strong><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. This BYOI bypass was confirmed to work across multiple versions of the SentinelOne agent and did <strong>not require any third-party toolkit or malicious driver</strong>, making it stealthy and attractive to the attackers<a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=The%20technique%20does%20not%20rely,abuses%20the%20SentinelOne%20installer%20itself">bleepingcomputer.com</a><a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=A%20new%20,to%20install%20the%20Babuk%20ransomware">bleepingcomputer.com</a>.</p>
<p><strong>Vendor response –</strong> SentinelOne quickly responded by <strong>advising customers to enable an optional feature called “Online (Local) Authorization”</strong> for agent upgrades<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=SentinelOne%20privately%20issued%20mitigation%20guidance,guidance%20issued%2C%20clients%20remained%20vulnerable">halcyon.ai</a>. This setting (disabled by default in many environments) forces any local upgrade/uninstall to be authorized through the cloud console, preventing unapproved installer runs. SentinelOne privately rolled out this guidance in January 2025 and even released a detection rule named <strong>“Potential BYOI Exploitation”</strong> to identify attempts at this techniquefile-c4uibyf1ko4p8manjxxfhbfile-c4uibyf1ko4p8manjxxfhb. Once the <em>Local Upgrade Authorization</em> was enabled, Stroz Friedberg confirmed the bypass could no longer succeedfile-c4uibyf1ko4p8manjxxfhb. This case prompted SentinelOne to share details with other EDR vendors, highlighting that <strong>any endpoint security product with a similar local install/update mechanism could be at risk</strong> if not properly secured<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=even%20with%20guidance%20issued%2C%20clients,remained%20vulnerable">halcyon.ai</a>. (Notably, Palo Alto’s Cortex XDR confirmed it was <em>not</em> affected by this exact flaw<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=To%20help%20others%2C%20SentinelOne%20shared,policy%20settings%20in%20EDR%20deployments">halcyon.ai</a>, implying their agent’s upgrade process might differ or require cloud confirmation.)</p>
<p><strong>Other instances –</strong> While the SentinelOne/Babuk case publicized the BYOI concept, researchers have noted that <strong>many EDR and AV solutions exhibit similar behavior during reinstall</strong>. For example, a security researcher demonstrated in 2025 that reinstalling products like Forcepoint One Endpoint would <strong>forcefully terminate their processes and leave them off if the install is aborted</strong> (an apparent design oversight)</p>
<p>. This suggests BYOI is a broader class of weakness: <em>“Should running an installer really disable security?”</em> was a pointed question raised to vendors. The takeaway is that <strong>installers/updaters must be designed with robust checks</strong> – e.g. requiring authentication, not allowing critical protection gaps – otherwise attackers with admin access can simply <em>“reinstall to disable”</em> virtually any security software.</p>
<h2 id="bring-your-own-vulnerable-driver-byovd--kernel-mode-edr-killers"><strong>Bring Your Own Vulnerable Driver (BYOVD) – Kernel-Mode EDR Killers</strong><a hidden class="anchor" aria-hidden="true" href="#bring-your-own-vulnerable-driver-byovd--kernel-mode-edr-killers">#</a></h2>
<p>Bring Your Own Vulnerable Driver attacks involve <strong>weaponizing legitimate, signed drivers that contain known vulnerabilities</strong> in order to execute code in the Windows kernel and cripple security software. This technique has surged in popularity from 2020 onward, as attackers realized that <strong>running code in kernel context can bypass or terminate even “protected” EDR processes</strong><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=While%20the%20abuse%20of%20vulnerable,solutions%20to%20support%20their%20functionality">research.checkpoint.com</a><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=Since%20directly%20terminating%20protected%20processes,for%20further%20stages%20of%20infection">research.checkpoint.com</a>. By loading an outdated driver with a flaw (one that allows arbitrary kernel memory writes, process termination, or disabling of security mechanisms), malware can <strong>effectively disable or blind the EDR/AV</strong> without triggering its self-defense mechanisms – the driver is trusted by the OS due to a valid signature.</p>
<p><strong>Technical mechanics –</strong> The attacker needs a vulnerable driver file (usually a <code>.sys</code> file from an older version of legitimate software) and the ability to load it on the victim machine. Often, they first <strong>drop the driver and a small loader service or use OS utilities (sc.exe)</strong> to install/start the driver. The vulnerable driver, once running with kernel privileges, is then exploited to perform malicious actions such as <strong>killing protected processes, removing kernel callbacks, or unloading security software drivers</strong><a href="https://asec.ahnlab.com/en/86881/#:~:text=The%20threat%20actor%20distributed%20malware,systems%20to%20neutralize%20security%20defenses">asec.ahnlab.com</a><a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=The%20strings%20are%20not%20obfuscated,system%20or%20a%20load%20event">securelist.com</a>. Common targets are the processes of well-known EDR/antivirus services – by terminating or suspending those processes via kernel-mode access, the attacker neutralizes endpoint protections. Because the <strong>driver is signed</strong>, Windows will not block it by default (unless security features like Driver Signature Enforcement and blocklists are in place). This is essentially a way to <strong>turn the operating system against the security tools</strong>: the OS trusts the signed driver, which then can do anything at the highest privilege level.</p>
<p><strong>Real-world cases –</strong> BYOVD has been observed across a <strong>wide range of ransomware families and threat actors</strong>:</p>
<ul>
<li>
<p>In 2022, the BlackByte ransomware gang was found exploiting a vulnerable <strong>MSI Afterburner driver (RTCore64.sys)</strong> to disable EDR products<a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>. The driver (used for GPU overclocking) had a known flaw (CVE-2019-16098) that allowed arbitrary kernel memory modification. BlackByte leveraged it to target the kernel interfaces that EDR products rely on, effectively <strong>blinding security tools</strong> by attacking the OS protection mechanisms<a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>.</p>
</li>
<li>
<p>Around the same time, <strong>AvosLocker</strong> ransomware (noted by FBI/CISA in 2022–2023) abused a legitimate <strong>Avast Anti-Rootkit driver (aswArPot.sys)</strong> to disable antivirus software<a href="https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html#:~:text=">trendmicro.com</a>. The AvosLocker variant loaded this old Avast driver (which is vulnerable) to terminate security processes and even scanned for Log4j-vulnerable systems after neutralizing defenses<a href="https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html#:~:text=We%20found%20samples%20of%20AvosLocker,Log4shell%20using%20Nmap%20NSE%20script">trendmicro.com</a>. This was one of the first instances reported in the U.S. of ransomware using a third-party AV component for evasion.</p>
</li>
<li>
<p>By 2023, the use of custom or repurposed <strong>“EDR killer” tools became a standard tactic</strong> for many RaaS groups. Sophos X-Ops reported on a tool dubbed <strong>“AuKill”</strong> that appeared in at least <strong>three ransomware incidents in early 2023</strong>, used to sabotage the target’s EDR before deployment of payloads<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=Over%20the%20past%20several%20months%2C,ransomware%20on%20the%20target%20system">news.sophos.com</a><a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a>. AuKill abuses an outdated driver from Microsoft’s Process Explorer utility (PROCEXP.SYS) – an example of reusing a benign tool’s driver. In January and February 2023, attackers used AuKill to disable EDR and then executed <strong>Medusa Locker</strong> ransomware, and in another case just prior to a <strong>LockBit</strong> ransomware attack<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a>. Notably, this driver-based approach is the same as an open-source tool called <strong>Backstab</strong> that was published in mid-2021<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20method%20of%20abusing%20the,was%20used%20for%20malicious%20purposes">news.sophos.com</a>, indicating that threat actors are actively borrowing from or contributing to public proof-of-concepts.</p>
</li>
<li>
<p>A major campaign unveiled in 2024 involved a threat actor deploying an EDR killer tool at scale, later attributed to the nascent <strong>RansomHub</strong> ransomware gang. <strong>Checkpoint Research</strong> found that between mid-2024 and early 2025, over <em>2,500</em> variants of a vulnerable driver (the <strong>TrueSight</strong> anti-rootkit driver v2.0.2) were used in the wild to bypass EDR and facilitate malware installation<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=stage%20malicious%20samples%20used%20to,latest%20versions%20of%20Windows%20OS">research.checkpoint.com</a><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=Policy,signed%20variants%20of%20this%20driver">research.checkpoint.com</a>. The attackers cleverly modified minor details in the driver file to generate unique hashes while keeping the signature valid, allowing them to <strong>evade hash-based detection</strong><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=retains%20the%20vulnerable%20code%20while,of%20the%20victims%20are">research.checkpoint.com</a><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=variants%20,They%20are%20typically%20distributed%20via">research.checkpoint.com</a>. They also chose a version of TrueSight that was old enough to <strong>not be included in Microsoft’s driver blocklist</strong> (exploiting a policy loophole for drivers signed before July 2015)<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=,the%20attackers%20deliberately%20generated%20multiple">research.checkpoint.com</a>. The campaign had a global reach, with about 75% of victims in China and others across Asia<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=variants%20of%20this%20driver.%20,module%2C%20they%20are%20designed%20to">research.checkpoint.com</a>, and often delivered a Gh0st RAT payload after disabling security<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=%2A%20CPR%20uncovered%20a%20large,0">research.checkpoint.com</a><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=themselves%20as%20well,payloads%2C%20such%20as%20Gh0st%20RAT">research.checkpoint.com</a>.</p>
</li>
<li>
<p>ESET’s investigation into RansomHub (and corroborated by others like Halcyon) revealed the <strong>custom EDRKillShifter tool</strong> behind this campaign<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=A%20recent%20analysis%20has%20uncovered,software%20on%20compromised%20systems">halcyon.ai</a>. EDRKillShifter uses the BYOVD technique to exploit vulnerable drivers (as seen with TrueSight.sys) and was offered through RansomHub’s affiliate program as a turnkey EDR killer<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=This%20tool%20utilizes%20the%20Bring,unobstructed%20execution%20of%20ransomware%20encryptors">halcyon.ai</a>. Interestingly, by late 2024 this tool <strong>spilled over to other gangs</strong>: the same EDRKillShifter was observed in <strong>Play</strong>, <strong>BianLian</strong>, and <strong>Medusa</strong> ransomware attacks, suggesting either collaboration or shared affiliates among these groups<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a>. This cross-group adoption underscores how effective BYOVD tools have become – even typically siloed ransomware operations are willing to share or buy the capability to <strong>“knock out” a wide range of EDR products</strong><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a>.</p>
</li>
</ul>
<p><strong>Impact on vendors –</strong> BYOVD attacks generally target <strong>whatever EDR/AV is present</strong> on the victim system. The vulnerable driver can be instructed to <strong>terminate processes or services by name</strong>, so a single tool can attempt to kill dozens of different security products. In the RansomHub EDRKillShifter case, researchers noted it could disable <em>“an enormous range of EDR tools”</em>, from mainstream AV engines to top EDR suites<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=A%20recent%20analysis%20has%20uncovered,software%20on%20compromised%20systems">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Takeaway%3A%20Threat%20actors%20are%20getting,defenses%20without%20raising%20an%20eyebrow">halcyon.ai</a>. Once the kernel malware is active, it effectively bypasses user-mode protections like self-defense, process hooking, or code injection prevention – even <strong>protected processes (PPL)</strong> can be terminated or manipulated via the exploit. In short, <strong>no vendor is immune</strong> if the specific vulnerable driver isn’t blocked: as one report put it, <em>“They can shut down your security tools – even those fancy EDR systems you paid top dollar for”</em><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=your%20systems,defenses%20without%20raising%20an%20eyebrow">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Once%20they%27re%20in%2C%20it%27s%20game,the%20door%20wide%20open%20for">halcyon.ai</a>. Vendors have had to react by maintaining blocklists of bad drivers and adding behavior detections for such attacks (discussed later in mitigations).</p>
<p><strong>Mitigations by vendors –</strong> To combat BYOVD, security vendors and OS providers are employing multiple strategies. <strong>Microsoft</strong> maintains a <strong>Windows Vulnerable Driver Blocklist</strong> (used in Windows Defender Application Control and via features like HVCI) to prevent known bad drivers from loading. After the TrueSight.sys campaign was revealed, Microsoft updated this blocklist in December 2024 to include all discovered variants of that driver<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=variants.%20,driver%20exploited%20in%20this%20campaign">research.checkpoint.com</a>. EDR vendors like <strong>ESET</strong> classify tools used in these attacks as <em>“potentially unsafe applications”</em> and will detect or block vulnerable drivers being loadedfile-4pcvlwhk3myukez4vihgen. For instance, ESET’s rules can flag events such as a <strong>“Loaded Driver from Uncommon Location”</strong> or <strong>“Loaded Known Vulnerable Driver”</strong>, alerting defenders if malware tries to install an out-of-place driver on an endpointfile-4pcvlwhk3myukez4vihgen. The key for defenders is to ensure these protective features (e.g. driver blocklists, advanced memory/behavior monitoring) are enabled, as BYOVD remains one of the most potent EDR evasion techniques to date.</p>
<h2 id="dll-hijacking-and-side-loading--subverting-trust-to-inject-malicious-code"><strong>DLL Hijacking and Side-Loading – Subverting Trust to Inject Malicious Code</strong><a hidden class="anchor" aria-hidden="true" href="#dll-hijacking-and-side-loading--subverting-trust-to-inject-malicious-code">#</a></h2>
<p>Another class of EDR evasion involves <strong>DLL hijacking</strong> (a.k.a. DLL side-loading or proxying). In these attacks, adversaries take advantage of how applications load libraries, either by exploiting <strong>vulnerable search paths</strong> or by <strong>misusing a trusted signed binary</strong> to load a malicious DLL. The ultimate goal is to <strong>execute attacker code under the guise of a legitimate process</strong>, often with elevated privileges or within a security process itself, thereby evading detection or actively disrupting the security tool.</p>
<p><strong>Mechanics –</strong> Windows applications often load DLLs by searching through a sequence of directories. If an application does not securely specify the path or if it looks in its “current directory” first, an attacker can plant a <strong>malicious DLL with the same name</strong> in a directory that gets loaded instead of the real one<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a>. This is classical DLL hijacking. Alternatively, some malware uses a <strong>signed, trusted binary (“LOLBin”)</strong> that is known to load a particular DLL – the attacker places their malicious DLL in the expected location so that when the signed EXE runs, it will inadvertently load the attacker’s code. The result is malicious code running inside a process that may be <strong>whitelisted or trusted by security controls</strong>.</p>
<p><strong>ESET case – ToddyCat’s DLL Proxying:</strong> A prime example of DLL hijacking to target an AV itself was uncovered in 2024 involving the <strong>ToddyCat APT</strong> (an espionage group). Kaspersky reported that ToddyCat found a vulnerability in <strong>ESET’s command-line scanner (ecls.exe)</strong> where the program insecurely tried to load <strong><code>version.dll</code></strong> from its working directory before the system path<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a>. The attackers dropped a malicious DLL (named <code>version.dll</code>) alongside the ESET scanner binary. When ESET’s tool was executed (likely by the attackers themselves or via some scheduled task), it <strong>loaded the malicious DLL</strong> instead of the legitimate Windows <code>version.dll</code><a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a>. This <strong>gave the malware code (a payload dubbed “TCESB”) the same privileges and trust as the ESET scanner</strong> process. The TCESB DLL, once loaded in the context of ESET’s antivirus process, went on to <strong>modify kernel structures to disable security notifications</strong> – for example, turning off callbacks that report process creation or module loading events to security software<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=The%20strings%20are%20not%20obfuscated,system%20or%20a%20load%20event">securelist.com</a>. In essence, ToddyCat hijacked ESET’s own process to <strong>create a blind spot</strong> in which it could operate undetected. This was such a serious issue that it was assigned <strong>CVE-2024-11859</strong>, and ESET issued a patch in January 2025 to fix the DLL load behavior in their software<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>.</p>
<p><strong>LockBit case – Living off the Land:</strong> Ransomware actors have also used side-loading with <strong>Windows’ own security binaries</strong>. In mid-2022, SentinelOne researchers observed a LockBit affiliate abusing the <strong>Microsoft Defender command-line tool, <code>MpCmdRun.exe</code>](<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads</a>)</strong>[<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>. They paired this legitimate Defender executable with a fake DLL (<code>MpClient.dll</code>). When <code>MpCmdRun.exe</code> was run (explicitly by the attacker), it <em>decrypts and loads</em> the malicious DLL – in this case, the DLL contained shellcode to inject a <strong>Cobalt Strike Beacon</strong> into memory<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a><a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=abusing%20the%20Windows%20Defender%20command,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>. The beauty of this method for the attacker is that <strong>Defender’s own binary was used to execute malicious code</strong>, likely bypassing certain application control or heuristic checks, since a Microsoft-signed binary was performing the action. From the EDR’s point of view, it might look like Windows Defender’s service was doing some routine work, whereas in reality it had been hijacked to launch the attacker&rsquo;s implant<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=abusing%20the%20Windows%20Defender%20command,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a><a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=mpclient,log%20Encrypted%20Cobalt%20Strike%20payload">sentinelone.com</a>.</p>
<p><strong>Other instances –</strong> DLL side-loading is a long-standing technique especially common among state-sponsored groups. While not all instances directly disable EDR, they help malware to <strong>blend into trusted processes</strong>. For example, other ransomware families have side-loaded rogue DLLs via tools like <strong>VMware utilities, Microsoft Sysinternals tools, or outdated software installers</strong> as a way to bypass behavior monitoring<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=SentinelLabs%20reported%20on%20LockBit%203,to%20side%20load%20%20105">sentinelone.com</a><a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=in%20April%2C%20SentinelLabs%20reported%20on,to%20side%20load%20%20105">sentinelone.com</a>. The key distinction in the EDR bypass context is whether the side-loading is used <strong>to impair the security tool</strong> or simply to stealthily run malware. In the ESET/ToddyCat case, it was explicitly to <em>impair ESET’s protection</em>. In many other cases (LockBit’s included), side-loading is used more to <strong>evade detection</strong> (running code in a trusted host process) rather than to outright kill the EDR. However, both goals are related – by running inside a trusted process, the malicious code can often avoid scrutiny or operate in an environment where the EDR’s hooks are ineffective, thereby effectively <strong>bypassing the endpoint defense</strong>.</p>
<p><strong>Mitigations –</strong> Preventing DLL hijacking requires both vendor action and defensive monitoring. Software vendors must ensure their applications <strong>don’t load insecure DLL paths</strong> (e.g., always load system DLLs from system directories or use safe functions). In the ToddyCat incident, ESET’s prompt patch closed the hole by changing how ecls.exe loads <code>version.dll</code><a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>. From the defender side, enabling features like <strong>Microsoft’s Attack Surface Reduction (ASR) rules</strong> can block or flag unusual side-loading (for instance, Microsoft Defender has rules to prevent unsigned DLLs from loading into sensitive processes). EDR solutions themselves can monitor for known side-loading patterns – e.g., a signed tool loading an unexpected DLL from a temp folder. In practice, defenders should watch for <strong>legitimate processes being launched from abnormal directories or alongside unexpected DLL files</strong>, as this often indicates a side-load setup. In our LockBit example, seeing <code>MpCmdRun.exe</code> execute from an atypical path or spawning network connections could be a clue to a side-loading attack<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=http%3A%2F%2F45.32.108%5B.%5D54%3A443%2FMpCmdRun.exe%20">sentinelone.com</a>.</p>
<h2 id="service-abuse--tampering--abusing-system-tools-and-modes-to-disable-protection"><strong>Service Abuse &amp; Tampering – Abusing System Tools and Modes to Disable Protection</strong><a hidden class="anchor" aria-hidden="true" href="#service-abuse--tampering--abusing-system-tools-and-modes-to-disable-protection">#</a></h2>
<p>This category encompasses a variety of tricks where attackers manipulate the operating system or the security software’s service control mechanisms to <strong>turn off or evade EDR/AV</strong>, without necessarily exploiting code vulnerabilities. Some of these techniques date back years but have evolved or re-emerged in recent attacks.</p>
<p><strong>Safe Mode (reboot abuse) –</strong> Many endpoint agents do not run in Windows Safe Mode (a diagnostic mode where only basic drivers load). Ransomware groups have capitalized on this by <strong>force-rebooting infected machines into Safe Mode</strong> to perform malicious actions without the security software running<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a>. The <strong>Snatch</strong> ransomware first popularized this approach around late 2019: it installed itself as a service with a command to reboot into Safe Mode, and added a registry “Run” key so that <em>its</em> process (the encryptor) would start in Safe Mode on boot<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a><a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=investigate%20and%20remediate%20a%20ransomware,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a>. Once the system restarted in that minimal environment, Snatch began encryption of files while the anti-malware services were inactive, thereby bypassing protection<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a>. This technique continued to appear in subsequent years – for instance, in 2023 <strong>AvosLocker</strong> was observed using a similar Safe Mode encryption step<a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a>. By doing this, the attackers negate agent self-defense (since the agent never starts) and can even tamper with or remove security software files in Safe Mode. The only constraint is that the attackers must have sufficient privileges to configure the auto-reboot and service, which by the later stages of an attack they often do.</p>
<p><strong>Abusing OS tools (sc, net, etc.) –</strong> With administrative access, an attacker can attempt direct tampering: for example, using the Service Control Manager (<code>sc.exe</code>) or <code>net stop</code> commands to stop security services, or modifying the Windows Registry to prevent services from starting. Most modern EDRs have <strong>self-protection to block such actions</strong> – e.g., they require an uninstall password or detect if their service is being tampered with – but these protections can sometimes be subverted. Some attackers use <strong>PowerShell scripts or WMI</strong> to try and disable security features (like turning off Microsoft Defender’s real-time monitoring via registry keys or the PowerShell <code>Set-MpPreference</code> cmdlets). In corporate environments, <strong>Microsoft Defender’s Tamper Protection</strong> (when enabled) will lock those settings, but not all organizations had this enabled by default in earlier years. Thus, we saw malware (and Cobalt Strike playbooks) that included steps to <em>attempt</em> Defender disabling. The success of these attempts varies, but the prevalence of such scripts shows that <strong>attackers probe for misconfigurations</strong> where protections might be turned off or weakened.</p>
<p><strong>Exploiting agent vulnerabilities –</strong> Occasionally, the security agents themselves have bugs that attackers can exploit to disable them. The CrowdStrike Falcon case in 2023 is an illustrative example. Although details were not fully public, it was described as a <strong>logical flaw that allowed the suspension of Falcon’s processes</strong>file-4pcvlwhk3myukez4vihgen. This suggests that if an attacker issued certain commands or manipulated the agent in a specific way (after gaining privileges), they could pause or crash the Falcon sensor. CrowdStrike presumably patched this quicklyfile-4pcvlwhk3myukez4vihgen, but it highlights that even top-tier EDR platforms can have edge-case vulnerabilities that attackers will seize if disclosed. Another example is a 2022 vulnerability in Trend Micro Apex One that allowed local privilege escalation and could be leveraged to kill the product, though such cases are less common compared to the above techniques.</p>
<p><strong>Living-off-the-land abuse –</strong> Beyond Safe Mode, attackers use legitimate administrative tools or modes of the OS to evade security. One such trick is using <strong>“System Repair” or Recovery Environments</strong>. For instance, an attacker might boot the machine into a Windows Recovery Environment or use tools like <strong>MSConfig to set a minimal boot</strong>, then encrypt files when the EDR is not loaded. Some ransomware (e.g., <strong>Black Basta</strong> in 2022) reportedly used strategies involving booting in a minimal state to bypass controls (similar in spirit to Safe Mode). Attackers have also misused <strong>HyperVisor or VMs</strong> (RagnarLocker famously ran the ransomware inside a VirtualBox VM on the host in 2020 to evade host-based EDR). While that crosses into a different category (virtualization-based evasion), it shows the creativity in abusing system features to subvert security software.</p>
<p><strong>Real-world impact –</strong> Service abuse techniques tend to be noisy (reboots, service stoppage commands, etc.), but when successful, they lead to <strong>complete defense bypass</strong>. In incidents where Safe Mode was used, organizations often found out only after the fact – the endpoint would drop offline from the EDR console, then come back but with all data encrypted. The Snatch attacks prompted warnings in late 2019/2020 about this tactic<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=Sophos%20analysts%20first%20encountered%20the,is%20a%20newly%20added%20feature">news.sophos.com</a>, and by 2023 AvosLocker’s use reaffirmed that it was still effective against many vendors<a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a>. Essentially, any scenario where attackers can <strong>temporarily or permanently shut down the security agents</strong> is game over for that endpoint’s protection. It’s a stark reminder that <em>anti-tampering features must be robust</em>. If a product can be easily disabled via registry or service control by admin-level malware, then that malware will do exactly that (many post-exploitation kits will attempt it). The arms race here is between attacker knowledge of these “tricks” and vendor mitigations to prevent or detect them.</p>
<p><strong>Mitigations –</strong> Defenders can take several steps to mitigate service abuse strategies. Enabling EDR/AV <strong>tamper-protection features</strong> is critical – for example, Microsoft Defender’s Tamper Protection (to block registry/service changes), or similar features in other EDRs that prevent unauthorized unloading. Some EDR products offer a <em>“password required to boot in Safe Mode”</em> or the ability to send an alert if an endpoint goes into Safe Mode unexpectedly. Where available, these should be enabled. Also, monitoring for sudden <strong>stopping of security services or drivers</strong> can detect an attack in progress – many EDR management consoles will flag if an agent stops communicating. From an IT policy perspective, <strong>restricting local administrator accounts</strong> and using <strong>credential tiering</strong> can make it harder for attackers to reach the point of attempting these actions. Ultimately, defenders should treat an unexpected security agent shutdown or a host going into Safe Mode as <strong>signs of potential compromise</strong> and respond immediately.</p>
<hr>
<p>The following sections provide comparative summaries in table form, consolidating how these evasion techniques map to different vendors, the timeline of their emergence, and the mitigation approaches that can counter them.</p>
<h3 id="techniques-vs-affected-vendors-20202025"><strong>Techniques vs. Affected Vendors (2020–2025)</strong><a hidden class="anchor" aria-hidden="true" href="#techniques-vs-affected-vendors-20202025">#</a></h3>
<p>The table below summarizes each evasion technique category with examples of security vendors or products that were affected or targeted. This illustrates that no vendor is completely immune – the techniques are often broadly applicable unless specific safeguards are in place.</p>
<table>
  <thead>
      <tr>
          <th>Evasion Technique</th>
          <th>Affected Endpoint Security Vendors (Examples)</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>BYOI – Installer Abuse</strong></td>
          <td><strong>SentinelOne:</strong> Agent upgrade process exploited (Babuk ransomware, 2025)<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. (SentinelOne issued fix via “Online Authorization” feature)<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=SentinelOne%20privately%20issued%20mitigation%20guidance,guidance%20issued%2C%20clients%20remained%20vulnerable">halcyon.ai</a>. <strong>Also Potentially:</strong> Other EDRs with local installers (e.g. researchers showed Forcepoint and others could be similarly bypassed by reinstall). This is a design issue that could affect any vendor not requiring auth for reinstalls.</td>
      </tr>
      <tr>
          <td><strong>BYOVD – Vulnerable Drivers</strong></td>
          <td><strong>Multiple Vendors:</strong> BYOVD tools terminate processes of <em>all major EDR/AV vendors</em> if present. For example, <strong>Sophos, CrowdStrike, SentinelOne, Carbon Black, Microsoft Defender</strong>, etc., have all been targeted by driver-based EDR “killers”<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=your%20systems,defenses%20without%20raising%20an%20eyebrow">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Once%20they%27re%20in%2C%20it%27s%20game,the%20door%20wide%20open%20for">halcyon.ai</a>. <strong>BlackByte (2022):</strong> Bypassed EDRs by abusing MSI Afterburner’s driver (CVE-2019-16098)<a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>. <strong>RansomHub EDRKillShifter (2024):</strong> Used a vulnerable driver to kill dozens of EDR/AV processes (observed killing SentinelOne, Microsoft, Trend Micro, etc. among others)<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=A%20recent%20analysis%20has%20uncovered,software%20on%20compromised%20systems">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=This%20tool%20utilizes%20the%20Bring,unobstructed%20execution%20of%20ransomware%20encryptors">halcyon.ai</a>. <strong>LockBit/Medusa (2023):</strong> Used Process Explorer driver to disable EDR (affected whichever EDR was on victim, reported cases with different EDRs)<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a>.</td>
      </tr>
      <tr>
          <td><strong>DLL Hijacking / Side-Loading</strong></td>
          <td><strong>ESET:</strong> Vulnerability in ESET’s command-line scanner allowed DLL hijack (ToddyCat APT, 2024) – malicious DLL loaded into ESET process to disable it<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a>. Patched by ESET (CVE-2024-11859)<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>. <strong>Microsoft Defender:</strong> LockBit ransomware affiliate abused Defender’s <code>MpCmdRun.exe</code> to side-load a malicious DLL, enabling malware execution under a Microsoft-signed process<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>. <strong>Others:</strong> Many vendors’ products (and other trusted software) have been used for DLL side-loading by attackers (e.g. TrendMicro, Kaspersky, Sophos – via their updaters or ancillary tools, in various APT cases). The technique is not vendor-specific: it exploits how Windows loads DLLs and trusts signed binaries.</td>
      </tr>
      <tr>
          <td><strong>Service Abuse &amp; Tampering</strong></td>
          <td><strong>CrowdStrike:</strong> Falcon EDR agent vulnerability (disclosed 2023) allowed attackers to suspend/disable the sensor via a flaw in the service, undermining protectionfile-4pcvlwhk3myukez4vihgen. Patched by CrowdStrike upon discoveryfile-4pcvlwhk3myukez4vihgen. <strong>All EDRs (Safe Mode):</strong> <em>Any</em> EDR will be ineffective in Safe Mode unless specifically designed otherwise. Ransomware like Snatch (2020) and AvosLocker (2023) abused this by rebooting machines into Safe Mode to encrypt files while Sophos, Defender, etc., were inactive<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a><a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a>. This impacts <strong>all vendors</strong> who rely on normal mode drivers. <strong>Microsoft Defender:</strong> Attackers often attempt to use PowerShell or registry tweaks to turn off Defender’s real-time protection (if Tamper Protection is off). Without Tamper Protection, local admin malware can disable Defender via OS settings (seen in many malware playbooks 2020–2022). Microsoft’s Tamper Protection (on by default in enterprise since late 2019) mitigates this, but not all orgs had it enabled initially. <strong>Sophos EDR:</strong> Like others, if malware attains admin rights, it could try to unload or kill Sophos services. Sophos has strong self-defense, but incidents like ransomware “kill lists” include Sophos processes to terminate. (No known public exploit, but e.g. LockBit’s built-in process killer lists <code>SophosSAVService.exe</code>, etc.) In general, service-stop attempts hit all major vendors; success depends on each product’s tamper protection strength.</td>
      </tr>
  </tbody>
</table>
<h3 id="timeline-of-evasion-techniques-emergence-20202025"><strong>Timeline of Evasion Techniques Emergence (2020–2025)</strong><a hidden class="anchor" aria-hidden="true" href="#timeline-of-evasion-techniques-emergence-20202025">#</a></h3>
<p>This timeline highlights when major evasion techniques or campaigns were first observed and how they evolved between 2020 and 2025:</p>
<table>
  <thead>
      <tr>
          <th>Timeframe</th>
          <th>Evasion Technique &amp; Notable Incident</th>
          <th>Details and Impact</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Late 2019 – 2020</strong></td>
          <td><em>Safe Mode Ransomware (Snatch)</em> <a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a> <em>Service Abuse</em></td>
          <td>Snatch ransomware reboots Windows into <strong>Safe Mode</strong> to encrypt files without EDR/AV running<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a>. First seen Oct 2019, continued in 2020. Highlighted a design gap: most security tools <strong>do not load in Safe Mode</strong>, allowing malware free rein. Sophos reported this as a novel technique to bypass protection<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=been%20investigating%20an%20ongoing%20series,won%E2%80%99t%20run%20in%20Safe%20Mode">news.sophos.com</a>, prompting industry awareness.</td>
      </tr>
      <tr>
          <td><strong>2021</strong></td>
          <td><em>Open-Source EDR Killer (Backstab)</em> <a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20method%20of%20abusing%20the,was%20used%20for%20malicious%20purposes">news.sophos.com</a> <em>BYOVD</em></td>
          <td>The <strong>Backstab</strong> tool was released (June 2021) demonstrating a BYOVD attack using Process Explorer’s driver<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20method%20of%20abusing%20the,was%20used%20for%20malicious%20purposes">news.sophos.com</a>. This marked one of the first publicly available EDR-killer PoCs, foreshadowing later ransomware adoption. Attackers begin experimenting with driver-based kills, though in 2021 it was mostly seen in testing/red-team contexts.</td>
      </tr>
      <tr>
          <td><strong>2022 (Q3)</strong></td>
          <td><em>BlackByte’s BYOVD Attack</em> <a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a> <em>BYOVD</em></td>
          <td><strong>BlackByte ransomware</strong> operators deploy a <em>signed vulnerable driver</em> (MSI Afterburner’s RTCore64.sys) during intrusions to disable EDR<a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>. (CVE-2019-16098 exploit). This is one of the first high-profile ransomware BYOVD cases (Oct 2022) and is publicized by Sophos and media. It showed that criminal groups had adopted BYOVD to <strong>target the kernel interfaces of EDR products</strong><a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>.</td>
      </tr>
      <tr>
          <td><strong>2022 (Q4)</strong></td>
          <td><em>Ransomware EDR “Killers” Appear</em> <a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=This%20is%20not%20the%20first,drivers%20to%20disable%20EDR%20products">news.sophos.com</a> <em>BYOVD</em></td>
          <td><strong>Multiple ransomware groups start using custom-built or stolen drivers</strong> to kill EDR/AV processes. In late 2022, Sophos, Microsoft, Mandiant, and others reported on attackers using malicious drivers (some with stolen certificates) to bypass security<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=This%20is%20not%20the%20first,drivers%20to%20disable%20EDR%20products">news.sophos.com</a>. For example, a driver dubbed <strong>“POORTRY”</strong> (detected in a BlackCat incident) and others were noted. This wave led to vendor collab with Microsoft to revoke certificates and update blocklists.</td>
      </tr>
      <tr>
          <td><strong>2022 (Jul)</strong></td>
          <td><em>LockBit Sideloads Defender</em> <a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a> <em>DLL Side-Loading</em></td>
          <td>A <strong>LockBit 3.0 affiliate</strong> was observed using Windows Defender’s <code>MpCmdRun.exe</code> to side-load a malicious DLL and decrypt Cobalt Strike beacon<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=In%20this%20post%2C%20we%20follow,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>. (Incident reported July 2022). This innovative abuse of a <strong>security tool as a loader</strong> signaled that threat actors were exploring <em>living-off-the-land</em> within security processes. It didn’t disable EDR directly, but it evaded detection by using a trusted binary.</td>
      </tr>
      <tr>
          <td><strong>2023 (Jan–Feb)</strong></td>
          <td><em>AuKill in Ransomware Attacks</em> <a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a> <em>BYOVD</em></td>
          <td>The <strong>AuKill</strong> malware (BYOVD tool using an outdated Process Explorer driver) was used in at least three cases: deploying <strong>Medusa Locker</strong> and <strong>LockBit</strong> ransomware after disabling the EDR in early 2023<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=The%20tool%20was%20used%20during,prior%20to%20deploying%20Lockbit%20ransomware">news.sophos.com</a>. This showed the <strong>commoditization of EDR-killers</strong> – affiliates in different RaaS franchises obtaining the same tool. Sophos published details in April 2023, emphasizing rising driver-based attacks<a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/#:~:text=Over%20the%20past%20several%20months%2C,ransomware%20on%20the%20target%20system">news.sophos.com</a>.</td>
      </tr>
      <tr>
          <td><strong>2023 (Mid)</strong></td>
          <td><em>CrowdStrike Falcon Vulnerability</em> file-4pcvlwhk3myukez4vihgen <em>Service Flaw</em></td>
          <td>A vulnerability in <strong>CrowdStrike Falcon (disclosed mid-2023)</strong> allowed attackers with admin access to <strong>suspend or disrupt the Falcon sensor process</strong>file-4pcvlwhk3myukez4vihgen. Although details were scarce (likely a bug rather than an intended design), it underscored that even leading EDRs had to patch logic flaws to maintain self-protection. CrowdStrike released fixes; no widespread abuse by malware was reported publicly, but POCs might have existed.</td>
      </tr>
      <tr>
          <td><strong>2023 (Late)</strong></td>
          <td><em>Safe Mode Redux (AvosLocker)</em> <a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a> <em>Service Abuse</em></td>
          <td>FBI/CISA advisories in 2023 noted <strong>AvosLocker</strong> ransomware using the Safe Mode trick to disable security<a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a>. This confirmed that newer ransomware strains were adopting the tactic pioneered by Snatch. By now, multiple families (Snatch, BlackBasta, AvosLocker) have used some variation of rebooting to bypass EDR, indicating it remained a viable evasion method.</td>
      </tr>
      <tr>
          <td><strong>2024 (Mid)</strong></td>
          <td><em>RansomHub’s EDRKillShifter Launch</em> <a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a> <em>BYOVD</em></td>
          <td>The <strong>RansomHub gang</strong> introduced their custom EDR killer <em>EDRKillShifter</em> around May 2024<a href="https://www.welivesecurity.com/en/eset-research/shifting-sands-ransomhub-edrkillshifter/#:~:text=Expanding%20the%20arsenal%20%E2%80%93%20EDRKillShifter">welivesecurity.com</a><a href="https://www.welivesecurity.com/en/eset-research/shifting-sands-ransomhub-edrkillshifter/#:~:text=On%20May%208,type%20of%20malware%20designed%20to">welivesecurity.com</a>. Throughout 2024, this tool was proliferating in attacks, and by August 2024 it was firmly associated with RansomHub operations<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a>. Within weeks, affiliates began using it in other ransomware (Play, BianLian, etc.), indicating cross-pollination<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Notably%2C%20EDRKillShifter%2C%20initially%20associated%20with,Play%2C%20The%20Hacker%20News%20reports">halcyon.ai</a>. This period marked the peak of BYOVD tool usage in ransomware campaigns, with thousands of driver variants in play<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=stage%20malicious%20samples%20used%20to,latest%20versions%20of%20Windows%20OS">research.checkpoint.com</a>.</td>
      </tr>
      <tr>
          <td><strong>2024 (Late)</strong></td>
          <td><em>ToddyCat ESET DLL Hijack</em> <a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a> <em>DLL Hijacking</em></td>
          <td>In late 2024, Kaspersky discovered ToddyCat APT using a DLL hijack in <strong>ESET software</strong> to stealthily disable its protections<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a>. ESET’s patch and advisory came out in Jan 2025<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>. This was a rare instance of APT-style evasion hitting a security vendor directly via vulnerability. It highlighted the need for vendors to audit their loading mechanisms.</td>
      </tr>
      <tr>
          <td><strong>2025 (Q1)</strong></td>
          <td><em>SentinelOne BYOI (Babuk)</em> <a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=The%20attack%20was%20discovered%20by,ransomware%20attack%20earlier%20this%20year">bleepingcomputer.com</a><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a> <em>BYOI</em></td>
          <td>The <strong>“Bring Your Own Installer” technique</strong> was publicly unveiled in early 2025 when Babuk ransomware actors bypassed SentinelOne EDR by abusing its installer<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a>. Aon/Stroz Friedberg’s report (Jan 2025) and subsequent coverage (May 2025) detailed how the attackers exploited the upgrade process to drop the agent, then encrypted the system<a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=The%20attack%20was%20discovered%20by,ransomware%20attack%20earlier%20this%20year">bleepingcomputer.com</a><a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=By%20forcefully%20stopping%20the%20install,devices%20unprotected%2C%20Bleeping%20Computer%20Reports">halcyon.ai</a>. SentinelOne’s response and the industry discussion around BYOI in 2025 represent the latest evolution of endpoint evasion tactics.</td>
      </tr>
  </tbody>
</table>
<h3 id="mitigation-approaches-and-defensive-measures"><strong>Mitigation Approaches and Defensive Measures</strong><a hidden class="anchor" aria-hidden="true" href="#mitigation-approaches-and-defensive-measures">#</a></h3>
<p>Finally, we compare the <strong>mitigation strategies</strong> relevant to each evasion category. These approaches combine vendor-side fixes, configuration hardening, and detection techniques that defenders should employ:</p>
<table>
  <thead>
      <tr>
          <th>Evasion Technique</th>
          <th>Mitigation Strategies</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Installer Abuse (BYOI)</strong></td>
          <td><strong>Harden EDR Upgrade/Uninstall:</strong> Use solutions that offer <strong>centralized authorization</strong> for agent uninstall or upgrade (e.g., SentinelOne’s “Online Authorization” toggle)<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=SentinelOne%20privately%20issued%20mitigation%20guidance,guidance%20issued%2C%20clients%20remained%20vulnerable">halcyon.ai</a><a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=SentinelOne%20recommends%20customers%20enable%20the%C2%A0,default%2C%20to%20mitigate%20this%20attack">bleepingcomputer.com</a>. Ensure this is enabled so that local reinstall attempts cannot proceed without approval. <strong>Maintain Anti-Tamper Controls:</strong> Make sure the EDR’s self-protection/tamper prevention is fully enabled and updated – vendors should patch flaws in upgrade processes quickly. Administrators can also monitor for unexpected installer executions or multiple version installer files on endpointsfile-uzvb8akgpxzutg7wga8ks6 (as seen in the Babuk case).</td>
      </tr>
      <tr>
          <td><strong>Vulnerable Drivers (BYOVD)</strong></td>
          <td><strong>Driver Blocklisting:</strong> Enable Microsoft’s built-in <strong>Vulnerable Driver Blocklist</strong> (available via Windows Defender Application Control or Core Isolation settings) to prevent known bad drivers from loading<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=,the%20attackers%20deliberately%20generated%20multiple">research.checkpoint.com</a><a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=variants.%20,driver%20exploited%20in%20this%20campaign">research.checkpoint.com</a>. Keep this list updated (Microsoft updates it periodically for new threats). <strong>EDR Kernel-mode Monitoring:</strong> Use EDR solutions that can detect or block malicious driver behavior. For example, EDRs like ESET flag the loading of drivers from unusual locations or known vulnerable driversfile-4pcvlwhk3myukez4vihgen. This can stop attacks where new, unsigned drivers are introduced. <strong>Least Privilege &amp; Device Control:</strong> Limit administrative privileges on endpoints so that installing drivers is more difficult for attackers. Consider using Group Policy or device control software to <strong>prevent unapproved driver installation</strong> altogether. <strong>Rapid Patching of OS and Drivers:</strong> Ensure that legitimate drivers on systems are updated to patched versions. Many BYOVD attacks target drivers (e.g., old anti-cheat or overclocking tools) that might be sitting on disk – remove or update those to eliminate the vulnerable versions.</td>
      </tr>
      <tr>
          <td><strong>DLL Hijacking / Side-Loading</strong></td>
          <td><strong>Apply Vendor Patches:</strong> Keep endpoint security software up to date. Vendors like ESET issued patches for DLL load vulns (e.g., CVE-2024-11859) – applying these closes the door on known hijack opportunities<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>. <strong>Secure Configuration:</strong> Wherever possible, enable options like <strong>Protected Process Light (PPL)</strong> for EDR processes (many AV/EDR run as PPL by default now, which can prevent unsigned code injection). Also consider Windows Defender’s <strong>ASR rules</strong> that block suspicious behaviors (there’s a rule to prevent Office apps or others from creating child processes, which can mitigate some side-load scenarios). <strong>Monitoring and Hunting:</strong> Watch for anomalous DLL loads. For instance, if a legitimate process loads a DLL from a Temp directory or a user profile path, that’s a red flag. Use EDR telemetry to detect if known LolBins (e.g., <code>rundll32.exe</code>, <code>regsvr32.exe</code>, or even <code>MpCmdRun.exe</code>) are loading unusual modules<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=abusing%20the%20Windows%20Defender%20command,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a><a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=mpclient,log%20Encrypted%20Cobalt%20Strike%20payload">sentinelone.com</a>. Creating alert rules for these conditions can catch side-loading attempts early.</td>
      </tr>
      <tr>
          <td><strong>Service Abuse &amp; Tampering</strong></td>
          <td><strong>Enable Tamper Protection:</strong> This is critical. For example, ensure <strong>Microsoft Defender’s Tamper Protection</strong> is on (to block registry/service changes) and similar features in other EDRs. This stops easy service shutdown or settings tweaks by malware. <strong>Secure Boot/Safe Mode Protections:</strong> If your EDR offers a feature to <strong>protect in Safe Mode or BIOS</strong> (few do), use it. At a minimum, set a BIOS/firmware password and enable <strong>BitLocker</strong> with a TPM – this can prevent attackers from booting into alternate modes or using bootloaders without credentials. (While not foolproof if attacker already admin with device in on-state, it adds hurdles for cold reboots into other modes.) <strong>Account and Privilege Controls:</strong> Use least-privilege for service accounts. Domain admins or IT admins should use separate accounts for day-to-day work – this helps prevent attackers from easily using high-privilege accounts to disable security. <strong>Anomaly Detection:</strong> Configure alerts for when security services stop or unexpectedly <strong>enter a disabled state</strong>. EDR management consoles often show agent status – integrate those with SIEM to alert if an agent goes offline or is uninstalled from a host outside of maintenance windows. Also monitor for system reboots into Safe Mode (event logs can reveal if the OS started in Safe Mode). Sniffing out these events gives responders a chance to react before ransomware deployment is complete<a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=Sophos%20analysts%20first%20encountered%20the,is%20a%20newly%20added%20feature">news.sophos.com</a>. <strong>Incident Response Planning:</strong> Develop an IR plan for “EDR disablement” scenarios. For instance, if an endpoint stops checking in, have a playbook to isolate that host at the network level. Assume that a lost agent could mean an active attack – a quick containment can limit damage even if one node was temporarily blinded.</td>
      </tr>
  </tbody>
</table>
<h2 id="defensive-recommendations-for-edr-evasion"><strong>Defensive Recommendations for EDR Evasion</strong><a hidden class="anchor" aria-hidden="true" href="#defensive-recommendations-for-edr-evasion">#</a></h2>
<p>In light of these threats, security teams should adopt a multi-layered defense strategy. Below are <strong>strategic recommendations</strong> to bolster endpoint defenses against these evasion techniques:</p>
<ul>
<li>
<p><strong>Enable and Enforce Anti-Tamper Features:</strong> Turn on tamper-protection in all endpoint security tools (e.g. require admin console authorization or a password for any agent uninstall, stop, or upgrade)<a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/#:~:text=SentinelOne%20recommends%20customers%20enable%20the%C2%A0,default%2C%20to%20mitigate%20this%20attack">bleepingcomputer.com</a>. Verify that features like Microsoft Defender’s Tamper Protection are enabled enterprise-wide. These measures ensure malware can’t simply shut off protections via standard OS interfaces.</p>
</li>
<li>
<p><strong>Adopt Driver Load Controls:</strong> Implement Microsoft’s <strong>Driver Blocklist</strong> (and enable Hypervisor-Protected Code Integrity if possible) to block known vulnerable drivers from executing<a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/#:~:text=,the%20attackers%20deliberately%20generated%20multiple">research.checkpoint.com</a><a href="https://asec.ahnlab.com/en/86881/#:~:text=Microsoft%20has%20added%20all%20versions,0%20version">asec.ahnlab.com</a>. Consider using EDR solutions or OS controls that <strong>block kernel drivers</strong> which are not explicitly allowed. Regularly update these controls as new BYOVD threats emerge.</p>
</li>
<li>
<p><strong>Harden Endpoint Agent Configurations:</strong> Use the most secure settings your EDR offers. For example, enable <em>“Online/Cloud authorization”</em> for agent updates (as in SentinelOne)<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=SentinelOne%20privately%20issued%20mitigation%20guidance,guidance%20issued%2C%20clients%20remained%20vulnerable">halcyon.ai</a>, disable any local admin override capabilities, and ensure agents run with highest protection modes (many have a hardened mode for critical systems). Remove or password-protect any safe boot or recovery options that could be misused.</p>
</li>
<li>
<p><strong>Stay Current with Patches (EDR &amp; OS):</strong> Keep your endpoint security software <strong>up-to-date with the latest versions</strong>. Vendors often release silent updates to address vulnerabilities (like the ESET DLL hijack fix)<a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=compiled%20a%20report%20with%20a,in%20an%20ESET%20security%20advisory">securelist.com</a>. Apply these quickly. Equally, update OS components – for instance, apply Windows updates that improve driver blocking or Safe Mode protections. Timely patching closes known holes before attackers leverage them.</p>
</li>
<li>
<p><strong>Limit Administrator Privileges:</strong> Employ least privilege principles. Users should not have local admin rights on workstations by default. Admin accounts should be tightly controlled (use Privileged Access Management). By reducing the availability of admin-level access, you diminish the attacker’s ability to perform actions like driver installation or service manipulation<a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=Keep%20those%20drivers%20updated%E2%80%94don%27t%20let,these%20kinds%20of%20shady%20behaviors">halcyon.ai</a>. Even if malware runs, it might lack the privileges to disable the EDR.</p>
</li>
<li>
<p><strong>Monitor for Evasion Indicators:</strong> Strengthen your detection engineering to catch signs of EDR evasion. Set up alerts for <strong>mass process termination events</strong>, especially if they include security processes (could indicate a driver attack)<a href="https://asec.ahnlab.com/en/86881/#:~:text=and%20loaded%20additional%20payloads%20using,systems%20to%20neutralize%20security%20defenses">asec.ahnlab.com</a>. Monitor for unusual child processes of security tools or utilities (e.g., Defender’s CLI spawning unknown processes)<a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/#:~:text=abusing%20the%20Windows%20Defender%20command,and%20load%20Cobalt%20Strike%20payloads">sentinelone.com</a>. Log and alert on any driver installations on endpoints that are not part of normal updates. Also, treat any <strong>EDR agent going offline or entering “disabled” state as a potential incident</strong>, and investigate immediately.</p>
</li>
<li>
<p><strong>Improve Resilience and Response:</strong> Since no prevention is 100% foolproof, focus on resilience. For example, ensure you have <strong>endpoint isolation capabilities</strong> – if an agent reports a tamper event or stops unexpectedly, the SOC can isolate that host via network controls. Invest in endpoint backup/restoration solutions so that even if one layer (EDR) is bypassed, you can recover critical systems quickly. Regularly test your IR plan against scenarios of EDR bypass; incorporate drills where the assumption is “the endpoint agent was neutralized – now what?”.</p>
</li>
<li>
<p><strong>Behavioral Analytics &amp; Anomaly Detection:</strong> Leverage EDR/MDR solutions that use behavioral analytics to spot the outcomes of evasion. For instance, an attacker in Safe Mode still has to reboot the machine – an EDR with user behavior analytics might flag an odd timing reboot or use of <code>bcdedit</code> commands. Similarly, detect abnormal tool usage (like an admin tool launching in an unusual context). Machine learning in EDR can sometimes pick up these oddities even if the initial evasion blinds some telemetry.</p>
</li>
</ul>
<p>In conclusion, <strong>endpoint security evasion techniques have grown more sophisticated</strong> from 2020 through 2025, but a combination of good product configuration, up-to-date threat intelligence, and vigilant monitoring can significantly blunt their impact. Security engineers should work closely with their EDR vendors to deploy available safeguards (e.g., driver blocklists, tamper-proof settings) and ensure that endpoints are not an easy target for these <em>“living off the land”</em> style attacks. Ultimately, awareness and preparation are key: knowing that attackers can and will try to <strong>turn your tools against you</strong> is the first step to making sure they do not succeed<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=Takeaway%3A%20Let%E2%80%99s%20just%20call%20it,your%20system%20thinks%20everything%E2%80%99s%20normal">halcyon.ai</a>.</p>
<p><strong>Sources:</strong> SentinelOne, Sophos, Microsoft, ESET, Kaspersky, Aon Stroz Friedberg case studies and threat research<a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique#:~:text=A%20newly%20discovered%20,attackers%20to%20deploy%20Babuk%20ransomware">halcyon.ai</a><a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks#:~:text=A%20recent%20analysis%20has%20uncovered,software%20on%20compromised%20systems">halcyon.ai</a><a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/#:~:text=scanner%20help,about%20this%20vulnerability%20appeared%20in">securelist.com</a><a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/#:~:text=In%20mid,encrypts%20the%20victims%E2%80%99%20hard%20drives">news.sophos.com</a>, as well as CISA alerts and industry reports from 2020–2025 detailing these evasion techniques<a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/#:~:text=AvosLocker%20employs%20sophisticated%20evasion%20techniques%2C,to%20operate%20in%20this%20mode">attackiq.com</a><a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique#:~:text=In%20a%20blog%20post%20last,extended%20control%20over%20graphic%20cards">techtarget.com</a>. These references underscore the prevalence of such tactics in recent years and the importance of a robust, multi-layered defense strategy.</p>
<h2 id="reference-links--edr-evasion-research20202025"><strong>Reference Links – EDR Evasion Research(2020–2025)</strong><a hidden class="anchor" aria-hidden="true" href="#reference-links--edr-evasion-research20202025">#</a></h2>
<p>Halcyon. (2024, January 10). <em>Ransomware attack bypasses EDR with BYOI technique</em>. Halcyon. <a href="https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique">https://www.halcyon.ai/blog/ransomware-attack-bypasses-edr-with-byoi-technique</a></p>
<p>Halcyon. (2024, April 1). <em>RansomHub’s EDR-Killer shows up in Medusa, BianLian and Play attacks</em>. Halcyon. <a href="https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks">https://www.halcyon.ai/blog/ransomhubs-edr-killer-shows-up-in-medusa-bianlian-and-play-attacks</a></p>
<p>Sophos. (2023, April 19). <em>‘AuKill’ EDR killer malware abuses Process Explorer driver</em>. Sophos News. <a href="https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/">https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/</a></p>
<p>Securelist. (2023, March 21). <em>APT group ToddyCat exploits a vulnerability in ESET for DLL proxying</em>. Securelist. <a href="https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/">https://securelist.com/toddycat-apt-exploits-vulnerability-in-eset-software-for-dll-proxying/116086/</a></p>
<p>SentinelOne. (2023, July 13). <em>Living off Windows Defender: LockBit ransomware sideloads Cobalt Strike through Microsoft Security Tool</em>. SentinelOne. <a href="https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/">https://www.sentinelone.com/blog/living-off-windows-defender-lockbit-ransomware-sideloads-cobalt-strike-through-microsoft-security-tool/</a></p>
<p>Sophos. (2019, December 9). <em>Snatch ransomware reboots PCs into Safe Mode to bypass protection</em>. Sophos News. <a href="https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/">https://news.sophos.com/en-us/2019/12/09/snatch-ransomware-reboots-pcs-into-safe-mode-to-bypass-protection/</a></p>
<p>AttackIQ. (2023, November 1). <em>#StopRansomware: AvosLocker Ransomware</em>. AttackIQ. <a href="https://www.attackiq.com/2023/11/01/avoslocker-ransomware/">https://www.attackiq.com/2023/11/01/avoslocker-ransomware/</a></p>
<p>BleepingComputer. (2024, January 9). <em>New &ldquo;Bring Your Own Installer&rdquo; EDR bypass used in ransomware attack</em>. <a href="https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/">https://www.bleepingcomputer.com/news/security/new-bring-your-own-installer-edr-bypass-used-in-ransomware-attack/</a></p>
<p>Check Point Research. (2025). <em>Silent Killers: Unmasking a large-scale legacy driver exploitation campaign</em>. <a href="https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/">https://research.checkpoint.com/2025/large-scale-exploitation-of-legacy-driver/</a></p>
<p>AhnLab ASEC. (2024). <em>Legacy driver exploitation through bypassing certificate verification</em>. <a href="https://asec.ahnlab.com/en/86881/">https://asec.ahnlab.com/en/86881/</a></p>
<p>Trend Micro. (2022). <em>AvosLocker ransomware variant abuses driver file to disable anti-virus, scans for Log4Shell</em>. Trend Micro Research. <a href="https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html">https://www.trendmicro.com/en_us/research/22/e/avoslocker-ransomware-variant-abuses-driver-file-to-disable-anti-Virus-scans-log4shell.html</a></p>
<p>ESET. (2025). <em>Shifting the sands of RansomHub’s EDRKillShifter</em>. WeLiveSecurity. <a href="https://www.welivesecurity.com/en/eset-research/shifting-sands-ransomhub-edrkillshifter/">https://www.welivesecurity.com/en/eset-research/shifting-sands-ransomhub-edrkillshifter/</a></p>
<p>TechTarget. (2024). <em>BlackByte ransomware uses new EDR evasion technique</em>. <a href="https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique">https://www.techtarget.com/searchsecurity/news/252525965/BlackByte-ransomware-uses-new-EDR-evasion-technique</a></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/en/tags/mind/">Mind</a></li>
      <li><a href="http://localhost:1313/en/tags/edr/">EDR</a></li>
      <li><a href="http://localhost:1313/en/tags/byovd/">BYOVD</a></li>
      <li><a href="http://localhost:1313/en/tags/byoi/">BYOI</a></li>
      <li><a href="http://localhost:1313/en/tags/dll-hijacking/">DLL Hijacking</a></li>
      <li><a href="http://localhost:1313/en/tags/service-tampering/">Service Tampering</a></li>
      <li><a href="http://localhost:1313/en/tags/av-evasion/">AV Evasion</a></li>
      <li><a href="http://localhost:1313/en/tags/malware/">Malware</a></li>
      <li><a href="http://localhost:1313/en/tags/ransomware/">Ransomware</a></li>
    </ul>
<nav class="paginav">
  <a class="next" href="http://localhost:1313/en/post/2025-05-15-spof-analysis-in-cybersecurity/">
    <span class="title">Next »</span>
    <br>
    <span>SPOF in Cybersecurity: From History to Strategy, a Graph-Based Analysis</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on x"
            href="https://x.com/intent/tweet/?text=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f&amp;hashtags=Mind%2cEDR%2cBYOVD%2cBYOI%2cDLLHijacking%2cServiceTampering%2cAVEvasion%2cMalware%2cRansomware">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f&amp;title=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR&amp;summary=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR&amp;source=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f&title=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on whatsapp"
            href="https://api.whatsapp.com/send?text=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR%20-%20http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on telegram"
            href="https://telegram.me/share/url?text=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR&amp;url=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Endpoint Evasion Techniques (2020–2025): The Evolution of Attacks Bypassing EDR on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Endpoint%20Evasion%20Techniques%20%282020%e2%80%932025%29%3a%20The%20Evolution%20of%20Attacks%20Bypassing%20EDR&u=http%3a%2f%2flocalhost%3a1313%2fen%2fpost%2f2025-05-28-endpoint-security-evasion-techniques-20202025%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/en/">Code Before Breach</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
  function loadGiscus(theme) {
    
    document.querySelectorAll('.giscus-frame, script[src*="giscus.app"]').forEach(el => el.remove());

    
    const giscusScript = document.createElement("script");
    giscusScript.src = "https://giscus.app/client.js";
    giscusScript.setAttribute("data-repo", "windshock\/windshock.github.io");
    giscusScript.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnkxODQ2MDMyMTk=");
    giscusScript.setAttribute("data-category", "General");
    giscusScript.setAttribute("data-category-id", "DIC_kwDOCwDSU84CoqLg");
    giscusScript.setAttribute("data-mapping", "pathname");
    giscusScript.setAttribute("data-reactions-enabled", "1");
    giscusScript.setAttribute("data-theme", theme); 
    giscusScript.setAttribute("data-lang", "en");
    giscusScript.setAttribute("data-input-position", "bottom");
    giscusScript.setAttribute("data-loading", "lazy");
    giscusScript.crossOrigin = "anonymous";
    giscusScript.async = true;

    document.body.appendChild(giscusScript);
  }

  
  const currentTheme = document.body.classList.contains("dark") ? "dark" : "light";
  loadGiscus(currentTheme);

  
  const observer = new MutationObserver(() => {
    const newTheme = document.body.classList.contains("dark") ? "dark" : "light";
    loadGiscus(newTheme);
  });

  observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
</script>



<script>
  function initSwiperIfNeeded() {
    if (typeof Swiper === 'undefined') {
      
      return setTimeout(initSwiperIfNeeded, 50);
    }

    if (document.querySelector('.swiper')) {
      new Swiper('.swiper', {
        slidesPerView: 1.2,
        spaceBetween: 16,
        loop: true,
        preloadImages: false,
        lazy: {
          loadOnTransitionStart: true,
          loadPrevNext: true,
        },
        pagination: {
          el: '.swiper-pagination',
          clickable: true
        },
        breakpoints: {
          768: { slidesPerView: 2.5 },
          1024: { slidesPerView: 3.2 }
        }
      });

      
      document.querySelectorAll('img.swiper-lazy').forEach(img => {
        img.src = img.dataset.src;
      });
    } else {
      setTimeout(initSwiperIfNeeded, 100);
    }
  }

  
  initSwiperIfNeeded();
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
